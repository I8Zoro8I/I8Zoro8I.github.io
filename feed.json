{
    "version": "https://jsonfeed.org/version/1",
    "title": "CYX",
    "subtitle": "Blog",
    "icon": "http://example.com/images/favicon.ico",
    "description": "emm这里什么都有",
    "home_page_url": "http://example.com",
    "items": [
        {
            "id": "http://example.com/2024/10/16/post/vue/%E4%BF%AE%E6%94%B9avue%E9%BB%98%E8%AE%A4%E7%BB%84%E4%BB%B6%E6%A0%B7%E5%BC%8F/",
            "url": "http://example.com/2024/10/16/post/vue/%E4%BF%AE%E6%94%B9avue%E9%BB%98%E8%AE%A4%E7%BB%84%E4%BB%B6%E6%A0%B7%E5%BC%8F/",
            "title": "修改avue默认组件样式",
            "date_published": "2024-10-16T11:37:02.305Z",
            "content_html": "<h1 id=\"修改avue默认组件样式\"><a class=\"anchor\" href=\"#修改avue默认组件样式\">#</a> 修改 avue 默认组件样式</h1>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2Z5eWRhc2hlbi9hcnRpY2xlL2RldGFpbHMvMTEzNjExNTA2\">参考链接</span></p>\n<p>我们打开 F12 找到我们需要修改的样式 class 名</p>\n<p><img data-src=\"https://dlink.host/wx2.sinaimg.cn/large/006V2BDqly8hs1tni3a40j30mq04nwft.jpg\" alt=\"\" /></p>\n<p>错误示范 1：</p>\n<p>会影响到其他页面的样式</p>\n<p><figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;style&gt;</span><br><span class=\"line\"><span class=\"selector-class\">.avue-crud__menu</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">display</span>: none;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">&lt;/style&gt;</span><br></pre></td></tr></table></figure></p>\n<p>错误示范 2：；</p>\n<p>样式无效</p>\n<p><figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;style lang=&quot;scss&quot; scoped&gt;</span><br><span class=\"line\"><span class=\"selector-class\">.avue-crud__menu</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">display</span>: none;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">&lt;/style&gt;</span><br></pre></td></tr></table></figure></p>\n<p><strong>正确示范 1</strong>：</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;style lang=&quot;scss&quot; scoped&gt;</span><br><span class=\"line\">/deep/ .avue-crud__menu &#123;</span><br><span class=\"line\">  display: none;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">&lt;/style&gt;</span><br></pre></td></tr></table></figure></p>\n<p><strong>正确示范 2：</strong></p>\n<p><figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;style lang=&quot;scss&quot; scoped&gt;</span><br><span class=\"line\">::v-deep .el-divider--vertical &#123;</span><br><span class=\"line\">  <span class=\"attribute\">height</span>: auto;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">&lt;/style&gt;</span><br></pre></td></tr></table></figure></p>\n",
            "tags": [
                "前端",
                "avue"
            ]
        },
        {
            "id": "http://example.com/2024/10/16/post/vue/hello-world/",
            "url": "http://example.com/2024/10/16/post/vue/hello-world/",
            "title": "el-select多选但后端要求返回字符串的解决方法",
            "date_published": "2024-10-16T11:37:02.285Z",
            "content_html": "<h1 id=\"el-select多选但后端要求返回字符串的解决方法\"><a class=\"anchor\" href=\"#el-select多选但后端要求返回字符串的解决方法\">#</a> el-select 多选但后端要求返回字符串的解决方法</h1>\n<p><strong>需求：el-select 多选但后端要求返回字符串</strong><br />\n已知：el-select 多选时绑定值为数组，如：arr:[‘这是第一个’,‘这是第一个’]<br />\n 后端要求以字符串形式返回，使用 “，” 隔开，如：arr:“这是第一个，这是第一个”<br />\n 方法：前端使用自定义中间参数进行转化<br />\n背景：此 el-select 存在多个，且被包含在列表的 n 列中，可能涉及新增、删除、换行等，所以不能直接根据 index 进行存储。</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;el-table-column key=&quot;4&quot; prop=&quot;remark&quot; label=&quot;内容&quot; &gt;</span><br><span class=\"line\">     &lt;template slot-scope=&quot;scope&quot;&gt;</span><br><span class=\"line\">        &lt;el-select v-model=&quot;checkList[scope.row.id]&quot; multiple placeholder=&quot;请选择&quot;</span><br><span class=\"line\">              @change=&quot;onChangeCheck(scope.row,$event)&quot;  style=&quot;width: 100%&quot;&gt;</span><br><span class=\"line\">            &lt;el-option</span><br><span class=\"line\">                  v-for=&quot;item in options&quot;</span><br><span class=\"line\">                  :key=&quot;item.value&quot;</span><br><span class=\"line\">                  :label=&quot;item.label&quot;</span><br><span class=\"line\">                  :value=&quot;item.value&quot;&gt;</span><br><span class=\"line\">            &lt;/el-option&gt;</span><br><span class=\"line\">        &lt;/el-select&gt;</span><br><span class=\"line\">    &lt;/template&gt;</span><br><span class=\"line\">&lt;/el-table-column&gt;</span><br></pre></td></tr></table></figure></p>\n<p><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"title function_\">data</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// 初始化中间参数</span></span><br><span class=\"line\">        <span class=\"attr\">checkList</span>: []</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">methods</span>:&#123;</span><br><span class=\"line\">    <span class=\"comment\">// 改变时（get）</span></span><br><span class=\"line\">    <span class=\"title function_\">onChangeCheck</span>(<span class=\"params\">item,e</span>)&#123;</span><br><span class=\"line\">        <span class=\"comment\">//更新对象，键为item的id</span></span><br><span class=\"line\">      <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&quot;item&quot;</span>,item);</span><br><span class=\"line\">      <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&quot;event&quot;</span>,e)</span><br><span class=\"line\">      <span class=\"variable language_\">this</span>.<span class=\"property\">checkList</span>[item.<span class=\"property\">id</span>] = e;</span><br><span class=\"line\">      item.<span class=\"property\">remark</span> = e.<span class=\"title function_\">join</span>(<span class=\"string\">&quot;、&quot;</span>);</span><br><span class=\"line\">      <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(item.<span class=\"property\">remark</span>)</span><br><span class=\"line\">      <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">tableData</span>)</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">        <span class=\"comment\">// 获取到数据时需要做初始化（set）</span></span><br><span class=\"line\">    <span class=\"comment\">// 注：初始化方法在获取数据时触发即可</span></span><br><span class=\"line\">    <span class=\"title function_\">setSpecialCheck</span>(<span class=\"params\">item</span>)&#123;</span><br><span class=\"line\">      <span class=\"keyword\">if</span>(item.<span class=\"property\">remark</span>)&#123;</span><br><span class=\"line\">        <span class=\"variable language_\">this</span>.$set(<span class=\"variable language_\">this</span>.<span class=\"property\">checkList</span>, item.<span class=\"property\">id</span>, item.<span class=\"property\">remark</span>.<span class=\"title function_\">split</span>(<span class=\"string\">&#x27;、&#x27;</span>));</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>完整代码：<br />\n(删除了多余代码，只保留了问题所需要的代码)</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;template&gt;</span><br><span class=\"line\">&lt;el-table  :data=&quot;tableData&quot; border style=&quot;width: 100%&quot;&gt;</span><br><span class=\"line\">          &lt;el-table-column key=&quot;1&quot; type=&quot;index&quot; label=&quot;序号&quot; width=&quot;60&quot;/&gt;</span><br><span class=\"line\">          &lt;el-table-column key=&quot;4&quot; prop=&quot;remark&quot; label=&quot;内容&quot; &gt;</span><br><span class=\"line\">            &lt;template slot-scope=&quot;scope&quot;&gt;</span><br><span class=\"line\">              &lt;el-select v-model=&quot;checkList[scope.row.id]&quot; multiple placeholder=&quot;请选择&quot;</span><br><span class=\"line\">              @change=&quot;onChangeCheck(scope.row,$event)&quot;  style=&quot;width: 100%&quot;&gt;</span><br><span class=\"line\">                &lt;el-option</span><br><span class=\"line\">                  v-for=&quot;item in options&quot;</span><br><span class=\"line\">                  :key=&quot;item.value&quot;</span><br><span class=\"line\">                  :label=&quot;item.label&quot;</span><br><span class=\"line\">                  :value=&quot;item.value&quot;&gt;</span><br><span class=\"line\">                &lt;/el-option&gt;</span><br><span class=\"line\">              &lt;/el-select&gt;</span><br><span class=\"line\">            &lt;/template&gt;</span><br><span class=\"line\">          &lt;/el-table-column&gt;</span><br><span class=\"line\">        &lt;/el-table&gt;</span><br><span class=\"line\">&lt;/template&gt;</span><br><span class=\"line\">&lt;scipt&gt;</span><br><span class=\"line\">export default&#123;</span><br><span class=\"line\">    data()&#123;</span><br><span class=\"line\">    return&#123;</span><br><span class=\"line\">      tableData:[],</span><br><span class=\"line\">      options: [</span><br><span class=\"line\">        &#123; value: &#x27;船舶到港并递交NOR时间&#x27;, label: &#x27;船舶到港并递交NOR时间&#x27; &#125;,</span><br><span class=\"line\">        &#123; value: &#x27;等泊&#x27;, label: &#x27;等泊&#x27; &#125;,</span><br><span class=\"line\">        &#123; value: &#x27;NOR提交后12小时&#x27;, label: &#x27;NOR提交后12小时&#x27; &#125;,</span><br><span class=\"line\">        &#123; value: &#x27;移泊&#x27;, label: &#x27;移泊&#x27; &#125;,</span><br><span class=\"line\">        &#123; value: &#x27;开始卸货&#x27;, label: &#x27;开始卸货&#x27; &#125;,</span><br><span class=\"line\">        &#123; value: &#x27;检验&#x27;, label: &#x27;检验&#x27; &#125;,</span><br><span class=\"line\">        &#123; value: &#x27;水尺&#x27;, label: &#x27;水尺&#x27; &#125;,</span><br><span class=\"line\">        &#123; value: &#x27;卸货&#x27;, label: &#x27;卸货&#x27; &#125;,</span><br><span class=\"line\">        &#123; value: &#x27;卸货完毕&#x27;, label: &#x27;卸货完毕&#x27; &#125;,</span><br><span class=\"line\">      ],</span><br><span class=\"line\">      checkList: []</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">    methods:&#123;</span><br><span class=\"line\">    loadData(id)&#123;</span><br><span class=\"line\">      this.bodyLoading = true</span><br><span class=\"line\">      getDispatchDetail(id).then(res =&gt; &#123;</span><br><span class=\"line\">        //remarks 转 数组  转字符串</span><br><span class=\"line\">        this.tableData=res.data.data.lines</span><br><span class=\"line\">        console.log(&quot;tableData&quot;,this.tableData)</span><br><span class=\"line\">        for (let i=0;i&lt;this.tableData.length;i++)&#123;</span><br><span class=\"line\">          this.setSpecialCheck(this.tableData[i])</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        console.log(&quot;checkList&quot;,this.checkList)</span><br><span class=\"line\">      &#125;)</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    onChangeCheck(item,e)&#123;</span><br><span class=\"line\">      console.log(&quot;item&quot;,item);</span><br><span class=\"line\">      console.log(&quot;event&quot;,e)</span><br><span class=\"line\">      this.checkList[item.id] = e;</span><br><span class=\"line\">      item.remark = e.join(&quot;、&quot;);</span><br><span class=\"line\">      console.log(item.remark)</span><br><span class=\"line\">      console.log(this.tableData)</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    setSpecialCheck(item)&#123;</span><br><span class=\"line\">      if(item.remark)&#123;</span><br><span class=\"line\">        this.$set(this.checkList, item.id, item.remark.split(&#x27;、&#x27;));</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">&lt;/scipt&gt;</span><br></pre></td></tr></table></figure></p>\n<p>效果图：</p>\n<p><img data-src=\"D:%5CPictures%5Ctypore%5C006V2BDqly8ht4liz4fi2j30sc0gqdhe.jpg\" alt=\"\" /></p>\n",
            "tags": [
                "前端"
            ]
        },
        {
            "id": "http://example.com/2024/10/16/post/vue/D3.js%20%20%20V3%E7%89%88%E6%9C%AC/",
            "url": "http://example.com/2024/10/16/post/vue/D3.js%20%20%20V3%E7%89%88%E6%9C%AC/",
            "title": "D3.js V3版本  学习笔记",
            "date_published": "2024-10-16T11:37:02.283Z",
            "content_html": "<h1 id=\"d3js-v3版本\"><a class=\"anchor\" href=\"#d3js-v3版本\">#</a> D3.js   V3 版本</h1>\n<h2 id=\"d3-tree\"><a class=\"anchor\" href=\"#d3-tree\">#</a> D3  Tree</h2>\n<p>vue2 + d3 (3.5.17)</p>\n<h4 id=\"安装组件\"><a class=\"anchor\" href=\"#安装组件\">#</a> 安装组件</h4>\n<p><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install d3@3.5.17 -s   </span><br></pre></td></tr></table></figure></p>\n<p>@后面是版本号，不加默认下载最新版</p>\n<p>页面（组件）引用</p>\n<p><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> * <span class=\"keyword\">as</span> d3 <span class=\"keyword\">from</span> <span class=\"string\">&quot;d3&quot;</span>;</span><br></pre></td></tr></table></figure></p>\n<h3 id=\"直接上一个简单案例\"><a class=\"anchor\" href=\"#直接上一个简单案例\">#</a> 直接上一个简单案例</h3>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;template&gt;</span><br><span class=\"line\">  &lt;div id=&quot;screenshot&quot; style=&quot;width:100%;height:90%&quot;&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">    &lt;div id=&quot;tree-container&quot; style=&quot;width:100%;height:95%;&quot;&gt;&lt;/div&gt;</span><br><span class=\"line\">  &lt;div ref=&quot;container&quot;&gt;&lt;/div&gt;</span><br><span class=\"line\">    &lt;/div&gt;</span><br><span class=\"line\">&lt;/template&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;script&gt;</span><br><span class=\"line\">import * as d3 from &#x27;d3&#x27;;</span><br><span class=\"line\">import $ from &#x27;jquery&#x27;</span><br><span class=\"line\">export default &#123;</span><br><span class=\"line\">  data()&#123;</span><br><span class=\"line\">    return &#123;</span><br><span class=\"line\">      treeData:&#123;</span><br><span class=\"line\">        name: &#x27;收入&#x27;,</span><br><span class=\"line\">        value:100,</span><br><span class=\"line\">        children: [</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">            name: &#x27;电费收入&#x27;,</span><br><span class=\"line\">            value: 10,</span><br><span class=\"line\">            children: []</span><br><span class=\"line\">          &#125;,</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">            name: &#x27;供热收入&#x27;,</span><br><span class=\"line\">            value: 8,</span><br><span class=\"line\">            children: []</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">          ,</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">            name: &#x27;副产品收入&#x27;,</span><br><span class=\"line\">            value: 8,</span><br><span class=\"line\">            children: []</span><br><span class=\"line\">          &#125;,</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">            name: &#x27;其他收入&#x27;,</span><br><span class=\"line\">            value: 8,</span><br><span class=\"line\">            children: []</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        ]</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  mounted() &#123;</span><br><span class=\"line\">    this.drawTree();</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  methods: &#123;</span><br><span class=\"line\">    drawTree() &#123;</span><br><span class=\"line\">    // 设置图表的宽高和Margin</span><br><span class=\"line\">      var margin = &#123; top: 20, right: 90, bottom: 30, left: 90 &#125;,</span><br><span class=\"line\">          width = 960 - margin.left - margin.right,</span><br><span class=\"line\">          height = 500 - margin.top - margin.bottom;</span><br><span class=\"line\"></span><br><span class=\"line\">      //创建视图</span><br><span class=\"line\">      let svg = d3.select(this.$refs.container)</span><br><span class=\"line\">          .append(&#x27;svg&#x27;)</span><br><span class=\"line\">          .attr(&#x27;width&#x27;, width + margin.right + margin.left)</span><br><span class=\"line\">          .attr(&#x27;height&#x27;, height + margin.top + margin.bottom)</span><br><span class=\"line\">          .append(&#x27;g&#x27;)</span><br><span class=\"line\">          .call(this.zoomListener)</span><br><span class=\"line\">          .attr(&quot;transform&quot;, &quot;translate(&quot; + margin.left + &quot;,&quot; + margin.top + &quot;)&quot;)</span><br><span class=\"line\"></span><br><span class=\"line\">      //定义节点拖放行为的拖动侦听器。</span><br><span class=\"line\"></span><br><span class=\"line\">      //建立树布局</span><br><span class=\"line\">      const treeLayout = d3.layout.tree()</span><br><span class=\"line\">          .size([width, height]);</span><br><span class=\"line\"></span><br><span class=\"line\">      const nodes = treeLayout.nodes(this.treeData);</span><br><span class=\"line\">      const links = treeLayout.links(nodes);</span><br><span class=\"line\"></span><br><span class=\"line\">      const nodeGroup = svg.selectAll(&#x27;.node&#x27;)</span><br><span class=\"line\">          .data(nodes)</span><br><span class=\"line\">          .enter()</span><br><span class=\"line\">          .append(&#x27;g&#x27;)</span><br><span class=\"line\">          .attr(&#x27;class&#x27;, &#x27;node&#x27;)</span><br><span class=\"line\">          .attr(&#x27;transform&#x27;, d =&gt; `translate($&#123;d.x&#125;,$&#123;d.y&#125;)`);</span><br><span class=\"line\"></span><br><span class=\"line\">      nodeGroup.append(&#x27;rect&#x27;)//设置为矩形</span><br><span class=\"line\">          .attr(&#x27;width&#x27;, 80) // 设置矩形宽度</span><br><span class=\"line\">          .attr(&#x27;height&#x27;, 30) // 设置矩形高度</span><br><span class=\"line\">          .attr(&#x27;x&#x27;, -40) // 调整矩形位置，使其居中</span><br><span class=\"line\">          .attr(&#x27;y&#x27;, -15)</span><br><span class=\"line\">          .attr(&#x27;rx&#x27;, 5) // 可选，设置矩形圆角</span><br><span class=\"line\">          .attr(&#x27;ry&#x27;, 5)</span><br><span class=\"line\">          .style(&#x27;fill&#x27;, &#x27;transparent&#x27;)</span><br><span class=\"line\">          .style(&#x27;stroke&#x27;, &#x27;#000&#x27;) // 设置矩形边框颜色</span><br><span class=\"line\">          .style(&#x27;stroke-width&#x27;, &#x27;1px&#x27;); // 设置矩形边框宽度; // 透明</span><br><span class=\"line\">      nodeGroup.append(&#x27;line&#x27;) // 添加分割线</span><br><span class=\"line\">          .attr(&#x27;x1&#x27;, -40) // 分割线的起始点 x 坐标</span><br><span class=\"line\">          .attr(&#x27;y1&#x27;, 0) // 分割线的起始点 y 坐标</span><br><span class=\"line\">          .attr(&#x27;x2&#x27;, 40) // 分割线的结束点 x 坐标</span><br><span class=\"line\">          .attr(&#x27;y2&#x27;, 0) // 分割线的结束点 y 坐标</span><br><span class=\"line\">          .style(&#x27;stroke&#x27;, &#x27;#000&#x27;) // 设置分割线颜色</span><br><span class=\"line\">          .style(&#x27;stroke-width&#x27;, &#x27;1px&#x27;); // 设置分割线宽度</span><br><span class=\"line\"></span><br><span class=\"line\">      nodeGroup.append(&#x27;text&#x27;)</span><br><span class=\"line\">          .attr(&#x27;dy&#x27;, -4) // 调整文本的垂直位置，使其居中</span><br><span class=\"line\">          .style(&#x27;text-anchor&#x27;, &#x27;middle&#x27;) // 设置文本水平居中</span><br><span class=\"line\">          .text(d =&gt; d.name);</span><br><span class=\"line\"></span><br><span class=\"line\">      nodeGroup.append(&#x27;text&#x27;)</span><br><span class=\"line\">          .attr(&#x27;dy&#x27;, 13) // 调整文本的垂直位置，使其在矩形内部</span><br><span class=\"line\">          .style(&#x27;text-anchor&#x27;, &#x27;middle&#x27;) // 设置文本水平居中</span><br><span class=\"line\">          .text(d =&gt; d.value);</span><br><span class=\"line\"></span><br><span class=\"line\">      svg.selectAll(&#x27;.link&#x27;)</span><br><span class=\"line\">          .data(links)</span><br><span class=\"line\">          .enter()</span><br><span class=\"line\">          .append(&#x27;path&#x27;)</span><br><span class=\"line\">          .attr(&#x27;class&#x27;, &#x27;link&#x27;)</span><br><span class=\"line\">          .attr(&#x27;d&#x27;, d =&gt; &#123;</span><br><span class=\"line\">            return `M$&#123;d.source.x&#125;,$&#123;d.source.y+15&#125;L$&#123;d.target.x&#125;,$&#123;d.target.y-15&#125;`;</span><br><span class=\"line\">          &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">      const zoomHandler = d3.behavior.zoom()</span><br><span class=\"line\">          .on(&#x27;zoom&#x27;, () =&gt; &#123;</span><br><span class=\"line\">            svg.attr(&#x27;transform&#x27;, `translate($&#123;d3.event.translate&#125;)scale($&#123;d3.event.scale&#125;)`);</span><br><span class=\"line\">          &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">      svg.call(zoomHandler);</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\"></span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\">&lt;/script&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;style&gt;</span><br><span class=\"line\">circle &#123;</span><br><span class=\"line\">  fill: #ccc;</span><br><span class=\"line\">  stroke: #000;</span><br><span class=\"line\">  stroke-width: 1px;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">text &#123;</span><br><span class=\"line\">  font-size: 12px;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">path.link &#123;</span><br><span class=\"line\">  fill: none;</span><br><span class=\"line\">  stroke: #ccc;</span><br><span class=\"line\">  stroke-width: 1.5px;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">&lt;/style&gt;</span><br></pre></td></tr></table></figure></p>\n<p>我们可以看到 D3.js 的步骤其实就是</p>\n<p><code>初始化图表 -&gt; 获取数据 -&gt; 数据转换 -&gt; 元素操作/交互/动画 -&gt; 事件绑定 -&gt; 数据更新 -&gt; 元素更新</code></p>\n<h2 id=\"用d3-tree-做一个指标下钻功能\"><a class=\"anchor\" href=\"#用d3-tree-做一个指标下钻功能\">#</a> 用 D3 tree 做一个指标下钻功能</h2>\n<p>看完上面哪个例子我们直接上难度，在大数据时代，很多数据客户都会要求直观的展示数据，这个指标下钻就是很普遍的客户需求，展示如下动图。</p>\n<p>[双击收展、任意拖拉、滚轮缩放]</p>\n<p><img data-src=\"http://dlink.host/wx3.sinaimg.cn/large/006V2BDqly8hrp5pe8coxg30b408u41t.gif\" alt=\"alt\" /></p>\n<p>我们按照例子中的方法进行介绍：</p>\n<p>图的绘制主要在 drawTree 与 update 中</p>\n<p><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"title function_\">drawTree</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">     <span class=\"comment\">//show D3 tree</span></span><br><span class=\"line\">     <span class=\"variable language_\">this</span>.<span class=\"property\">depths</span> = <span class=\"variable language_\">this</span>.<span class=\"title function_\">treeDepths</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">treeData</span>);</span><br><span class=\"line\">     <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">depths</span>)</span><br><span class=\"line\">     <span class=\"comment\">//建立树布局</span></span><br><span class=\"line\">     <span class=\"variable language_\">this</span>.<span class=\"property\">minHeight</span> = <span class=\"number\">500</span>;</span><br><span class=\"line\">     <span class=\"variable language_\">this</span>.<span class=\"property\">viewerWidth</span> = $(<span class=\"string\">&quot;#screenshot&quot;</span>).<span class=\"title function_\">width</span>();</span><br><span class=\"line\">     <span class=\"variable language_\">this</span>.<span class=\"property\">viewerHeight</span> = $(<span class=\"string\">&quot;#screenshot&quot;</span>).<span class=\"title function_\">height</span>();</span><br><span class=\"line\">     <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">viewerHeight</span>)</span><br><span class=\"line\">     <span class=\"keyword\">if</span> (<span class=\"variable language_\">this</span>.<span class=\"property\">viewerHeight</span> &lt; <span class=\"variable language_\">this</span>.<span class=\"property\">minHeight</span>)</span><br><span class=\"line\">       <span class=\"variable language_\">this</span>.<span class=\"property\">viewerHeight</span> = <span class=\"variable language_\">this</span>.<span class=\"property\">minHeight</span></span><br><span class=\"line\">     <span class=\"variable language_\">this</span>.<span class=\"property\">viewerHeight</span>=<span class=\"number\">500</span></span><br><span class=\"line\"></span><br><span class=\"line\">     <span class=\"variable language_\">this</span>.<span class=\"property\">tree</span> = d3.<span class=\"property\">layout</span>.<span class=\"title function_\">tree</span>()</span><br><span class=\"line\">         .<span class=\"title function_\">size</span>([<span class=\"variable language_\">this</span>.<span class=\"property\">viewerHeight</span>, <span class=\"variable language_\">this</span>.<span class=\"property\">viewerWidth</span>]);</span><br><span class=\"line\">     <span class=\"comment\">//定义一个d3对角线投影，供稍后的节点路径使用</span></span><br><span class=\"line\">     <span class=\"variable language_\">this</span>.<span class=\"property\">diagonal</span> = d3.<span class=\"property\">svg</span>.<span class=\"title function_\">diagonal</span>()</span><br><span class=\"line\">         .<span class=\"title function_\">projection</span>(<span class=\"function\"><span class=\"params\">d</span> =&gt;</span> &#123;</span><br><span class=\"line\">           <span class=\"keyword\">return</span> [d.<span class=\"property\">y</span>, d.<span class=\"property\">x</span>];</span><br><span class=\"line\">         &#125;)</span><br><span class=\"line\"></span><br><span class=\"line\">     <span class=\"comment\">//call visit to maxLabelLength</span></span><br><span class=\"line\">     <span class=\"variable language_\">this</span>.<span class=\"title function_\">visit</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">treeData</span>, <span class=\"function\">(<span class=\"params\">d</span>) =&gt;</span> &#123;</span><br><span class=\"line\">       <span class=\"variable language_\">this</span>.<span class=\"property\">totalNodes</span>++;</span><br><span class=\"line\">       <span class=\"keyword\">if</span> (d.<span class=\"property\">name</span>) &#123;</span><br><span class=\"line\">         <span class=\"variable language_\">this</span>.<span class=\"property\">maxLabelLength</span> = <span class=\"title class_\">Math</span>.<span class=\"title function_\">max</span>(d.<span class=\"property\">name</span>.<span class=\"property\">length</span>, <span class=\"variable language_\">this</span>.<span class=\"property\">maxLabelLength</span>);</span><br><span class=\"line\">       &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">         <span class=\"variable language_\">this</span>.<span class=\"property\">maxLabelLength</span> = <span class=\"title class_\">Math</span>.<span class=\"title function_\">max</span>(<span class=\"number\">0</span>, <span class=\"variable language_\">this</span>.<span class=\"property\">maxLabelLength</span>);</span><br><span class=\"line\">       &#125;</span><br><span class=\"line\">     &#125;, <span class=\"function\">(<span class=\"params\">d</span>) =&gt;</span> &#123;</span><br><span class=\"line\">       <span class=\"keyword\">return</span> d.<span class=\"property\">children</span> &amp;&amp; d.<span class=\"property\">children</span>.<span class=\"property\">length</span> &gt; <span class=\"number\">0</span> ? d.<span class=\"property\">children</span> : <span class=\"literal\">null</span>;</span><br><span class=\"line\">     &#125;)</span><br><span class=\"line\">     <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&quot;总节点&quot;</span>,<span class=\"variable language_\">this</span>.<span class=\"property\">totalNodes</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">     <span class=\"comment\">//排序树最初是为了防止json没有按排序顺序排列</span></span><br><span class=\"line\">     <span class=\"variable language_\">this</span>.<span class=\"title function_\">sortTree</span>()</span><br><span class=\"line\">     <span class=\"comment\">//定义 zoomListener，该 zoomListener 在 scaleExtents 中约束的“zoom”事件上调用缩放</span></span><br><span class=\"line\">     <span class=\"variable language_\">this</span>.<span class=\"property\">zoomListener</span> = d3.<span class=\"property\">behavior</span>.<span class=\"title function_\">zoom</span>().<span class=\"title function_\">scaleExtent</span>([<span class=\"number\">0.1</span>, <span class=\"number\">3</span>]).<span class=\"title function_\">on</span>(<span class=\"string\">&quot;zoom&quot;</span>, <span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">       <span class=\"variable language_\">this</span>.<span class=\"title function_\">zoom</span>()</span><br><span class=\"line\">     &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">     <span class=\"comment\">//创建视图</span></span><br><span class=\"line\">     <span class=\"keyword\">const</span> baseSvg = d3.<span class=\"title function_\">select</span>(<span class=\"string\">&quot;#tree-container&quot;</span>)</span><br><span class=\"line\">         .<span class=\"title function_\">append</span>(<span class=\"string\">&#x27;svg&#x27;</span>)</span><br><span class=\"line\">         .<span class=\"title function_\">attr</span>(<span class=\"string\">&#x27;width&#x27;</span>, <span class=\"variable language_\">this</span>.<span class=\"property\">viewerWidth</span>)</span><br><span class=\"line\">         .<span class=\"title function_\">attr</span>(<span class=\"string\">&#x27;height&#x27;</span>, <span class=\"variable language_\">this</span>.<span class=\"property\">viewerHeight</span>)</span><br><span class=\"line\">         .<span class=\"title function_\">attr</span>(<span class=\"string\">&quot;class&quot;</span>,<span class=\"string\">&quot;overlay&quot;</span>)</span><br><span class=\"line\">         .<span class=\"title function_\">append</span>(<span class=\"string\">&quot;g&quot;</span>)</span><br><span class=\"line\">         .<span class=\"title function_\">call</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">zoomListener</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">     <span class=\"keyword\">let</span> dragListener = d3.<span class=\"property\">behavior</span>.<span class=\"title function_\">drag</span>()</span><br><span class=\"line\">         .<span class=\"title function_\">on</span>(<span class=\"string\">&quot;dragstart&quot;</span>, <span class=\"function\">(<span class=\"params\">d</span>) =&gt;</span> &#123;</span><br><span class=\"line\">           <span class=\"keyword\">if</span> (d === <span class=\"variable language_\">this</span>.<span class=\"property\">root</span>) &#123;</span><br><span class=\"line\">             <span class=\"keyword\">return</span>;</span><br><span class=\"line\">           &#125;</span><br><span class=\"line\">           <span class=\"variable language_\">this</span>.<span class=\"property\">dragStarted</span> = <span class=\"literal\">true</span>;</span><br><span class=\"line\">           <span class=\"variable language_\">this</span>.<span class=\"property\">nodes</span> = <span class=\"variable language_\">this</span>.<span class=\"property\">tree</span>.<span class=\"title function_\">nodes</span>(d);</span><br><span class=\"line\">           d3.<span class=\"property\">event</span>.<span class=\"property\">sourceEvent</span>.<span class=\"title function_\">stopPropagation</span>();</span><br><span class=\"line\">         &#125;).<span class=\"title function_\">on</span>(<span class=\"string\">&quot;drag&quot;</span>, <span class=\"function\">(<span class=\"params\">d</span>) =&gt;</span> &#123;</span><br><span class=\"line\">           <span class=\"keyword\">if</span> (d === <span class=\"variable language_\">this</span>.<span class=\"property\">root</span>) &#123;</span><br><span class=\"line\">             <span class=\"keyword\">return</span>;</span><br><span class=\"line\">           &#125;</span><br><span class=\"line\">           <span class=\"keyword\">if</span> (<span class=\"variable language_\">this</span>.<span class=\"property\">dragStarted</span>) &#123;</span><br><span class=\"line\">             <span class=\"keyword\">let</span> domNode = <span class=\"variable language_\">this</span>;</span><br><span class=\"line\">             <span class=\"variable language_\">this</span>.<span class=\"title function_\">initiateDrag</span>(d, domNode);</span><br><span class=\"line\">           &#125;</span><br><span class=\"line\">           <span class=\"comment\">//获取mouseEvent相对于SVG容器的同弦以允许摇摄</span></span><br><span class=\"line\">           <span class=\"keyword\">let</span> relCoords = d3.<span class=\"title function_\">mouse</span>($(<span class=\"string\">&#x27;svg&#x27;</span>).<span class=\"title function_\">get</span>(<span class=\"number\">0</span>));</span><br><span class=\"line\">           <span class=\"keyword\">if</span> (relCoords[<span class=\"number\">0</span>] &lt; <span class=\"variable language_\">this</span>.<span class=\"property\">panBoundary</span>)&#123;</span><br><span class=\"line\">             <span class=\"variable language_\">this</span>.<span class=\"property\">panTimer</span> = <span class=\"literal\">true</span>;</span><br><span class=\"line\">             <span class=\"variable language_\">this</span>.<span class=\"title function_\">pan</span>(<span class=\"variable language_\">this</span>, <span class=\"string\">&#x27;left&#x27;</span>);</span><br><span class=\"line\">           &#125;<span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (relCoords[<span class=\"number\">0</span>] &gt; ($(<span class=\"string\">&#x27;svg&#x27;</span>).<span class=\"title function_\">width</span>() - <span class=\"variable language_\">this</span>.<span class=\"property\">panBoundary</span>)) &#123;</span><br><span class=\"line\">             <span class=\"variable language_\">this</span>.<span class=\"property\">panTimer</span> = <span class=\"literal\">true</span>;</span><br><span class=\"line\">             <span class=\"variable language_\">this</span>.<span class=\"title function_\">pan</span>(<span class=\"variable language_\">this</span>, <span class=\"string\">&#x27;right&#x27;</span>);</span><br><span class=\"line\">           &#125;<span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (relCoords[<span class=\"number\">1</span>] &lt; <span class=\"variable language_\">this</span>.<span class=\"property\">panBoundary</span>) &#123;</span><br><span class=\"line\">             <span class=\"variable language_\">this</span>.<span class=\"property\">panTimer</span> = <span class=\"literal\">true</span>;</span><br><span class=\"line\">             <span class=\"variable language_\">this</span>.<span class=\"title function_\">pan</span>(<span class=\"variable language_\">this</span>, <span class=\"string\">&#x27;up&#x27;</span>);</span><br><span class=\"line\">           &#125;<span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (relCoords[<span class=\"number\">1</span>] &gt; ($(<span class=\"string\">&#x27;svg&#x27;</span>).<span class=\"title function_\">height</span>() - <span class=\"variable language_\">this</span>.<span class=\"property\">panBoundary</span>)) &#123;</span><br><span class=\"line\">             <span class=\"variable language_\">this</span>.<span class=\"property\">panTimer</span> = <span class=\"literal\">true</span>;</span><br><span class=\"line\">             <span class=\"variable language_\">this</span>.<span class=\"title function_\">pan</span>(<span class=\"variable language_\">this</span>, <span class=\"string\">&#x27;down&#x27;</span>);</span><br><span class=\"line\">           &#125;<span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">             <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">               <span class=\"built_in\">clearTimeout</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">panTimer</span>);</span><br><span class=\"line\">             &#125; <span class=\"keyword\">catch</span> (e) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">             &#125;</span><br><span class=\"line\">           &#125;</span><br><span class=\"line\">           d.<span class=\"property\">x0</span> += d3.<span class=\"property\">event</span>.<span class=\"property\">dy</span>;</span><br><span class=\"line\">           d.<span class=\"property\">y0</span> += d3.<span class=\"property\">event</span>.<span class=\"property\">dx</span>;</span><br><span class=\"line\">           <span class=\"keyword\">var</span> node = d3.<span class=\"title function_\">select</span>(<span class=\"variable language_\">this</span>);</span><br><span class=\"line\">           node.<span class=\"title function_\">attr</span>(<span class=\"string\">&quot;transform&quot;</span>, <span class=\"string\">&quot;translate(&quot;</span> + d.<span class=\"property\">y0</span> + <span class=\"string\">&quot;,&quot;</span> + d.<span class=\"property\">x0</span> + <span class=\"string\">&quot;)&quot;</span>);</span><br><span class=\"line\">           <span class=\"comment\">//更新临时连接器</span></span><br><span class=\"line\">           <span class=\"variable language_\">this</span>.<span class=\"title function_\">updateTempConnector</span>();</span><br><span class=\"line\">         &#125;).<span class=\"title function_\">on</span>(<span class=\"string\">&quot;dragend&quot;</span>, <span class=\"function\">(<span class=\"params\">d</span>) =&gt;</span> &#123;</span><br><span class=\"line\">           <span class=\"keyword\">if</span> (d === <span class=\"variable language_\">this</span>.<span class=\"property\">root</span>) &#123;<span class=\"keyword\">return</span>;&#125;</span><br><span class=\"line\">           <span class=\"variable language_\">this</span>.<span class=\"property\">domNode</span> = <span class=\"variable language_\">this</span>;</span><br><span class=\"line\">           <span class=\"keyword\">if</span> (<span class=\"variable language_\">this</span>.<span class=\"property\">selectedNode</span>)&#123;</span><br><span class=\"line\">             <span class=\"keyword\">var</span> index = <span class=\"variable language_\">this</span>.<span class=\"property\">draggingNode</span>.<span class=\"property\">parent</span>.<span class=\"property\">children</span>.<span class=\"title function_\">indexOf</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">draggingNode</span>);</span><br><span class=\"line\">             <span class=\"keyword\">if</span> (index &gt; -<span class=\"number\">1</span> )&#123;</span><br><span class=\"line\">               <span class=\"variable language_\">this</span>.<span class=\"property\">draggingNode</span>.<span class=\"property\">parent</span>.<span class=\"property\">children</span>.<span class=\"title function_\">splice</span>(index, <span class=\"number\">1</span>);</span><br><span class=\"line\">             &#125;</span><br><span class=\"line\">             <span class=\"keyword\">if</span> (<span class=\"keyword\">typeof</span> <span class=\"variable language_\">this</span>.<span class=\"property\">selectedNode</span>.<span class=\"property\">children</span> !== <span class=\"string\">&quot;undefined&quot;</span> || <span class=\"keyword\">typeof</span> <span class=\"variable language_\">this</span>.<span class=\"property\">selectedNode</span>.<span class=\"property\">_children</span> !== <span class=\"string\">&#x27;undefined&#x27;</span>)&#123;</span><br><span class=\"line\">               <span class=\"keyword\">if</span> (<span class=\"keyword\">typeof</span> <span class=\"variable language_\">this</span>.<span class=\"property\">selectedNode</span>.<span class=\"property\">_children</span> !== <span class=\"string\">&quot;undefined&quot;</span>) &#123;</span><br><span class=\"line\">                 <span class=\"variable language_\">this</span>.<span class=\"property\">selectedNode</span>.<span class=\"property\">children</span>.<span class=\"title function_\">push</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">draggingNode</span>)</span><br><span class=\"line\">               &#125;<span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                 <span class=\"variable language_\">this</span>.<span class=\"property\">selectedNode</span>.<span class=\"property\">_children</span>.<span class=\"title function_\">push</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">draggingNode</span>)</span><br><span class=\"line\">               &#125;</span><br><span class=\"line\">             &#125;<span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">               <span class=\"variable language_\">this</span>.<span class=\"property\">selectedNode</span>.<span class=\"property\">children</span> = []</span><br><span class=\"line\">               <span class=\"variable language_\">this</span>.<span class=\"property\">selectedNode</span>.<span class=\"property\">children</span>.<span class=\"title function_\">push</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">draggingNode</span>)</span><br><span class=\"line\">             &#125;</span><br><span class=\"line\">             <span class=\"comment\">//确保要添加到的节点已展开，以便用户可以看到添加的节点已正确移动</span></span><br><span class=\"line\">             <span class=\"variable language_\">this</span>.<span class=\"title function_\">expand</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">selectedNode</span>);</span><br><span class=\"line\">             <span class=\"variable language_\">this</span>.<span class=\"title function_\">sortTree</span>();</span><br><span class=\"line\">             <span class=\"variable language_\">this</span>.<span class=\"title function_\">endDrag</span>();</span><br><span class=\"line\">           &#125;<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">             <span class=\"variable language_\">this</span>.<span class=\"title function_\">endDrag</span>();</span><br><span class=\"line\">           &#125;</span><br><span class=\"line\">         &#125;);</span><br><span class=\"line\">     <span class=\"comment\">//附加一个包含所有节点的组，缩放侦听器可以对其进行操作。</span></span><br><span class=\"line\">     <span class=\"variable language_\">this</span>.<span class=\"property\">svgGroup</span> = baseSvg.<span class=\"title function_\">append</span>(<span class=\"string\">&quot;g&quot;</span>);</span><br><span class=\"line\">     <span class=\"comment\">//移除双击</span></span><br><span class=\"line\">     d3.<span class=\"title function_\">select</span>(<span class=\"string\">&quot;svg&quot;</span>).<span class=\"title function_\">on</span>(<span class=\"string\">&quot;dblclick.zoom&quot;</span>, <span class=\"literal\">null</span>);</span><br><span class=\"line\">     <span class=\"variable language_\">this</span>.<span class=\"property\">root</span> = <span class=\"variable language_\">this</span>.<span class=\"property\">treeData</span>;</span><br><span class=\"line\">     <span class=\"variable language_\">this</span>.<span class=\"property\">root</span>.<span class=\"property\">x0</span> = <span class=\"variable language_\">this</span>.<span class=\"property\">viewerHeight</span>/<span class=\"number\">2</span>;</span><br><span class=\"line\">     <span class=\"variable language_\">this</span>.<span class=\"property\">root</span>.<span class=\"property\">y0</span> = <span class=\"number\">0</span>;</span><br><span class=\"line\">     <span class=\"comment\">//最初布局树并以根节点为中心。</span></span><br><span class=\"line\"></span><br><span class=\"line\">     <span class=\"variable language_\">this</span>.<span class=\"property\">root</span>.<span class=\"property\">children</span>.<span class=\"title function_\">forEach</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">collapse</span>);</span><br><span class=\"line\">     <span class=\"variable language_\">this</span>.<span class=\"title function_\">update</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">root</span>);</span><br><span class=\"line\">     <span class=\"variable language_\">this</span>.<span class=\"title function_\">centerNode</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">root</span>);</span><br><span class=\"line\">   &#125;,</span><br></pre></td></tr></table></figure></p>\n<p><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br><span class=\"line\">170</span><br><span class=\"line\">171</span><br><span class=\"line\">172</span><br><span class=\"line\">173</span><br><span class=\"line\">174</span><br><span class=\"line\">175</span><br><span class=\"line\">176</span><br><span class=\"line\">177</span><br><span class=\"line\">178</span><br><span class=\"line\">179</span><br><span class=\"line\">180</span><br><span class=\"line\">181</span><br><span class=\"line\">182</span><br><span class=\"line\">183</span><br><span class=\"line\">184</span><br><span class=\"line\">185</span><br><span class=\"line\">186</span><br><span class=\"line\">187</span><br><span class=\"line\">188</span><br><span class=\"line\">189</span><br><span class=\"line\">190</span><br><span class=\"line\">191</span><br><span class=\"line\">192</span><br><span class=\"line\">193</span><br><span class=\"line\">194</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"title function_\">update</span>(<span class=\"params\">source</span>)&#123;</span><br><span class=\"line\">      <span class=\"keyword\">var</span> width = <span class=\"number\">130</span>,</span><br><span class=\"line\">          height = <span class=\"number\">70</span>;</span><br><span class=\"line\">      <span class=\"comment\">//计算新 树图的布局</span></span><br><span class=\"line\">      <span class=\"variable language_\">this</span>.<span class=\"property\">nodes</span> = <span class=\"variable language_\">this</span>.<span class=\"property\">tree</span>.<span class=\"title function_\">nodes</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">root</span>).<span class=\"title function_\">reverse</span>();</span><br><span class=\"line\">      <span class=\"keyword\">let</span> links = <span class=\"variable language_\">this</span>.<span class=\"property\">tree</span>.<span class=\"title function_\">links</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">nodes</span>)</span><br><span class=\"line\">      <span class=\"comment\">//设置y坐标点  每层占  200px；</span></span><br><span class=\"line\">      <span class=\"variable language_\">this</span>.<span class=\"property\">nodes</span>.<span class=\"title function_\">forEach</span>(<span class=\"function\"><span class=\"params\">d</span>=&gt;</span>&#123;</span><br><span class=\"line\">        d.<span class=\"property\">y</span>=d.<span class=\"property\">depth</span> * <span class=\"number\">200</span></span><br><span class=\"line\">      &#125;)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">      <span class=\"comment\">//每个node对应一个group</span></span><br><span class=\"line\">      <span class=\"comment\">//data()：绑定一个数组到选择集上，数组的各项值分别与选择集的各元素绑定</span></span><br><span class=\"line\">      <span class=\"keyword\">let</span> node = <span class=\"variable language_\">this</span>.<span class=\"property\">svgGroup</span>.<span class=\"title function_\">selectAll</span>(<span class=\"string\">&quot;g.node&quot;</span>)</span><br><span class=\"line\">          .<span class=\"title function_\">data</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">nodes</span>, <span class=\"function\">(<span class=\"params\">d</span>) =&gt;</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> d.<span class=\"property\">id</span> || (d.<span class=\"property\">id</span> = ++ <span class=\"variable language_\">this</span>.<span class=\"property\">i</span>)</span><br><span class=\"line\">          &#125;)</span><br><span class=\"line\"></span><br><span class=\"line\">      <span class=\"comment\">//新增节点数据集，设置位置</span></span><br><span class=\"line\">      <span class=\"comment\">//在 svg 中添加一个g，g是 svg 中的一个属性，是 group 的意思，</span></span><br><span class=\"line\">      <span class=\"comment\">// 它表示一组什么东西，如一组 lines ， rects ，circles</span></span><br><span class=\"line\">      <span class=\"comment\">// 其实坐标轴就是由这些东西构成的。</span></span><br><span class=\"line\">      <span class=\"keyword\">let</span> nodeEnter = node.<span class=\"title function_\">enter</span>().<span class=\"title function_\">append</span>(<span class=\"string\">&quot;g&quot;</span>)</span><br><span class=\"line\">          .<span class=\"title function_\">attr</span>(<span class=\"string\">&quot;class&quot;</span>, <span class=\"string\">&quot;node&quot;</span>) <span class=\"comment\">//attr设置html属性，style设置css属性</span></span><br><span class=\"line\">          .<span class=\"title function_\">attr</span>(<span class=\"string\">&quot;transform&quot;</span>, <span class=\"function\">(<span class=\"params\">d</span>) =&gt;</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"string\">&quot;translate(&quot;</span> + source.<span class=\"property\">y0</span> + <span class=\"string\">&quot;,&quot;</span> + source.<span class=\"property\">x0</span> + <span class=\"string\">&quot;)&quot;</span>;</span><br><span class=\"line\">          &#125;).<span class=\"title function_\">on</span>(<span class=\"string\">&quot;dblclick&quot;</span>, <span class=\"function\">(<span class=\"params\">d</span>) =&gt;</span> &#123; <span class=\"variable language_\">this</span>.<span class=\"title function_\">click</span>(d) &#125;);</span><br><span class=\"line\">      <span class=\"comment\">//添加连接点---此处设置的是圆圈过渡时候的效果（颜色）</span></span><br><span class=\"line\">      nodeEnter.<span class=\"title function_\">append</span>(<span class=\"string\">&quot;rect&quot;</span>)</span><br><span class=\"line\">          .<span class=\"title function_\">attr</span>(<span class=\"string\">&quot;x&quot;</span>, -<span class=\"number\">65</span>)</span><br><span class=\"line\">          .<span class=\"title function_\">attr</span>(<span class=\"string\">&quot;y&quot;</span>,-<span class=\"number\">35</span>)</span><br><span class=\"line\">          .<span class=\"title function_\">attr</span>(<span class=\"string\">&quot;width&quot;</span>, width)</span><br><span class=\"line\">          .<span class=\"title function_\">attr</span>(<span class=\"string\">&quot;height&quot;</span>, height)</span><br><span class=\"line\">          .<span class=\"title function_\">attr</span>(<span class=\"string\">&quot;rx&quot;</span>, <span class=\"number\">10</span>)</span><br><span class=\"line\">          .<span class=\"title function_\">style</span>(<span class=\"string\">&quot;fill&quot;</span>, <span class=\"string\">&quot;#FFF&quot;</span>); <span class=\"comment\">//d 代表数据，也就是与某元素绑定的数据。</span></span><br><span class=\"line\"></span><br><span class=\"line\">      <span class=\"comment\">//指标名称</span></span><br><span class=\"line\">      nodeEnter.<span class=\"title function_\">append</span>(<span class=\"string\">&quot;text&quot;</span>)</span><br><span class=\"line\">          .<span class=\"title function_\">attr</span>(<span class=\"string\">&quot;x&quot;</span>, <span class=\"number\">0</span>)</span><br><span class=\"line\">          .<span class=\"title function_\">attr</span>(<span class=\"string\">&quot;dy&quot;</span>, -<span class=\"number\">20</span>)</span><br><span class=\"line\">          .<span class=\"title function_\">attr</span>(<span class=\"string\">&quot;text-anchor&quot;</span>, <span class=\"string\">&quot;middle&quot;</span>)</span><br><span class=\"line\">          .<span class=\"title function_\">text</span>(<span class=\"function\">(<span class=\"params\">d</span>) =&gt;</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> d.<span class=\"property\">name</span>;</span><br><span class=\"line\">          &#125;)</span><br><span class=\"line\">          .<span class=\"title function_\">style</span>(<span class=\"string\">&quot;fill&quot;</span>, <span class=\"string\">&quot;gray&quot;</span>)</span><br><span class=\"line\">          .<span class=\"title function_\">style</span>(<span class=\"string\">&quot;fill-opacity&quot;</span>, <span class=\"number\">1</span>)</span><br><span class=\"line\">          .<span class=\"title function_\">style</span>(<span class=\"string\">&quot;font-size&quot;</span>, <span class=\"string\">&quot;12px&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">      <span class=\"comment\">//指标值</span></span><br><span class=\"line\">      nodeEnter.<span class=\"title function_\">append</span>(<span class=\"string\">&quot;text&quot;</span>)</span><br><span class=\"line\">          .<span class=\"title function_\">attr</span>(<span class=\"string\">&quot;x&quot;</span>, <span class=\"function\">(<span class=\"params\">d</span>) =&gt;</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> d.<span class=\"property\">children</span> || d.<span class=\"property\">_children</span> ? -<span class=\"number\">15</span> : -<span class=\"number\">15</span>;</span><br><span class=\"line\">          &#125;)</span><br><span class=\"line\">          .<span class=\"title function_\">attr</span>(<span class=\"string\">&quot;dy&quot;</span>, <span class=\"number\">0</span>)</span><br><span class=\"line\">          <span class=\"comment\">// .attr(&quot;text-anchor&quot;, (d) &#123; return d.children || d._children ? &quot;end&quot; : &quot;start&quot;; &#125;)</span></span><br><span class=\"line\">          .<span class=\"title function_\">attr</span>(<span class=\"string\">&quot;text-anchor&quot;</span>, <span class=\"string\">&quot;middle&quot;</span>)</span><br><span class=\"line\">          .<span class=\"title function_\">text</span>(<span class=\"function\">(<span class=\"params\">d</span>) =&gt;</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> d.<span class=\"property\">value</span>.<span class=\"title function_\">toLocaleString</span>();</span><br><span class=\"line\">          &#125;)</span><br><span class=\"line\">          .<span class=\"title function_\">style</span>(<span class=\"string\">&quot;fill&quot;</span>, <span class=\"string\">&quot;blue&quot;</span>)</span><br><span class=\"line\">          .<span class=\"title function_\">style</span>(<span class=\"string\">&quot;font-size&quot;</span>, <span class=\"string\">&quot;18px&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">      <span class=\"comment\">//指标单位</span></span><br><span class=\"line\">      nodeEnter.<span class=\"title function_\">append</span>(<span class=\"string\">&quot;text&quot;</span>)</span><br><span class=\"line\">          .<span class=\"title function_\">attr</span>(<span class=\"string\">&quot;x&quot;</span>, <span class=\"function\">(<span class=\"params\">d</span>) =&gt;</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> d.<span class=\"property\">children</span> || d.<span class=\"property\">_children</span> ? d.<span class=\"property\">value</span> != <span class=\"literal\">null</span> ? d.<span class=\"property\">value</span>.<span class=\"title function_\">toString</span>().<span class=\"property\">length</span> * <span class=\"number\">6</span> - <span class=\"number\">4</span> : <span class=\"number\">10</span> : d.<span class=\"property\">value</span> != <span class=\"literal\">null</span> ? d.<span class=\"property\">value</span>.<span class=\"title function_\">toString</span>().<span class=\"property\">length</span> * <span class=\"number\">6</span> - <span class=\"number\">4</span> : <span class=\"number\">10</span>;</span><br><span class=\"line\">          &#125;)</span><br><span class=\"line\">          .<span class=\"title function_\">attr</span>(<span class=\"string\">&quot;dy&quot;</span>, -<span class=\"number\">3</span>)</span><br><span class=\"line\">          <span class=\"comment\">// .attr(&quot;text-anchor&quot;, (d) &#123; return d.children || d._children ? &quot;end&quot; : &quot;start&quot;; &#125;)</span></span><br><span class=\"line\">          .<span class=\"title function_\">attr</span>(<span class=\"string\">&quot;text-anchor&quot;</span>, <span class=\"string\">&quot;middle&quot;</span>)</span><br><span class=\"line\">          .<span class=\"title function_\">text</span>(<span class=\"string\">&quot;万元&quot;</span>)</span><br><span class=\"line\">          .<span class=\"title function_\">style</span>(<span class=\"string\">&quot;fill&quot;</span>, <span class=\"string\">&quot;gray&quot;</span>)</span><br><span class=\"line\">          .<span class=\"title function_\">style</span>(<span class=\"string\">&quot;font-size&quot;</span>, <span class=\"string\">&quot;10px&quot;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">      <span class=\"comment\">//展开趋势图</span></span><br><span class=\"line\">      nodeEnter.<span class=\"title function_\">append</span>(<span class=\"string\">&quot;text&quot;</span>)</span><br><span class=\"line\">          .<span class=\"title function_\">attr</span>(<span class=\"string\">&quot;x&quot;</span>, <span class=\"function\">(<span class=\"params\">d</span>) =&gt;</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> d.<span class=\"property\">children</span> || d.<span class=\"property\">_children</span> ? <span class=\"number\">50</span> : <span class=\"number\">50</span>;</span><br><span class=\"line\">          &#125;)</span><br><span class=\"line\">          .<span class=\"title function_\">attr</span>(<span class=\"string\">&quot;dy&quot;</span>, <span class=\"number\">0</span>)</span><br><span class=\"line\">          .<span class=\"title function_\">attr</span>(<span class=\"string\">&quot;text-anchor&quot;</span>, <span class=\"string\">&quot;middle&quot;</span>)</span><br><span class=\"line\">          .<span class=\"title function_\">text</span>(<span class=\"function\">(<span class=\"params\">d</span>) =&gt;</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"string\">&quot;...&quot;</span></span><br><span class=\"line\">          &#125;)</span><br><span class=\"line\">          .<span class=\"title function_\">style</span>(<span class=\"string\">&quot;fill&quot;</span>, <span class=\"string\">&quot;gray&quot;</span>)</span><br><span class=\"line\">          .<span class=\"title function_\">style</span>(<span class=\"string\">&quot;fill-opacity&quot;</span>, <span class=\"number\">1</span>)</span><br><span class=\"line\">          .<span class=\"title function_\">style</span>(<span class=\"string\">&quot;font-size&quot;</span>, <span class=\"string\">&quot;28px&quot;</span>)</span><br><span class=\"line\">          .<span class=\"title function_\">on</span>(<span class=\"string\">&quot;click&quot;</span>, <span class=\"function\">(<span class=\"params\">d, i</span>) =&gt;</span> &#123;</span><br><span class=\"line\">            <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&quot;触发点击事件&quot;</span>)</span><br><span class=\"line\">          &#125;);</span><br><span class=\"line\">      <span class=\"comment\">// Transition nodes to their new position.将节点过渡到一个新的位置-----主要是针对节点过渡过程中的过渡效果</span></span><br><span class=\"line\">      <span class=\"comment\">//node就是保留的数据集，为原来数据的图形添加过渡动画。首先是整个组的位置</span></span><br><span class=\"line\">      <span class=\"comment\">//子节点全出来了</span></span><br><span class=\"line\">      <span class=\"keyword\">var</span> nodeUpdate = node.<span class=\"title function_\">transition</span>() <span class=\"comment\">//开始一个动画过度</span></span><br><span class=\"line\">          .<span class=\"title function_\">duration</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">duration</span>) <span class=\"comment\">//过渡延迟时间 此处主要设置的是圆圈节点随斜线的过渡延迟</span></span><br><span class=\"line\">          .<span class=\"title function_\">attr</span>(<span class=\"string\">&quot;transform&quot;</span>, <span class=\"function\">(<span class=\"params\">d</span>) =&gt;</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"string\">&quot;translate(&quot;</span> + d.<span class=\"property\">y</span> + <span class=\"string\">&quot;,&quot;</span> + d.<span class=\"property\">x</span> + <span class=\"string\">&quot;)&quot;</span>;</span><br><span class=\"line\">          &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">      nodeUpdate.<span class=\"title function_\">select</span>(<span class=\"string\">&quot;rect&quot;</span>)</span><br><span class=\"line\">          .<span class=\"title function_\">attr</span>(<span class=\"string\">&quot;x&quot;</span>, -<span class=\"number\">65</span>)</span><br><span class=\"line\">          .<span class=\"title function_\">attr</span>(<span class=\"string\">&quot;y&quot;</span>, -<span class=\"number\">35</span>)</span><br><span class=\"line\">          .<span class=\"title function_\">attr</span>(<span class=\"string\">&quot;width&quot;</span>, width)</span><br><span class=\"line\">          .<span class=\"title function_\">attr</span>(<span class=\"string\">&quot;height&quot;</span>, height/<span class=\"number\">2</span> + <span class=\"number\">10</span>)</span><br><span class=\"line\">          .<span class=\"title function_\">attr</span>(<span class=\"string\">&quot;rx&quot;</span>, <span class=\"number\">10</span>)</span><br><span class=\"line\">          .<span class=\"title function_\">style</span>(<span class=\"string\">&quot;fill&quot;</span>, <span class=\"string\">&quot;#FFF&quot;</span>)</span><br><span class=\"line\">          .<span class=\"title function_\">style</span>(<span class=\"string\">&quot;stroke&quot;</span>,<span class=\"keyword\">function</span>(<span class=\"params\">d</span>)&#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(d.<span class=\"property\">value</span> === <span class=\"number\">0</span>)&#123;</span><br><span class=\"line\">              <span class=\"keyword\">return</span> <span class=\"string\">&#x27;#6b6b6b&#x27;</span></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"string\">&#x27;steelblue&#x27;</span></span><br><span class=\"line\">          &#125;)</span><br><span class=\"line\">          .<span class=\"title function_\">style</span>(<span class=\"string\">&quot;stroke-width&quot;</span>, <span class=\"string\">&quot;1.5px&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">      <span class=\"comment\">// Transition exiting nodes to the parent&#x27;s new position.过渡现有的节点到父母的新位置。</span></span><br><span class=\"line\">      <span class=\"comment\">//最后处理消失的数据，添加消失动画</span></span><br><span class=\"line\">      <span class=\"keyword\">var</span> nodeExit = node.<span class=\"title function_\">exit</span>().<span class=\"title function_\">transition</span>()</span><br><span class=\"line\">          .<span class=\"title function_\">duration</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">duration</span>)</span><br><span class=\"line\">          .<span class=\"title function_\">attr</span>(<span class=\"string\">&quot;transform&quot;</span>, <span class=\"function\">(<span class=\"params\">d</span>) =&gt;</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"string\">&quot;translate(&quot;</span> + source.<span class=\"property\">y</span> + <span class=\"string\">&quot;,&quot;</span> + source.<span class=\"property\">x</span> + <span class=\"string\">&quot;)&quot;</span>;</span><br><span class=\"line\">          &#125;)</span><br><span class=\"line\">          .<span class=\"title function_\">remove</span>();</span><br><span class=\"line\"></span><br><span class=\"line\">      nodeExit.<span class=\"title function_\">select</span>(<span class=\"string\">&quot;rect&quot;</span>)</span><br><span class=\"line\">          .<span class=\"title function_\">attr</span>(<span class=\"string\">&quot;x&quot;</span>, -<span class=\"number\">65</span>)</span><br><span class=\"line\">          .<span class=\"title function_\">attr</span>(<span class=\"string\">&quot;y&quot;</span>, -<span class=\"number\">35</span>)</span><br><span class=\"line\">          .<span class=\"title function_\">attr</span>(<span class=\"string\">&quot;width&quot;</span>, width)</span><br><span class=\"line\">          .<span class=\"title function_\">attr</span>(<span class=\"string\">&quot;height&quot;</span>, height/<span class=\"number\">2</span> +<span class=\"number\">10</span>)</span><br><span class=\"line\">          .<span class=\"title function_\">attr</span>(<span class=\"string\">&quot;rx&quot;</span>, <span class=\"number\">10</span>)</span><br><span class=\"line\">          .<span class=\"title function_\">style</span>(<span class=\"string\">&quot;fill&quot;</span>, <span class=\"string\">&quot;#FFF&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">      nodeExit.<span class=\"title function_\">select</span>(<span class=\"string\">&quot;text&quot;</span>)</span><br><span class=\"line\">          .<span class=\"title function_\">attr</span>(<span class=\"string\">&quot;text-anchor&quot;</span>, <span class=\"string\">&quot;middle&quot;</span>)</span><br><span class=\"line\">          .<span class=\"title function_\">style</span>(<span class=\"string\">&quot;fill-opacity&quot;</span>, <span class=\"number\">1e-6</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">      <span class=\"comment\">// Update the links…线操作相关</span></span><br><span class=\"line\">      <span class=\"comment\">//再处理连线集合</span></span><br><span class=\"line\">      <span class=\"keyword\">let</span> link = <span class=\"variable language_\">this</span>.<span class=\"property\">svgGroup</span>.<span class=\"title function_\">selectAll</span>(<span class=\"string\">&quot;path.link&quot;</span>)</span><br><span class=\"line\">          .<span class=\"title function_\">style</span>(<span class=\"string\">&quot;fill&quot;</span>, <span class=\"string\">&quot;none&quot;</span>)</span><br><span class=\"line\">          .<span class=\"title function_\">style</span>(<span class=\"string\">&quot;stroke&quot;</span>, <span class=\"string\">&quot;steelblue&quot;</span>)</span><br><span class=\"line\">          .<span class=\"title function_\">style</span>(<span class=\"string\">&quot;stroke-width&quot;</span>, <span class=\"string\">&quot;1.5px&quot;</span>)</span><br><span class=\"line\">          .<span class=\"title function_\">data</span>(links, <span class=\"function\">(<span class=\"params\">d</span>) =&gt;</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> d.<span class=\"property\">target</span>.<span class=\"property\">id</span>;</span><br><span class=\"line\">          &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">      <span class=\"comment\">// Enter any new links at the parent&#x27;s previous position.</span></span><br><span class=\"line\">      <span class=\"comment\">//添加新的连线</span></span><br><span class=\"line\"></span><br><span class=\"line\">      link.<span class=\"title function_\">enter</span>().<span class=\"title function_\">insert</span>(<span class=\"string\">&quot;path&quot;</span>, <span class=\"string\">&quot;g&quot;</span>)</span><br><span class=\"line\">          .<span class=\"title function_\">style</span>(<span class=\"string\">&quot;fill&quot;</span>, <span class=\"string\">&quot;none&quot;</span>)</span><br><span class=\"line\">          .<span class=\"title function_\">style</span>(<span class=\"string\">&quot;stroke&quot;</span>, <span class=\"string\">&quot;steelblue&quot;</span>)</span><br><span class=\"line\">          .<span class=\"title function_\">style</span>(<span class=\"string\">&quot;stroke-width&quot;</span>, <span class=\"string\">&quot;1.5px&quot;</span>)</span><br><span class=\"line\">          .<span class=\"title function_\">attr</span>(<span class=\"string\">&quot;class&quot;</span>, <span class=\"string\">&quot;link&quot;</span>)</span><br><span class=\"line\">          .<span class=\"title function_\">attr</span>(<span class=\"string\">&quot;d&quot;</span>, <span class=\"function\">(<span class=\"params\">d</span>) =&gt;</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">var</span> o = &#123;</span><br><span class=\"line\">              <span class=\"attr\">x</span>: source.<span class=\"property\">x0</span>,</span><br><span class=\"line\">              <span class=\"attr\">y</span>: source.<span class=\"property\">y0</span></span><br><span class=\"line\">            &#125;;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"variable language_\">this</span>.<span class=\"title function_\">diagonal</span>(&#123;</span><br><span class=\"line\">              <span class=\"attr\">source</span>: o,</span><br><span class=\"line\">              <span class=\"attr\">target</span>: o</span><br><span class=\"line\">            &#125;); <span class=\"comment\">//diagonal - 生成一个二维贝塞尔连接器, 用于节点连接图.</span></span><br><span class=\"line\">          &#125;)</span><br><span class=\"line\">          .<span class=\"title function_\">attr</span>(<span class=\"string\">&#x27;marker-end&#x27;</span>, <span class=\"string\">&#x27;url(#arrow)&#x27;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">      <span class=\"comment\">// Transition links to their new position.将斜线过渡到新的位置</span></span><br><span class=\"line\">      <span class=\"comment\">//保留的连线添加过渡动画</span></span><br><span class=\"line\">      link.<span class=\"title function_\">transition</span>()</span><br><span class=\"line\">          .<span class=\"title function_\">duration</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">duration</span>)</span><br><span class=\"line\">          .<span class=\"title function_\">attr</span>(<span class=\"string\">&quot;d&quot;</span>, <span class=\"variable language_\">this</span>.<span class=\"property\">diagonal</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">      <span class=\"comment\">// Transition exiting nodes to the parent&#x27;s new position.过渡现有的斜线到父母的新位置。</span></span><br><span class=\"line\">      <span class=\"comment\">//消失的连线添加过渡动画</span></span><br><span class=\"line\">      link.<span class=\"title function_\">exit</span>().<span class=\"title function_\">transition</span>()</span><br><span class=\"line\">          .<span class=\"title function_\">duration</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">duration</span>)</span><br><span class=\"line\">          .<span class=\"title function_\">attr</span>(<span class=\"string\">&quot;d&quot;</span>, <span class=\"function\">(<span class=\"params\">d</span>) =&gt;</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">var</span> o = &#123;</span><br><span class=\"line\">              <span class=\"attr\">x</span>: source.<span class=\"property\">x</span>,</span><br><span class=\"line\">              <span class=\"attr\">y</span>: source.<span class=\"property\">y</span></span><br><span class=\"line\">            &#125;;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"variable language_\">this</span>.<span class=\"title function_\">diagonal</span>(&#123;</span><br><span class=\"line\">              <span class=\"attr\">source</span>: o,</span><br><span class=\"line\">              <span class=\"attr\">target</span>: o</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">          &#125;)</span><br><span class=\"line\">          .<span class=\"title function_\">remove</span>();</span><br><span class=\"line\">      <span class=\"comment\">// Stash the old positions for transition.将旧的斜线过渡效果隐藏</span></span><br><span class=\"line\">      <span class=\"variable language_\">this</span>.<span class=\"property\">nodes</span>.<span class=\"title function_\">forEach</span>(<span class=\"function\">(<span class=\"params\">d</span>) =&gt;</span> &#123;</span><br><span class=\"line\">        d.<span class=\"property\">x0</span> = d.<span class=\"property\">x</span>;</span><br><span class=\"line\">        d.<span class=\"property\">y0</span> = d.<span class=\"property\">y</span>;</span><br><span class=\"line\">      &#125;);</span><br><span class=\"line\">    &#125;,</span><br></pre></td></tr></table></figure></p>\n<p>双击收展方法：</p>\n<p><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//展开节点</span></span><br><span class=\"line\"><span class=\"comment\">//children 展示节点 _children 隐藏节点  缩</span></span><br><span class=\"line\">    <span class=\"title function_\">expand</span>(<span class=\"params\">d</span>)&#123;</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (d.<span class=\"property\">_children</span>)&#123;</span><br><span class=\"line\">        d.<span class=\"property\">children</span> = d.<span class=\"property\">_children</span>;</span><br><span class=\"line\">        d.<span class=\"property\">children</span>.<span class=\"title function_\">forEach</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">expand</span>)</span><br><span class=\"line\">        d.<span class=\"property\">_children</span> = <span class=\"literal\">null</span></span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">        </span><br><span class=\"line\"><span class=\"comment\">//收缩节点</span></span><br><span class=\"line\">    <span class=\"title function_\">collapse</span>(<span class=\"params\">d</span>)&#123;</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (d.<span class=\"property\">children</span>)&#123;</span><br><span class=\"line\">        d.<span class=\"property\">_children</span>=d.<span class=\"property\">children</span>;</span><br><span class=\"line\">        d.<span class=\"property\">children</span>=<span class=\"literal\">null</span></span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;,</span><br></pre></td></tr></table></figure></p>\n<p>根据数据判断层数：</p>\n<p><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//判断是否多层</span></span><br><span class=\"line\"><span class=\"title function_\">treeDepths</span>(<span class=\"params\">g</span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">var</span> depths = [];</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (g.<span class=\"property\">children</span>)</span><br><span class=\"line\">    g.<span class=\"property\">children</span>.<span class=\"title function_\">forEach</span>(<span class=\"function\">(<span class=\"params\">v</span>) =&gt;</span> &#123;</span><br><span class=\"line\">      <span class=\"variable language_\">this</span>.<span class=\"title function_\">dfs</span>(v, <span class=\"number\">1</span>, depths);</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">  <span class=\"keyword\">return</span> depths;</span><br><span class=\"line\">&#125;,</span><br><span class=\"line\"><span class=\"comment\">//嵌套循环</span></span><br><span class=\"line\"><span class=\"title function_\">dfs</span>(<span class=\"params\">v, depth, depths</span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">var</span> children = v.<span class=\"property\">children</span>;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (children &amp;&amp; children.<span class=\"property\">length</span> &gt; <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">    children.<span class=\"title function_\">forEach</span>(<span class=\"function\">(<span class=\"params\">child</span>) =&gt;</span> &#123;</span><br><span class=\"line\">      <span class=\"variable language_\">this</span>.<span class=\"title function_\">dfs</span>(child, depth + <span class=\"number\">1</span>, depths);</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">  &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">    depths.<span class=\"title function_\">push</span>(v);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;,</span><br></pre></td></tr></table></figure></p>\n<p>排序节点：</p>\n<p><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//排序</span></span><br><span class=\"line\"><span class=\"title function_\">sortTree</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&quot;==排序开始==&quot;</span>)</span><br><span class=\"line\">  <span class=\"variable language_\">this</span>.<span class=\"property\">tree</span>.<span class=\"title function_\">sort</span>(<span class=\"function\">(<span class=\"params\">a, b</span>) =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> b.<span class=\"property\">name</span> ? b.<span class=\"property\">name</span>.<span class=\"title function_\">toLowerCase</span>() : b.<span class=\"property\">name</span> &lt; a.<span class=\"property\">name</span> ? a.<span class=\"property\">name</span>.<span class=\"title function_\">toLowerCase</span>() : a.<span class=\"property\">name</span> ? <span class=\"number\">1</span> : -<span class=\"number\">1</span>;</span><br><span class=\"line\">  &#125;);</span><br><span class=\"line\">&#125;,</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure></p>\n<p>拖拉行为：</p>\n<p><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"title function_\">zoom</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  <span class=\"variable language_\">this</span>.<span class=\"property\">svgGroup</span>.<span class=\"title function_\">attr</span>(<span class=\"string\">&quot;transform&quot;</span>, <span class=\"string\">&quot;translate(&quot;</span> + d3.<span class=\"property\">event</span>.<span class=\"property\">translate</span> + <span class=\"string\">&quot;)scale(&quot;</span> + d3.<span class=\"property\">event</span>.<span class=\"property\">scale</span> + <span class=\"string\">&quot;)&quot;</span>);</span><br><span class=\"line\">&#125;,</span><br><span class=\"line\">    </span><br><span class=\"line\">      <span class=\"comment\">//拖拽开始时对节点进行一系列操作，以确保拖拽过程中节点的正确显示和相关连线的调整。</span></span><br><span class=\"line\"><span class=\"title function_\">initiateDrag</span>(<span class=\"params\">d, domNode</span>) &#123;</span><br><span class=\"line\">  <span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">  将当前被拖拽的节点保存在this.draggingNode属性中，</span></span><br><span class=\"line\"><span class=\"comment\">  以便在拖拽过程中能够对其进行操作</span></span><br><span class=\"line\"><span class=\"comment\">   */</span></span><br><span class=\"line\">  <span class=\"variable language_\">this</span>.<span class=\"property\">draggingNode</span> = d;</span><br><span class=\"line\">  <span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">  1=</span></span><br><span class=\"line\"><span class=\"comment\">  为了将被拖拽节点的.ghostCircle元素的</span></span><br><span class=\"line\"><span class=\"comment\">  pointer-events属性设置为none，</span></span><br><span class=\"line\"><span class=\"comment\">  以避免拖拽节点时干扰到其他元素</span></span><br><span class=\"line\"><span class=\"comment\">  2=</span></span><br><span class=\"line\"><span class=\"comment\">  为了将所有.ghostCircle元素的类设置为ghostCircle show，</span></span><br><span class=\"line\"><span class=\"comment\">  这可能是用于显示拖拽节点周围的虚拟元素</span></span><br><span class=\"line\"><span class=\"comment\">  3=为了为被拖拽的节点设置类名，可能是用于在拖拽过程中应用特定的样式</span></span><br><span class=\"line\"><span class=\"comment\">   */</span></span><br><span class=\"line\">  d3.<span class=\"title function_\">select</span>(domNode).<span class=\"title function_\">select</span>(<span class=\"string\">&#x27;.ghostCircle&#x27;</span>).<span class=\"title function_\">attr</span>(<span class=\"string\">&#x27;pointer-events&#x27;</span>, <span class=\"string\">&#x27;none&#x27;</span>);</span><br><span class=\"line\">  d3.<span class=\"title function_\">selectAll</span>(<span class=\"string\">&#x27;.ghostCircle&#x27;</span>).<span class=\"title function_\">attr</span>(<span class=\"string\">&#x27;class&#x27;</span>, <span class=\"string\">&#x27;ghostCircle show&#x27;</span>);</span><br><span class=\"line\">  d3.<span class=\"title function_\">select</span>(domNode).<span class=\"title function_\">attr</span>(<span class=\"string\">&#x27;class&#x27;</span>, <span class=\"string\">&#x27;node activeDrag&#x27;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">  重新排序所有节点，将被拖拽的节点置于最前面，</span></span><br><span class=\"line\"><span class=\"comment\">  以确保它能够在拖拽过程中正确显示在其他节点之上</span></span><br><span class=\"line\"><span class=\"comment\">  选择父项并对路径的</span></span><br><span class=\"line\"><span class=\"comment\">  a 不是悬停元素，将“a”发送到后面</span></span><br><span class=\"line\"><span class=\"comment\">  a 是悬停元素，将“a”放在前面</span></span><br><span class=\"line\"><span class=\"comment\">   */</span></span><br><span class=\"line\">  <span class=\"variable language_\">this</span>.<span class=\"property\">svgGroup</span>.<span class=\"title function_\">selectAll</span>(<span class=\"string\">&quot;g.node&quot;</span>).<span class=\"title function_\">sort</span>(<span class=\"function\">(<span class=\"params\">a, b</span>) =&gt;</span> &#123; <span class=\"comment\">// select the parent and sort the path&#x27;s</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (a.<span class=\"property\">id</span> !== <span class=\"variable language_\">this</span>.<span class=\"property\">draggingNode</span>.<span class=\"property\">id</span>) <span class=\"keyword\">return</span> <span class=\"number\">1</span>; <span class=\"comment\">// a is not the hovered element, send &quot;a&quot; to the back</span></span><br><span class=\"line\">    <span class=\"keyword\">else</span> <span class=\"keyword\">return</span> -<span class=\"number\">1</span>; <span class=\"comment\">// a is the hovered element, bring &quot;a&quot; to the front</span></span><br><span class=\"line\">  &#125;);</span><br><span class=\"line\">  <span class=\"comment\">// 如果节点有子节点，请删除链接和节点</span></span><br><span class=\"line\">  <span class=\"keyword\">if</span> (<span class=\"variable language_\">this</span>.<span class=\"property\">nodes</span>.<span class=\"property\">length</span> &gt; <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">    <span class=\"comment\">// remove link paths 删除链接路径</span></span><br><span class=\"line\">    <span class=\"keyword\">let</span> links = <span class=\"variable language_\">this</span>.<span class=\"property\">tree</span>.<span class=\"title function_\">links</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">nodes</span>);</span><br><span class=\"line\">    <span class=\"keyword\">let</span> nodePaths = <span class=\"variable language_\">this</span>.<span class=\"property\">svgGroup</span>.<span class=\"title function_\">selectAll</span>(<span class=\"string\">&quot;path.link&quot;</span>)</span><br><span class=\"line\">        .<span class=\"title function_\">data</span>(links, <span class=\"function\">(<span class=\"params\">d</span>) =&gt;</span> &#123;</span><br><span class=\"line\">          <span class=\"keyword\">return</span> d.<span class=\"property\">target</span>.<span class=\"property\">id</span>;</span><br><span class=\"line\">        &#125;).<span class=\"title function_\">remove</span>();</span><br><span class=\"line\">    <span class=\"comment\">// remove child nodes 删除子节点</span></span><br><span class=\"line\">    <span class=\"keyword\">let</span> nodesExit = <span class=\"variable language_\">this</span>.<span class=\"property\">svgGroup</span>.<span class=\"title function_\">selectAll</span>(<span class=\"string\">&quot;g.node&quot;</span>)</span><br><span class=\"line\">        .<span class=\"title function_\">data</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">nodes</span>, <span class=\"function\">(<span class=\"params\">d</span>) =&gt;</span> &#123;</span><br><span class=\"line\">          <span class=\"keyword\">return</span> d.<span class=\"property\">id</span>;</span><br><span class=\"line\">        &#125;).<span class=\"title function_\">filter</span>(<span class=\"function\">(<span class=\"params\">d, i</span>) =&gt;</span> &#123;</span><br><span class=\"line\">          <span class=\"keyword\">if</span> (d.<span class=\"property\">id</span> === <span class=\"variable language_\">this</span>.<span class=\"property\">draggingNode</span>.<span class=\"property\">id</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">          <span class=\"keyword\">return</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">        &#125;).<span class=\"title function_\">remove</span>();</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\">// remove parent link</span></span><br><span class=\"line\">  <span class=\"keyword\">let</span> parentLink = <span class=\"variable language_\">this</span>.<span class=\"property\">tree</span>.<span class=\"title function_\">links</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">tree</span>.<span class=\"title function_\">nodes</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">draggingNode</span>.<span class=\"property\">parent</span>));</span><br><span class=\"line\">  <span class=\"variable language_\">this</span>.<span class=\"property\">svgGroup</span>.<span class=\"title function_\">selectAll</span>(<span class=\"string\">&#x27;path.link&#x27;</span>).<span class=\"title function_\">filter</span>(<span class=\"function\">(<span class=\"params\">d, i</span>) =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (d.<span class=\"property\">target</span>.<span class=\"property\">id</span> === <span class=\"variable language_\">this</span>.<span class=\"property\">draggingNode</span>.<span class=\"property\">id</span>) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">return</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">  &#125;).<span class=\"title function_\">remove</span>();</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"variable language_\">this</span>.<span class=\"property\">dragStarted</span> = <span class=\"literal\">null</span>;</span><br><span class=\"line\">&#125;,</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">//更新指示拖动隶属关系的临时连接器</span></span><br><span class=\"line\"><span class=\"title function_\">updateTempConnector</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">var</span> data = [];</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (<span class=\"variable language_\">this</span>.<span class=\"property\">draggingNode</span> !== <span class=\"literal\">null</span> &amp;&amp; <span class=\"variable language_\">this</span>.<span class=\"property\">selectedNode</span> !== <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">    <span class=\"comment\">// have to flip the source coordinates since we did this for the existing connectors on the original tree</span></span><br><span class=\"line\">    data = [&#123;</span><br><span class=\"line\">      <span class=\"attr\">source</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">x</span>: <span class=\"variable language_\">this</span>.<span class=\"property\">selectedNode</span>.<span class=\"property\">y0</span>,</span><br><span class=\"line\">        <span class=\"attr\">y</span>: <span class=\"variable language_\">this</span>.<span class=\"property\">selectedNode</span>.<span class=\"property\">x0</span></span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      <span class=\"attr\">target</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">x</span>: <span class=\"variable language_\">this</span>.<span class=\"property\">draggingNode</span>.<span class=\"property\">y0</span>,</span><br><span class=\"line\">        <span class=\"attr\">y</span>: <span class=\"variable language_\">this</span>.<span class=\"property\">draggingNode</span>.<span class=\"property\">x0</span></span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;];</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">let</span> link = <span class=\"variable language_\">this</span>.<span class=\"property\">svgGroup</span>.<span class=\"title function_\">selectAll</span>(<span class=\"string\">&quot;.templink&quot;</span>).<span class=\"title function_\">data</span>(data);</span><br><span class=\"line\"></span><br><span class=\"line\">  link.<span class=\"title function_\">enter</span>().<span class=\"title function_\">append</span>(<span class=\"string\">&quot;path&quot;</span>)</span><br><span class=\"line\">      .<span class=\"title function_\">attr</span>(<span class=\"string\">&quot;class&quot;</span>, <span class=\"string\">&quot;templink&quot;</span>)</span><br><span class=\"line\">      .<span class=\"title function_\">attr</span>(<span class=\"string\">&quot;d&quot;</span>, d3.<span class=\"property\">svg</span>.<span class=\"title function_\">diagonal</span>())</span><br><span class=\"line\">      .<span class=\"title function_\">attr</span>(<span class=\"string\">&#x27;pointer-events&#x27;</span>, <span class=\"string\">&#x27;none&#x27;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">  link.<span class=\"title function_\">attr</span>(<span class=\"string\">&quot;d&quot;</span>, d3.<span class=\"property\">svg</span>.<span class=\"title function_\">diagonal</span>());</span><br><span class=\"line\"></span><br><span class=\"line\">  link.<span class=\"title function_\">exit</span>().<span class=\"title function_\">remove</span>();</span><br><span class=\"line\">&#125;,</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure></p>\n<h2 id=\"d3-方法介绍\"><a class=\"anchor\" href=\"#d3-方法介绍\">#</a> d3 方法介绍</h2>\n<h4 id=\"append\"><a class=\"anchor\" href=\"#append\">#</a> append()</h4>\n<p><code>.append('svg')</code>  和 <code>.append('g')</code>  是 D3 中的方法，用于在 DOM 中添加 SVG 元素和 G 元素。</p>\n<p><code>.append('svg')</code>  方法用于在选定的 DOM 元素中添加一个 SVG 元素。SVG（可缩放矢量图形）是一种用于在 Web 上显示矢量图形的 XML 语言。通过使用 <code>.append('svg')</code>  方法，你可以在 DOM 中创建一个包含 SVG 图形的容器，以便在其中绘制图形、添加元素等。例如：</p>\n<p><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">javascript复制d3.<span class=\"title function_\">select</span>(<span class=\"string\">&#x27;body&#x27;</span>).<span class=\"title function_\">append</span>(<span class=\"string\">&#x27;svg&#x27;</span>)</span><br><span class=\"line\">  .<span class=\"title function_\">attr</span>(<span class=\"string\">&#x27;width&#x27;</span>, <span class=\"number\">500</span>)</span><br><span class=\"line\">  .<span class=\"title function_\">attr</span>(<span class=\"string\">&#x27;height&#x27;</span>, <span class=\"number\">300</span>);</span><br></pre></td></tr></table></figure></p>\n<p>上述代码在 <code>&lt;body&gt;</code>  元素中添加了一个 SVG 元素，并设置宽度为 500 像素、高度为 300 像素。</p>\n<p><code>.append('g')</code>  方法用于在已经存在的 SVG 元素中添加一个 G 元素。G 元素是 SVG 中的分组元素，可以用于组织和管理其他 SVG 元素。你可以将 G 元素看作是一个容器，可以在其中放置其他 SVG 元素，然后对整个组进行变换、样式设置等操作。例如：</p>\n<p><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">javascript复制<span class=\"keyword\">const</span> svg = d3.<span class=\"title function_\">select</span>(<span class=\"string\">&#x27;body&#x27;</span>).<span class=\"title function_\">append</span>(<span class=\"string\">&#x27;svg&#x27;</span>)</span><br><span class=\"line\">  .<span class=\"title function_\">attr</span>(<span class=\"string\">&#x27;width&#x27;</span>, <span class=\"number\">500</span>)</span><br><span class=\"line\">  .<span class=\"title function_\">attr</span>(<span class=\"string\">&#x27;height&#x27;</span>, <span class=\"number\">300</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> g = svg.<span class=\"title function_\">append</span>(<span class=\"string\">&#x27;g&#x27;</span>)</span><br><span class=\"line\">  .<span class=\"title function_\">attr</span>(<span class=\"string\">&#x27;transform&#x27;</span>, <span class=\"string\">&#x27;translate(50, 50)&#x27;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">g.<span class=\"title function_\">append</span>(<span class=\"string\">&#x27;rect&#x27;</span>)</span><br><span class=\"line\">  .<span class=\"title function_\">attr</span>(<span class=\"string\">&#x27;width&#x27;</span>, <span class=\"number\">100</span>)</span><br><span class=\"line\">  .<span class=\"title function_\">attr</span>(<span class=\"string\">&#x27;height&#x27;</span>, <span class=\"number\">50</span>)</span><br><span class=\"line\">  .<span class=\"title function_\">attr</span>(<span class=\"string\">&#x27;fill&#x27;</span>, <span class=\"string\">&#x27;blue&#x27;</span>);</span><br></pre></td></tr></table></figure></p>\n<p>上述代码先在 <code>&lt;body&gt;</code>  元素中添加了一个 SVG 元素，然后在 SVG 元素中添加了一个 G 元素，设置了 G 元素的平移变换，最后在 G 元素中添加了一个矩形元素。</p>\n<p>希望解答了你的问题。如果还有其他疑问，请随时提出。</p>\n<h5 id=\"d3behaviordrag\"><a class=\"anchor\" href=\"#d3behaviordrag\">#</a> d3.behavior.drag()</h5>\n<ol>\n<li><code>dragstart</code> ：当拖拽开始时触发。在这个回调函数中，首先判断拖拽的目标节点 <code>d</code>  是否为根节点 <code>this.root</code> 。如果是根节点，则直接返回，不执行后续的拖拽操作。否则，将 <code>this.dragStarted</code>  标志设置为 <code>true</code> ，并获取该节点的所有子节点。最后，通过 <code>d3.event.sourceEvent.stopPropagation()</code>  阻止事件继续传播。</li>\n<li><code>drag</code> ：当拖拽过程中持续触发。在这个回调函数中，首先判断拖拽的目标节点 <code>d</code>  是否为根节点 <code>this.root</code> 。如果是根节点，则直接返回，不执行后续的拖拽操作。接下来，如果 <code>this.dragStarted</code>  为 <code>true</code> ，则调用 <code>initiateDrag()</code>  方法来初始化拖拽操作。然后，获取鼠标事件相对于 SVG 容器的坐标，并根据坐标来判断是否需要进行平移操作。最后，更新目标节点的位置，并调用 <code>updateTempConnector()</code>  方法更新临时连接器。</li>\n<li><code>dragend</code> ：当拖拽结束时触发。在这个回调函数中，首先判断拖拽的目标节点 <code>d</code>  是否为根节点 <code>this.root</code> ，如果是根节点，则直接返回。接下来，将 <code>this.domNode</code>  设置为当前节点，并判断是否有选中的节点 <code>this.selectedNode</code> 。如果有选中的节点，则将被拖拽的节点 <code>this.draggingNode</code>  从其父节点中移除，并将其添加到选中的节点的子节点或子节点集合中，然后展开选中的节点，对树进行排序，并结束拖拽操作。如果没有选中的节点，则直接结束拖拽操作。</li>\n</ol>\n<p><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> dragListener = d3.<span class=\"property\">behavior</span>.<span class=\"title function_\">drag</span>()</span><br><span class=\"line\">          .<span class=\"title function_\">on</span>(<span class=\"string\">&quot;dragstart&quot;</span>, <span class=\"function\">(<span class=\"params\">d</span>) =&gt;</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (d === <span class=\"variable language_\">this</span>.<span class=\"property\">root</span>) &#123;</span><br><span class=\"line\">              <span class=\"keyword\">return</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"variable language_\">this</span>.<span class=\"property\">dragStarted</span> = <span class=\"literal\">true</span>;</span><br><span class=\"line\">            <span class=\"variable language_\">this</span>.<span class=\"property\">nodes</span> = <span class=\"variable language_\">this</span>.<span class=\"property\">tree</span>.<span class=\"title function_\">nodes</span>(d);</span><br><span class=\"line\">            d3.<span class=\"property\">event</span>.<span class=\"property\">sourceEvent</span>.<span class=\"title function_\">stopPropagation</span>();</span><br><span class=\"line\">          &#125;).<span class=\"title function_\">on</span>(<span class=\"string\">&quot;drag&quot;</span>, <span class=\"function\">(<span class=\"params\">d</span>) =&gt;</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (d === <span class=\"variable language_\">this</span>.<span class=\"property\">root</span>) &#123;</span><br><span class=\"line\">              <span class=\"keyword\">return</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (<span class=\"variable language_\">this</span>.<span class=\"property\">dragStarted</span>) &#123;</span><br><span class=\"line\">              <span class=\"keyword\">let</span> domNode = <span class=\"variable language_\">this</span>;</span><br><span class=\"line\">              <span class=\"variable language_\">this</span>.<span class=\"title function_\">initiateDrag</span>(d, domNode);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"comment\">//获取mouseEvent相对于SVG容器的同弦以允许摇摄</span></span><br><span class=\"line\">            <span class=\"keyword\">let</span> relCoords = d3.<span class=\"title function_\">mouse</span>($(<span class=\"string\">&#x27;svg&#x27;</span>).<span class=\"title function_\">get</span>(<span class=\"number\">0</span>));</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (relCoords[<span class=\"number\">0</span>] &lt; <span class=\"variable language_\">this</span>.<span class=\"property\">panBoundary</span>)&#123;</span><br><span class=\"line\">              <span class=\"variable language_\">this</span>.<span class=\"property\">panTimer</span> = <span class=\"literal\">true</span>;</span><br><span class=\"line\">              <span class=\"variable language_\">this</span>.<span class=\"title function_\">pan</span>(<span class=\"variable language_\">this</span>, <span class=\"string\">&#x27;left&#x27;</span>);</span><br><span class=\"line\">            &#125;<span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (relCoords[<span class=\"number\">0</span>] &gt; ($(<span class=\"string\">&#x27;svg&#x27;</span>).<span class=\"title function_\">width</span>() - <span class=\"variable language_\">this</span>.<span class=\"property\">panBoundary</span>)) &#123;</span><br><span class=\"line\">              <span class=\"variable language_\">this</span>.<span class=\"property\">panTimer</span> = <span class=\"literal\">true</span>;</span><br><span class=\"line\">              <span class=\"variable language_\">this</span>.<span class=\"title function_\">pan</span>(<span class=\"variable language_\">this</span>, <span class=\"string\">&#x27;right&#x27;</span>);</span><br><span class=\"line\">            &#125;<span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (relCoords[<span class=\"number\">1</span>] &lt; <span class=\"variable language_\">this</span>.<span class=\"property\">panBoundary</span>) &#123;</span><br><span class=\"line\">              <span class=\"variable language_\">this</span>.<span class=\"property\">panTimer</span> = <span class=\"literal\">true</span>;</span><br><span class=\"line\">              <span class=\"variable language_\">this</span>.<span class=\"title function_\">pan</span>(<span class=\"variable language_\">this</span>, <span class=\"string\">&#x27;up&#x27;</span>);</span><br><span class=\"line\">            &#125;<span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (relCoords[<span class=\"number\">1</span>] &gt; ($(<span class=\"string\">&#x27;svg&#x27;</span>).<span class=\"title function_\">height</span>() - <span class=\"variable language_\">this</span>.<span class=\"property\">panBoundary</span>)) &#123;</span><br><span class=\"line\">              <span class=\"variable language_\">this</span>.<span class=\"property\">panTimer</span> = <span class=\"literal\">true</span>;</span><br><span class=\"line\">              <span class=\"variable language_\">this</span>.<span class=\"title function_\">pan</span>(<span class=\"variable language_\">this</span>, <span class=\"string\">&#x27;down&#x27;</span>);</span><br><span class=\"line\">            &#125;<span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">              <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                <span class=\"built_in\">clearTimeout</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">panTimer</span>);</span><br><span class=\"line\">              &#125; <span class=\"keyword\">catch</span> (e) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">              &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            d.<span class=\"property\">x0</span> += d3.<span class=\"property\">event</span>.<span class=\"property\">dy</span>;</span><br><span class=\"line\">            d.<span class=\"property\">y0</span> += d3.<span class=\"property\">event</span>.<span class=\"property\">dx</span>;</span><br><span class=\"line\">            <span class=\"keyword\">var</span> node = d3.<span class=\"title function_\">select</span>(<span class=\"variable language_\">this</span>);</span><br><span class=\"line\">            node.<span class=\"title function_\">attr</span>(<span class=\"string\">&quot;transform&quot;</span>, <span class=\"string\">&quot;translate(&quot;</span> + d.<span class=\"property\">y0</span> + <span class=\"string\">&quot;,&quot;</span> + d.<span class=\"property\">x0</span> + <span class=\"string\">&quot;)&quot;</span>);</span><br><span class=\"line\">            <span class=\"variable language_\">this</span>.<span class=\"title function_\">updateTempConnector</span>();</span><br><span class=\"line\">          &#125;).<span class=\"title function_\">on</span>(<span class=\"string\">&quot;dragend&quot;</span>, <span class=\"function\">(<span class=\"params\">d</span>) =&gt;</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (d === <span class=\"variable language_\">this</span>.<span class=\"property\">root</span>) &#123;<span class=\"keyword\">return</span>;&#125;</span><br><span class=\"line\">            <span class=\"variable language_\">this</span>.<span class=\"property\">domNode</span> = <span class=\"variable language_\">this</span>;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (<span class=\"variable language_\">this</span>.<span class=\"property\">selectedNode</span>)&#123;</span><br><span class=\"line\">              <span class=\"keyword\">var</span> index = <span class=\"variable language_\">this</span>.<span class=\"property\">draggingNode</span>.<span class=\"property\">parent</span>.<span class=\"property\">children</span>.<span class=\"title function_\">indexOf</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">draggingNode</span>);</span><br><span class=\"line\">              <span class=\"keyword\">if</span> (index &gt; -<span class=\"number\">1</span> )&#123;</span><br><span class=\"line\">                <span class=\"variable language_\">this</span>.<span class=\"property\">draggingNode</span>.<span class=\"property\">parent</span>.<span class=\"property\">children</span>.<span class=\"title function_\">splice</span>(index, <span class=\"number\">1</span>);</span><br><span class=\"line\">              &#125;</span><br><span class=\"line\">              <span class=\"keyword\">if</span> (<span class=\"keyword\">typeof</span> <span class=\"variable language_\">this</span>.<span class=\"property\">selectedNode</span>.<span class=\"property\">children</span> !== <span class=\"string\">&quot;undefined&quot;</span> || <span class=\"keyword\">typeof</span> <span class=\"variable language_\">this</span>.<span class=\"property\">selectedNode</span>.<span class=\"property\">_children</span> !== <span class=\"string\">&#x27;undefined&#x27;</span>)&#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (<span class=\"keyword\">typeof</span> <span class=\"variable language_\">this</span>.<span class=\"property\">selectedNode</span>.<span class=\"property\">_children</span> !== <span class=\"string\">&quot;undefined&quot;</span>) &#123;</span><br><span class=\"line\">                  <span class=\"variable language_\">this</span>.<span class=\"property\">selectedNode</span>.<span class=\"property\">children</span>.<span class=\"title function_\">push</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">draggingNode</span>)</span><br><span class=\"line\">                &#125;<span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                  <span class=\"variable language_\">this</span>.<span class=\"property\">selectedNode</span>.<span class=\"property\">_children</span>.<span class=\"title function_\">push</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">draggingNode</span>)</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">              &#125;<span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                <span class=\"variable language_\">this</span>.<span class=\"property\">selectedNode</span>.<span class=\"property\">children</span> = []</span><br><span class=\"line\">                <span class=\"variable language_\">this</span>.<span class=\"property\">selectedNode</span>.<span class=\"property\">children</span>.<span class=\"title function_\">push</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">draggingNode</span>)</span><br><span class=\"line\">              &#125;</span><br><span class=\"line\">              <span class=\"comment\">//确保要添加到的节点已展开，以便用户可以看到添加的节点已正确移动</span></span><br><span class=\"line\">              <span class=\"variable language_\">this</span>.<span class=\"title function_\">expand</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">selectedNode</span>);</span><br><span class=\"line\">              <span class=\"variable language_\">this</span>.<span class=\"title function_\">sortTree</span>();</span><br><span class=\"line\">              <span class=\"variable language_\">this</span>.<span class=\"title function_\">endDrag</span>();</span><br><span class=\"line\">            &#125;<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">              <span class=\"variable language_\">this</span>.<span class=\"title function_\">endDrag</span>();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">          &#125;);</span><br></pre></td></tr></table></figure></p>\n<h2 id=\"end-完整代码\"><a class=\"anchor\" href=\"#end-完整代码\">#</a> End  完整代码</h2>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br><span class=\"line\">170</span><br><span class=\"line\">171</span><br><span class=\"line\">172</span><br><span class=\"line\">173</span><br><span class=\"line\">174</span><br><span class=\"line\">175</span><br><span class=\"line\">176</span><br><span class=\"line\">177</span><br><span class=\"line\">178</span><br><span class=\"line\">179</span><br><span class=\"line\">180</span><br><span class=\"line\">181</span><br><span class=\"line\">182</span><br><span class=\"line\">183</span><br><span class=\"line\">184</span><br><span class=\"line\">185</span><br><span class=\"line\">186</span><br><span class=\"line\">187</span><br><span class=\"line\">188</span><br><span class=\"line\">189</span><br><span class=\"line\">190</span><br><span class=\"line\">191</span><br><span class=\"line\">192</span><br><span class=\"line\">193</span><br><span class=\"line\">194</span><br><span class=\"line\">195</span><br><span class=\"line\">196</span><br><span class=\"line\">197</span><br><span class=\"line\">198</span><br><span class=\"line\">199</span><br><span class=\"line\">200</span><br><span class=\"line\">201</span><br><span class=\"line\">202</span><br><span class=\"line\">203</span><br><span class=\"line\">204</span><br><span class=\"line\">205</span><br><span class=\"line\">206</span><br><span class=\"line\">207</span><br><span class=\"line\">208</span><br><span class=\"line\">209</span><br><span class=\"line\">210</span><br><span class=\"line\">211</span><br><span class=\"line\">212</span><br><span class=\"line\">213</span><br><span class=\"line\">214</span><br><span class=\"line\">215</span><br><span class=\"line\">216</span><br><span class=\"line\">217</span><br><span class=\"line\">218</span><br><span class=\"line\">219</span><br><span class=\"line\">220</span><br><span class=\"line\">221</span><br><span class=\"line\">222</span><br><span class=\"line\">223</span><br><span class=\"line\">224</span><br><span class=\"line\">225</span><br><span class=\"line\">226</span><br><span class=\"line\">227</span><br><span class=\"line\">228</span><br><span class=\"line\">229</span><br><span class=\"line\">230</span><br><span class=\"line\">231</span><br><span class=\"line\">232</span><br><span class=\"line\">233</span><br><span class=\"line\">234</span><br><span class=\"line\">235</span><br><span class=\"line\">236</span><br><span class=\"line\">237</span><br><span class=\"line\">238</span><br><span class=\"line\">239</span><br><span class=\"line\">240</span><br><span class=\"line\">241</span><br><span class=\"line\">242</span><br><span class=\"line\">243</span><br><span class=\"line\">244</span><br><span class=\"line\">245</span><br><span class=\"line\">246</span><br><span class=\"line\">247</span><br><span class=\"line\">248</span><br><span class=\"line\">249</span><br><span class=\"line\">250</span><br><span class=\"line\">251</span><br><span class=\"line\">252</span><br><span class=\"line\">253</span><br><span class=\"line\">254</span><br><span class=\"line\">255</span><br><span class=\"line\">256</span><br><span class=\"line\">257</span><br><span class=\"line\">258</span><br><span class=\"line\">259</span><br><span class=\"line\">260</span><br><span class=\"line\">261</span><br><span class=\"line\">262</span><br><span class=\"line\">263</span><br><span class=\"line\">264</span><br><span class=\"line\">265</span><br><span class=\"line\">266</span><br><span class=\"line\">267</span><br><span class=\"line\">268</span><br><span class=\"line\">269</span><br><span class=\"line\">270</span><br><span class=\"line\">271</span><br><span class=\"line\">272</span><br><span class=\"line\">273</span><br><span class=\"line\">274</span><br><span class=\"line\">275</span><br><span class=\"line\">276</span><br><span class=\"line\">277</span><br><span class=\"line\">278</span><br><span class=\"line\">279</span><br><span class=\"line\">280</span><br><span class=\"line\">281</span><br><span class=\"line\">282</span><br><span class=\"line\">283</span><br><span class=\"line\">284</span><br><span class=\"line\">285</span><br><span class=\"line\">286</span><br><span class=\"line\">287</span><br><span class=\"line\">288</span><br><span class=\"line\">289</span><br><span class=\"line\">290</span><br><span class=\"line\">291</span><br><span class=\"line\">292</span><br><span class=\"line\">293</span><br><span class=\"line\">294</span><br><span class=\"line\">295</span><br><span class=\"line\">296</span><br><span class=\"line\">297</span><br><span class=\"line\">298</span><br><span class=\"line\">299</span><br><span class=\"line\">300</span><br><span class=\"line\">301</span><br><span class=\"line\">302</span><br><span class=\"line\">303</span><br><span class=\"line\">304</span><br><span class=\"line\">305</span><br><span class=\"line\">306</span><br><span class=\"line\">307</span><br><span class=\"line\">308</span><br><span class=\"line\">309</span><br><span class=\"line\">310</span><br><span class=\"line\">311</span><br><span class=\"line\">312</span><br><span class=\"line\">313</span><br><span class=\"line\">314</span><br><span class=\"line\">315</span><br><span class=\"line\">316</span><br><span class=\"line\">317</span><br><span class=\"line\">318</span><br><span class=\"line\">319</span><br><span class=\"line\">320</span><br><span class=\"line\">321</span><br><span class=\"line\">322</span><br><span class=\"line\">323</span><br><span class=\"line\">324</span><br><span class=\"line\">325</span><br><span class=\"line\">326</span><br><span class=\"line\">327</span><br><span class=\"line\">328</span><br><span class=\"line\">329</span><br><span class=\"line\">330</span><br><span class=\"line\">331</span><br><span class=\"line\">332</span><br><span class=\"line\">333</span><br><span class=\"line\">334</span><br><span class=\"line\">335</span><br><span class=\"line\">336</span><br><span class=\"line\">337</span><br><span class=\"line\">338</span><br><span class=\"line\">339</span><br><span class=\"line\">340</span><br><span class=\"line\">341</span><br><span class=\"line\">342</span><br><span class=\"line\">343</span><br><span class=\"line\">344</span><br><span class=\"line\">345</span><br><span class=\"line\">346</span><br><span class=\"line\">347</span><br><span class=\"line\">348</span><br><span class=\"line\">349</span><br><span class=\"line\">350</span><br><span class=\"line\">351</span><br><span class=\"line\">352</span><br><span class=\"line\">353</span><br><span class=\"line\">354</span><br><span class=\"line\">355</span><br><span class=\"line\">356</span><br><span class=\"line\">357</span><br><span class=\"line\">358</span><br><span class=\"line\">359</span><br><span class=\"line\">360</span><br><span class=\"line\">361</span><br><span class=\"line\">362</span><br><span class=\"line\">363</span><br><span class=\"line\">364</span><br><span class=\"line\">365</span><br><span class=\"line\">366</span><br><span class=\"line\">367</span><br><span class=\"line\">368</span><br><span class=\"line\">369</span><br><span class=\"line\">370</span><br><span class=\"line\">371</span><br><span class=\"line\">372</span><br><span class=\"line\">373</span><br><span class=\"line\">374</span><br><span class=\"line\">375</span><br><span class=\"line\">376</span><br><span class=\"line\">377</span><br><span class=\"line\">378</span><br><span class=\"line\">379</span><br><span class=\"line\">380</span><br><span class=\"line\">381</span><br><span class=\"line\">382</span><br><span class=\"line\">383</span><br><span class=\"line\">384</span><br><span class=\"line\">385</span><br><span class=\"line\">386</span><br><span class=\"line\">387</span><br><span class=\"line\">388</span><br><span class=\"line\">389</span><br><span class=\"line\">390</span><br><span class=\"line\">391</span><br><span class=\"line\">392</span><br><span class=\"line\">393</span><br><span class=\"line\">394</span><br><span class=\"line\">395</span><br><span class=\"line\">396</span><br><span class=\"line\">397</span><br><span class=\"line\">398</span><br><span class=\"line\">399</span><br><span class=\"line\">400</span><br><span class=\"line\">401</span><br><span class=\"line\">402</span><br><span class=\"line\">403</span><br><span class=\"line\">404</span><br><span class=\"line\">405</span><br><span class=\"line\">406</span><br><span class=\"line\">407</span><br><span class=\"line\">408</span><br><span class=\"line\">409</span><br><span class=\"line\">410</span><br><span class=\"line\">411</span><br><span class=\"line\">412</span><br><span class=\"line\">413</span><br><span class=\"line\">414</span><br><span class=\"line\">415</span><br><span class=\"line\">416</span><br><span class=\"line\">417</span><br><span class=\"line\">418</span><br><span class=\"line\">419</span><br><span class=\"line\">420</span><br><span class=\"line\">421</span><br><span class=\"line\">422</span><br><span class=\"line\">423</span><br><span class=\"line\">424</span><br><span class=\"line\">425</span><br><span class=\"line\">426</span><br><span class=\"line\">427</span><br><span class=\"line\">428</span><br><span class=\"line\">429</span><br><span class=\"line\">430</span><br><span class=\"line\">431</span><br><span class=\"line\">432</span><br><span class=\"line\">433</span><br><span class=\"line\">434</span><br><span class=\"line\">435</span><br><span class=\"line\">436</span><br><span class=\"line\">437</span><br><span class=\"line\">438</span><br><span class=\"line\">439</span><br><span class=\"line\">440</span><br><span class=\"line\">441</span><br><span class=\"line\">442</span><br><span class=\"line\">443</span><br><span class=\"line\">444</span><br><span class=\"line\">445</span><br><span class=\"line\">446</span><br><span class=\"line\">447</span><br><span class=\"line\">448</span><br><span class=\"line\">449</span><br><span class=\"line\">450</span><br><span class=\"line\">451</span><br><span class=\"line\">452</span><br><span class=\"line\">453</span><br><span class=\"line\">454</span><br><span class=\"line\">455</span><br><span class=\"line\">456</span><br><span class=\"line\">457</span><br><span class=\"line\">458</span><br><span class=\"line\">459</span><br><span class=\"line\">460</span><br><span class=\"line\">461</span><br><span class=\"line\">462</span><br><span class=\"line\">463</span><br><span class=\"line\">464</span><br><span class=\"line\">465</span><br><span class=\"line\">466</span><br><span class=\"line\">467</span><br><span class=\"line\">468</span><br><span class=\"line\">469</span><br><span class=\"line\">470</span><br><span class=\"line\">471</span><br><span class=\"line\">472</span><br><span class=\"line\">473</span><br><span class=\"line\">474</span><br><span class=\"line\">475</span><br><span class=\"line\">476</span><br><span class=\"line\">477</span><br><span class=\"line\">478</span><br><span class=\"line\">479</span><br><span class=\"line\">480</span><br><span class=\"line\">481</span><br><span class=\"line\">482</span><br><span class=\"line\">483</span><br><span class=\"line\">484</span><br><span class=\"line\">485</span><br><span class=\"line\">486</span><br><span class=\"line\">487</span><br><span class=\"line\">488</span><br><span class=\"line\">489</span><br><span class=\"line\">490</span><br><span class=\"line\">491</span><br><span class=\"line\">492</span><br><span class=\"line\">493</span><br><span class=\"line\">494</span><br><span class=\"line\">495</span><br><span class=\"line\">496</span><br><span class=\"line\">497</span><br><span class=\"line\">498</span><br><span class=\"line\">499</span><br><span class=\"line\">500</span><br><span class=\"line\">501</span><br><span class=\"line\">502</span><br><span class=\"line\">503</span><br><span class=\"line\">504</span><br><span class=\"line\">505</span><br><span class=\"line\">506</span><br><span class=\"line\">507</span><br><span class=\"line\">508</span><br><span class=\"line\">509</span><br><span class=\"line\">510</span><br><span class=\"line\">511</span><br><span class=\"line\">512</span><br><span class=\"line\">513</span><br><span class=\"line\">514</span><br><span class=\"line\">515</span><br><span class=\"line\">516</span><br><span class=\"line\">517</span><br><span class=\"line\">518</span><br><span class=\"line\">519</span><br><span class=\"line\">520</span><br><span class=\"line\">521</span><br><span class=\"line\">522</span><br><span class=\"line\">523</span><br><span class=\"line\">524</span><br><span class=\"line\">525</span><br><span class=\"line\">526</span><br><span class=\"line\">527</span><br><span class=\"line\">528</span><br><span class=\"line\">529</span><br><span class=\"line\">530</span><br><span class=\"line\">531</span><br><span class=\"line\">532</span><br><span class=\"line\">533</span><br><span class=\"line\">534</span><br><span class=\"line\">535</span><br><span class=\"line\">536</span><br><span class=\"line\">537</span><br><span class=\"line\">538</span><br><span class=\"line\">539</span><br><span class=\"line\">540</span><br><span class=\"line\">541</span><br><span class=\"line\">542</span><br><span class=\"line\">543</span><br><span class=\"line\">544</span><br><span class=\"line\">545</span><br><span class=\"line\">546</span><br><span class=\"line\">547</span><br><span class=\"line\">548</span><br><span class=\"line\">549</span><br><span class=\"line\">550</span><br><span class=\"line\">551</span><br><span class=\"line\">552</span><br><span class=\"line\">553</span><br><span class=\"line\">554</span><br><span class=\"line\">555</span><br><span class=\"line\">556</span><br><span class=\"line\">557</span><br><span class=\"line\">558</span><br><span class=\"line\">559</span><br><span class=\"line\">560</span><br><span class=\"line\">561</span><br><span class=\"line\">562</span><br><span class=\"line\">563</span><br><span class=\"line\">564</span><br><span class=\"line\">565</span><br><span class=\"line\">566</span><br><span class=\"line\">567</span><br><span class=\"line\">568</span><br><span class=\"line\">569</span><br><span class=\"line\">570</span><br><span class=\"line\">571</span><br><span class=\"line\">572</span><br><span class=\"line\">573</span><br><span class=\"line\">574</span><br><span class=\"line\">575</span><br><span class=\"line\">576</span><br><span class=\"line\">577</span><br><span class=\"line\">578</span><br><span class=\"line\">579</span><br><span class=\"line\">580</span><br><span class=\"line\">581</span><br><span class=\"line\">582</span><br><span class=\"line\">583</span><br><span class=\"line\">584</span><br><span class=\"line\">585</span><br><span class=\"line\">586</span><br><span class=\"line\">587</span><br><span class=\"line\">588</span><br><span class=\"line\">589</span><br><span class=\"line\">590</span><br><span class=\"line\">591</span><br><span class=\"line\">592</span><br><span class=\"line\">593</span><br><span class=\"line\">594</span><br><span class=\"line\">595</span><br><span class=\"line\">596</span><br><span class=\"line\">597</span><br><span class=\"line\">598</span><br><span class=\"line\">599</span><br><span class=\"line\">600</span><br><span class=\"line\">601</span><br><span class=\"line\">602</span><br><span class=\"line\">603</span><br><span class=\"line\">604</span><br><span class=\"line\">605</span><br><span class=\"line\">606</span><br><span class=\"line\">607</span><br><span class=\"line\">608</span><br><span class=\"line\">609</span><br><span class=\"line\">610</span><br><span class=\"line\">611</span><br><span class=\"line\">612</span><br><span class=\"line\">613</span><br><span class=\"line\">614</span><br><span class=\"line\">615</span><br><span class=\"line\">616</span><br><span class=\"line\">617</span><br><span class=\"line\">618</span><br><span class=\"line\">619</span><br><span class=\"line\">620</span><br><span class=\"line\">621</span><br><span class=\"line\">622</span><br><span class=\"line\">623</span><br><span class=\"line\">624</span><br><span class=\"line\">625</span><br><span class=\"line\">626</span><br><span class=\"line\">627</span><br><span class=\"line\">628</span><br><span class=\"line\">629</span><br><span class=\"line\">630</span><br><span class=\"line\">631</span><br><span class=\"line\">632</span><br><span class=\"line\">633</span><br><span class=\"line\">634</span><br><span class=\"line\">635</span><br><span class=\"line\">636</span><br><span class=\"line\">637</span><br><span class=\"line\">638</span><br><span class=\"line\">639</span><br><span class=\"line\">640</span><br><span class=\"line\">641</span><br><span class=\"line\">642</span><br><span class=\"line\">643</span><br><span class=\"line\">644</span><br><span class=\"line\">645</span><br><span class=\"line\">646</span><br><span class=\"line\">647</span><br><span class=\"line\">648</span><br><span class=\"line\">649</span><br><span class=\"line\">650</span><br><span class=\"line\">651</span><br><span class=\"line\">652</span><br><span class=\"line\">653</span><br><span class=\"line\">654</span><br><span class=\"line\">655</span><br><span class=\"line\">656</span><br><span class=\"line\">657</span><br><span class=\"line\">658</span><br><span class=\"line\">659</span><br><span class=\"line\">660</span><br><span class=\"line\">661</span><br><span class=\"line\">662</span><br><span class=\"line\">663</span><br><span class=\"line\">664</span><br><span class=\"line\">665</span><br><span class=\"line\">666</span><br><span class=\"line\">667</span><br><span class=\"line\">668</span><br><span class=\"line\">669</span><br><span class=\"line\">670</span><br><span class=\"line\">671</span><br><span class=\"line\">672</span><br><span class=\"line\">673</span><br><span class=\"line\">674</span><br><span class=\"line\">675</span><br><span class=\"line\">676</span><br><span class=\"line\">677</span><br><span class=\"line\">678</span><br><span class=\"line\">679</span><br><span class=\"line\">680</span><br><span class=\"line\">681</span><br><span class=\"line\">682</span><br><span class=\"line\">683</span><br><span class=\"line\">684</span><br><span class=\"line\">685</span><br><span class=\"line\">686</span><br><span class=\"line\">687</span><br><span class=\"line\">688</span><br><span class=\"line\">689</span><br><span class=\"line\">690</span><br><span class=\"line\">691</span><br><span class=\"line\">692</span><br><span class=\"line\">693</span><br><span class=\"line\">694</span><br><span class=\"line\">695</span><br><span class=\"line\">696</span><br><span class=\"line\">697</span><br><span class=\"line\">698</span><br><span class=\"line\">699</span><br><span class=\"line\">700</span><br><span class=\"line\">701</span><br><span class=\"line\">702</span><br><span class=\"line\">703</span><br><span class=\"line\">704</span><br><span class=\"line\">705</span><br><span class=\"line\">706</span><br><span class=\"line\">707</span><br><span class=\"line\">708</span><br><span class=\"line\">709</span><br><span class=\"line\">710</span><br><span class=\"line\">711</span><br><span class=\"line\">712</span><br><span class=\"line\">713</span><br><span class=\"line\">714</span><br><span class=\"line\">715</span><br><span class=\"line\">716</span><br><span class=\"line\">717</span><br><span class=\"line\">718</span><br><span class=\"line\">719</span><br><span class=\"line\">720</span><br><span class=\"line\">721</span><br><span class=\"line\">722</span><br><span class=\"line\">723</span><br><span class=\"line\">724</span><br><span class=\"line\">725</span><br><span class=\"line\">726</span><br><span class=\"line\">727</span><br><span class=\"line\">728</span><br><span class=\"line\">729</span><br><span class=\"line\">730</span><br><span class=\"line\">731</span><br><span class=\"line\">732</span><br><span class=\"line\">733</span><br><span class=\"line\">734</span><br><span class=\"line\">735</span><br><span class=\"line\">736</span><br><span class=\"line\">737</span><br><span class=\"line\">738</span><br><span class=\"line\">739</span><br><span class=\"line\">740</span><br><span class=\"line\">741</span><br><span class=\"line\">742</span><br><span class=\"line\">743</span><br><span class=\"line\">744</span><br><span class=\"line\">745</span><br><span class=\"line\">746</span><br><span class=\"line\">747</span><br><span class=\"line\">748</span><br><span class=\"line\">749</span><br><span class=\"line\">750</span><br><span class=\"line\">751</span><br><span class=\"line\">752</span><br><span class=\"line\">753</span><br><span class=\"line\">754</span><br><span class=\"line\">755</span><br><span class=\"line\">756</span><br><span class=\"line\">757</span><br><span class=\"line\">758</span><br><span class=\"line\">759</span><br><span class=\"line\">760</span><br><span class=\"line\">761</span><br><span class=\"line\">762</span><br><span class=\"line\">763</span><br><span class=\"line\">764</span><br><span class=\"line\">765</span><br><span class=\"line\">766</span><br><span class=\"line\">767</span><br><span class=\"line\">768</span><br><span class=\"line\">769</span><br><span class=\"line\">770</span><br><span class=\"line\">771</span><br><span class=\"line\">772</span><br><span class=\"line\">773</span><br><span class=\"line\">774</span><br><span class=\"line\">775</span><br><span class=\"line\">776</span><br><span class=\"line\">777</span><br><span class=\"line\">778</span><br><span class=\"line\">779</span><br><span class=\"line\">780</span><br><span class=\"line\">781</span><br><span class=\"line\">782</span><br><span class=\"line\">783</span><br><span class=\"line\">784</span><br><span class=\"line\">785</span><br><span class=\"line\">786</span><br><span class=\"line\">787</span><br><span class=\"line\">788</span><br><span class=\"line\">789</span><br><span class=\"line\">790</span><br><span class=\"line\">791</span><br><span class=\"line\">792</span><br><span class=\"line\">793</span><br><span class=\"line\">794</span><br><span class=\"line\">795</span><br><span class=\"line\">796</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;template&gt;</span><br><span class=\"line\">  &lt;div block :scroll=&quot;true&quot;&gt;</span><br><span class=\"line\">    &lt;div style=&quot;background-color: white;border: 3px black;&quot;&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">    &lt;/div&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;!--    指标下钻--&gt;</span><br><span class=\"line\">  &lt;div id=&quot;screenshot&quot; style=&quot;width:100%;height:90%&quot;&gt;</span><br><span class=\"line\">    &lt;div id=&quot;tree-container&quot; style=&quot;width:100%;height:95%;&quot;&gt;&lt;/div&gt;</span><br><span class=\"line\">  &lt;/div&gt;</span><br><span class=\"line\">    &lt;/div&gt;</span><br><span class=\"line\">&lt;/template&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;script&gt;</span><br><span class=\"line\">import * as d3 from &#x27;d3&#x27;;</span><br><span class=\"line\">import $ from &#x27;jquery&#x27;</span><br><span class=\"line\">export default &#123;</span><br><span class=\"line\">  data()&#123;</span><br><span class=\"line\">    return &#123;</span><br><span class=\"line\">      treeData:&#123;</span><br><span class=\"line\">        name: &#x27;收入&#x27;,</span><br><span class=\"line\">        value:100,</span><br><span class=\"line\">        analysisContent:&quot;demo&quot;,</span><br><span class=\"line\">        children: [</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">            name: &#x27;电费收入&#x27;,</span><br><span class=\"line\">            value: 10,</span><br><span class=\"line\">            analysisContent:&quot;demo&quot;,</span><br><span class=\"line\">            children: []</span><br><span class=\"line\">          &#125;,</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">            name: &#x27;供热收入&#x27;,</span><br><span class=\"line\">            value: 8,</span><br><span class=\"line\">            analysisContent:&quot;demo&quot;,</span><br><span class=\"line\">            children: []</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">          ,</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">            name: &#x27;副产品收入&#x27;,</span><br><span class=\"line\">            value: 8,</span><br><span class=\"line\">            analysisContent:&quot;demo&quot;,</span><br><span class=\"line\">            children: []</span><br><span class=\"line\">          &#125;,</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">            name: &#x27;其他收入&#x27;,</span><br><span class=\"line\">            value: 8,</span><br><span class=\"line\">            analysisContent:&quot;demo&quot;,</span><br><span class=\"line\">            children: []</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        ]</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      //视图大小</span><br><span class=\"line\">      viewerWidth:null,</span><br><span class=\"line\">      viewerHeight:null,</span><br><span class=\"line\">      minHeight:null,</span><br><span class=\"line\">      //层数 判断是否多层，默认显示2层</span><br><span class=\"line\">      depths:[],</span><br><span class=\"line\">      //对角线投影，供稍后的节点路径使用</span><br><span class=\"line\">      diagonal:null,</span><br><span class=\"line\">      //树布局</span><br><span class=\"line\">      tree:null,</span><br><span class=\"line\">      //总节点数</span><br><span class=\"line\">      totalNodes:null,</span><br><span class=\"line\">      //文字最大长度</span><br><span class=\"line\">      maxLabelLength:null,</span><br><span class=\"line\">      zoomListener:null,</span><br><span class=\"line\">      //dragListener  dragstart</span><br><span class=\"line\">      root:null,</span><br><span class=\"line\">      dragStarted:null,</span><br><span class=\"line\">      nodes:null,</span><br><span class=\"line\">      //dragListener  drag</span><br><span class=\"line\">      panTimer:null,</span><br><span class=\"line\">      //initiateDrag  用于拖放的变量</span><br><span class=\"line\">      draggingNode:null,</span><br><span class=\"line\">      selectedNode:null,</span><br><span class=\"line\">      // panning variables  平移变量</span><br><span class=\"line\">      panSpeed: 200,</span><br><span class=\"line\">      panBoundary: 20, // 拖动时，距离边缘 20px 以内将平移。</span><br><span class=\"line\">      // Misc. variables 其他变量</span><br><span class=\"line\">      i:0,</span><br><span class=\"line\">      domNode:null,</span><br><span class=\"line\"></span><br><span class=\"line\">      //centerNode</span><br><span class=\"line\">      duration:750,</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  mounted() &#123;</span><br><span class=\"line\">    this.drawTree();</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  methods: &#123;</span><br><span class=\"line\">    drawTree() &#123;</span><br><span class=\"line\">      //show D3 tree</span><br><span class=\"line\">      this.depths = this.treeDepths(this.treeData);</span><br><span class=\"line\">      console.log(this.depths)</span><br><span class=\"line\">      //建立树布局</span><br><span class=\"line\">      this.minHeight = 500;</span><br><span class=\"line\">      this.viewerWidth = $(&quot;#screenshot&quot;).width();</span><br><span class=\"line\">      this.viewerHeight = $(&quot;#screenshot&quot;).height();</span><br><span class=\"line\">      console.log(this.viewerHeight)</span><br><span class=\"line\">      if (this.viewerHeight &lt; this.minHeight)</span><br><span class=\"line\">        this.viewerHeight = this.minHeight</span><br><span class=\"line\">      this.viewerHeight=500</span><br><span class=\"line\"></span><br><span class=\"line\">      this.tree = d3.layout.tree()</span><br><span class=\"line\">          .size([this.viewerHeight, this.viewerWidth]);</span><br><span class=\"line\">      //定义一个d3对角线投影，供稍后的节点路径使用</span><br><span class=\"line\">      this.diagonal = d3.svg.diagonal()</span><br><span class=\"line\">          .projection(d =&gt; &#123;</span><br><span class=\"line\">            return [d.y, d.x];</span><br><span class=\"line\">          &#125;)</span><br><span class=\"line\"></span><br><span class=\"line\">      //call visit to maxLabelLength</span><br><span class=\"line\">      this.visit(this.treeData, (d) =&gt; &#123;</span><br><span class=\"line\">        this.totalNodes++;</span><br><span class=\"line\">        if (d.name) &#123;</span><br><span class=\"line\">          this.maxLabelLength = Math.max(d.name.length, this.maxLabelLength);</span><br><span class=\"line\">        &#125; else &#123;</span><br><span class=\"line\">          this.maxLabelLength = Math.max(0, this.maxLabelLength);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">      &#125;, (d) =&gt; &#123;</span><br><span class=\"line\">        return d.children &amp;&amp; d.children.length &gt; 0 ? d.children : null;</span><br><span class=\"line\">      &#125;)</span><br><span class=\"line\">      console.log(&quot;总节点&quot;,this.totalNodes)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">      //排序树最初是为了防止json没有按排序顺序排列</span><br><span class=\"line\">      this.sortTree()</span><br><span class=\"line\">      //定义 zoomListener，该 zoomListener 在 scaleExtents 中约束的“zoom”事件上调用缩放</span><br><span class=\"line\">      this.zoomListener = d3.behavior.zoom().scaleExtent([0.1, 3]).on(&quot;zoom&quot;, () =&gt; &#123;</span><br><span class=\"line\">        this.zoom()</span><br><span class=\"line\">      &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">      //创建视图</span><br><span class=\"line\">      const baseSvg = d3.select(&quot;#tree-container&quot;)</span><br><span class=\"line\">          .append(&#x27;svg&#x27;)</span><br><span class=\"line\">          .attr(&#x27;width&#x27;, this.viewerWidth)</span><br><span class=\"line\">          .attr(&#x27;height&#x27;, this.viewerHeight)</span><br><span class=\"line\">          .attr(&quot;class&quot;,&quot;overlay&quot;)</span><br><span class=\"line\">          .append(&quot;g&quot;)</span><br><span class=\"line\">          .call(this.zoomListener)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">      let dragListener = d3.behavior.drag()</span><br><span class=\"line\">          .on(&quot;dragstart&quot;, (d) =&gt; &#123;</span><br><span class=\"line\">            if (d === this.root) &#123;</span><br><span class=\"line\">              return;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            this.dragStarted = true;</span><br><span class=\"line\">            this.nodes = this.tree.nodes(d);</span><br><span class=\"line\">            d3.event.sourceEvent.stopPropagation();</span><br><span class=\"line\">          &#125;).on(&quot;drag&quot;, (d) =&gt; &#123;</span><br><span class=\"line\">            if (d === this.root) &#123;</span><br><span class=\"line\">              return;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            if (this.dragStarted) &#123;</span><br><span class=\"line\">              let domNode = this;</span><br><span class=\"line\">              this.initiateDrag(d, domNode);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            //获取mouseEvent相对于SVG容器的同弦以允许摇摄</span><br><span class=\"line\">            let relCoords = d3.mouse($(&#x27;svg&#x27;).get(0));</span><br><span class=\"line\">            if (relCoords[0] &lt; this.panBoundary)&#123;</span><br><span class=\"line\">              this.panTimer = true;</span><br><span class=\"line\">              this.pan(this, &#x27;left&#x27;);</span><br><span class=\"line\">            &#125;else if (relCoords[0] &gt; ($(&#x27;svg&#x27;).width() - this.panBoundary)) &#123;</span><br><span class=\"line\">              this.panTimer = true;</span><br><span class=\"line\">              this.pan(this, &#x27;right&#x27;);</span><br><span class=\"line\">            &#125;else if (relCoords[1] &lt; this.panBoundary) &#123;</span><br><span class=\"line\">              this.panTimer = true;</span><br><span class=\"line\">              this.pan(this, &#x27;up&#x27;);</span><br><span class=\"line\">            &#125;else if (relCoords[1] &gt; ($(&#x27;svg&#x27;).height() - this.panBoundary)) &#123;</span><br><span class=\"line\">              this.panTimer = true;</span><br><span class=\"line\">              this.pan(this, &#x27;down&#x27;);</span><br><span class=\"line\">            &#125;else &#123;</span><br><span class=\"line\">              try &#123;</span><br><span class=\"line\">                clearTimeout(this.panTimer);</span><br><span class=\"line\">              &#125; catch (e) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">              &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            d.x0 += d3.event.dy;</span><br><span class=\"line\">            d.y0 += d3.event.dx;</span><br><span class=\"line\">            var node = d3.select(this);</span><br><span class=\"line\">            node.attr(&quot;transform&quot;, &quot;translate(&quot; + d.y0 + &quot;,&quot; + d.x0 + &quot;)&quot;);</span><br><span class=\"line\">            //更新临时连接器</span><br><span class=\"line\">            this.updateTempConnector();</span><br><span class=\"line\">          &#125;).on(&quot;dragend&quot;, (d) =&gt; &#123;</span><br><span class=\"line\">            if (d === this.root) &#123;return;&#125;</span><br><span class=\"line\">            this.domNode = this;</span><br><span class=\"line\">            if (this.selectedNode)&#123;</span><br><span class=\"line\">              var index = this.draggingNode.parent.children.indexOf(this.draggingNode);</span><br><span class=\"line\">              if (index &gt; -1 )&#123;</span><br><span class=\"line\">                this.draggingNode.parent.children.splice(index, 1);</span><br><span class=\"line\">              &#125;</span><br><span class=\"line\">              if (typeof this.selectedNode.children !== &quot;undefined&quot; || typeof this.selectedNode._children !== &#x27;undefined&#x27;)&#123;</span><br><span class=\"line\">                if (typeof this.selectedNode._children !== &quot;undefined&quot;) &#123;</span><br><span class=\"line\">                  this.selectedNode.children.push(this.draggingNode)</span><br><span class=\"line\">                &#125;else &#123;</span><br><span class=\"line\">                  this.selectedNode._children.push(this.draggingNode)</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">              &#125;else &#123;</span><br><span class=\"line\">                this.selectedNode.children = []</span><br><span class=\"line\">                this.selectedNode.children.push(this.draggingNode)</span><br><span class=\"line\">              &#125;</span><br><span class=\"line\">              //确保要添加到的节点已展开，以便用户可以看到添加的节点已正确移动</span><br><span class=\"line\">              this.expand(this.selectedNode);</span><br><span class=\"line\">              this.sortTree();</span><br><span class=\"line\">              this.endDrag();</span><br><span class=\"line\">            &#125;else&#123;</span><br><span class=\"line\">              this.endDrag();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">          &#125;);</span><br><span class=\"line\">      //附加一个包含所有节点的组，缩放侦听器可以对其进行操作。</span><br><span class=\"line\">      this.svgGroup = baseSvg.append(&quot;g&quot;);</span><br><span class=\"line\">      //移除双击</span><br><span class=\"line\">      d3.select(&quot;svg&quot;).on(&quot;dblclick.zoom&quot;, null);</span><br><span class=\"line\">      this.root = this.treeData;</span><br><span class=\"line\">      this.root.x0 = this.viewerHeight/2;</span><br><span class=\"line\">      this.root.y0 = 0;</span><br><span class=\"line\">      //最初布局树并以根节点为中心。</span><br><span class=\"line\">      //添加提示框 div</span><br><span class=\"line\">      this.tooltip = d3.select(&quot;#tree-container&quot;).append(&quot;div&quot;)</span><br><span class=\"line\">          .attr(&quot;class&quot;, &quot;tooltip&quot;)</span><br><span class=\"line\">          .style(&quot;opacity&quot;, &quot;1.0&quot;)</span><br><span class=\"line\">          .style(&quot;display&quot;,&quot;none&quot;);</span><br><span class=\"line\"></span><br><span class=\"line\">      this.root.children.forEach(this.collapse);</span><br><span class=\"line\">      this.update(this.root);</span><br><span class=\"line\">      this.centerNode(this.root);</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    //判断是否多层</span><br><span class=\"line\">    treeDepths(g) &#123;</span><br><span class=\"line\">      var depths = [];</span><br><span class=\"line\">      if (g.children)</span><br><span class=\"line\">        g.children.forEach((v) =&gt; &#123;</span><br><span class=\"line\">          this.dfs(v, 1, depths);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">      return depths;</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    //嵌套循环</span><br><span class=\"line\">    dfs(v, depth, depths) &#123;</span><br><span class=\"line\">      var children = v.children;</span><br><span class=\"line\">      if (children &amp;&amp; children.length &gt; 0) &#123;</span><br><span class=\"line\">        children.forEach((child) =&gt; &#123;</span><br><span class=\"line\">          this.dfs(child, depth + 1, depths);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">      &#125; else &#123;</span><br><span class=\"line\">        depths.push(v);</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    //递归 通过遍历所有节点  执行某些设置</span><br><span class=\"line\">    visit(parent, visitFn, childrenFn) &#123;</span><br><span class=\"line\">      if (!parent) return;</span><br><span class=\"line\">      visitFn(parent);</span><br><span class=\"line\">      var children = childrenFn(parent);</span><br><span class=\"line\">      if (children) &#123;</span><br><span class=\"line\">        var count = children.length;</span><br><span class=\"line\">        for (var i = 0; i &lt; count; i++) &#123;</span><br><span class=\"line\">          this.visit(children[i], visitFn, childrenFn);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    //排序</span><br><span class=\"line\">    sortTree() &#123;</span><br><span class=\"line\">      console.log(&quot;==排序开始==&quot;)</span><br><span class=\"line\">      this.tree.sort((a, b) =&gt; &#123;</span><br><span class=\"line\">        return b.name ? b.name.toLowerCase() : b.name &lt; a.name ? a.name.toLowerCase() : a.name ? 1 : -1;</span><br><span class=\"line\">      &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    zoom() &#123;</span><br><span class=\"line\">      this.svgGroup.attr(&quot;transform&quot;, &quot;translate(&quot; + d3.event.translate + &quot;)scale(&quot; + d3.event.scale + &quot;)&quot;);</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    //拖拽开始时对节点进行一系列操作，以确保拖拽过程中节点的正确显示和相关连线的调整。</span><br><span class=\"line\">    initiateDrag(d, domNode) &#123;</span><br><span class=\"line\">      /*</span><br><span class=\"line\">      将当前被拖拽的节点保存在this.draggingNode属性中，</span><br><span class=\"line\">      以便在拖拽过程中能够对其进行操作</span><br><span class=\"line\">       */</span><br><span class=\"line\">      this.draggingNode = d;</span><br><span class=\"line\">      /*</span><br><span class=\"line\">      1=</span><br><span class=\"line\">      为了将被拖拽节点的.ghostCircle元素的</span><br><span class=\"line\">      pointer-events属性设置为none，</span><br><span class=\"line\">      以避免拖拽节点时干扰到其他元素</span><br><span class=\"line\">      2=</span><br><span class=\"line\">      为了将所有.ghostCircle元素的类设置为ghostCircle show，</span><br><span class=\"line\">      这可能是用于显示拖拽节点周围的虚拟元素</span><br><span class=\"line\">      3=为了为被拖拽的节点设置类名，可能是用于在拖拽过程中应用特定的样式</span><br><span class=\"line\">       */</span><br><span class=\"line\">      d3.select(domNode).select(&#x27;.ghostCircle&#x27;).attr(&#x27;pointer-events&#x27;, &#x27;none&#x27;);</span><br><span class=\"line\">      d3.selectAll(&#x27;.ghostCircle&#x27;).attr(&#x27;class&#x27;, &#x27;ghostCircle show&#x27;);</span><br><span class=\"line\">      d3.select(domNode).attr(&#x27;class&#x27;, &#x27;node activeDrag&#x27;);</span><br><span class=\"line\"></span><br><span class=\"line\">      /*</span><br><span class=\"line\">      重新排序所有节点，将被拖拽的节点置于最前面，</span><br><span class=\"line\">      以确保它能够在拖拽过程中正确显示在其他节点之上</span><br><span class=\"line\">      选择父项并对路径的</span><br><span class=\"line\">      a 不是悬停元素，将“a”发送到后面</span><br><span class=\"line\">      a 是悬停元素，将“a”放在前面</span><br><span class=\"line\">       */</span><br><span class=\"line\">      this.svgGroup.selectAll(&quot;g.node&quot;).sort((a, b) =&gt; &#123; // select the parent and sort the path&#x27;s</span><br><span class=\"line\">        if (a.id !== this.draggingNode.id) return 1; // a is not the hovered element, send &quot;a&quot; to the back</span><br><span class=\"line\">        else return -1; // a is the hovered element, bring &quot;a&quot; to the front</span><br><span class=\"line\">      &#125;);</span><br><span class=\"line\">      // 如果节点有子节点，请删除链接和节点</span><br><span class=\"line\">      if (this.nodes.length &gt; 1) &#123;</span><br><span class=\"line\">        // remove link paths 删除链接路径</span><br><span class=\"line\">        let links = this.tree.links(this.nodes);</span><br><span class=\"line\">        let nodePaths = this.svgGroup.selectAll(&quot;path.link&quot;)</span><br><span class=\"line\">            .data(links, (d) =&gt; &#123;</span><br><span class=\"line\">              return d.target.id;</span><br><span class=\"line\">            &#125;).remove();</span><br><span class=\"line\">        // remove child nodes 删除子节点</span><br><span class=\"line\">        let nodesExit = this.svgGroup.selectAll(&quot;g.node&quot;)</span><br><span class=\"line\">            .data(this.nodes, (d) =&gt; &#123;</span><br><span class=\"line\">              return d.id;</span><br><span class=\"line\">            &#125;).filter((d, i) =&gt; &#123;</span><br><span class=\"line\">              if (d.id === this.draggingNode.id) &#123;</span><br><span class=\"line\">                return false;</span><br><span class=\"line\">              &#125;</span><br><span class=\"line\">              return true;</span><br><span class=\"line\">            &#125;).remove();</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">      // remove parent link</span><br><span class=\"line\">      let parentLink = this.tree.links(this.tree.nodes(this.draggingNode.parent));</span><br><span class=\"line\">      this.svgGroup.selectAll(&#x27;path.link&#x27;).filter((d, i) =&gt; &#123;</span><br><span class=\"line\">        if (d.target.id === this.draggingNode.id) &#123;</span><br><span class=\"line\">          return true;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        return false;</span><br><span class=\"line\">      &#125;).remove();</span><br><span class=\"line\"></span><br><span class=\"line\">      this.dragStarted = null;</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    pan(domNode, direction)&#123;</span><br><span class=\"line\">      let speed = this.panSpeed,translateX,translateY;</span><br><span class=\"line\">      if (this.panTimer)&#123;</span><br><span class=\"line\">        clearTimeout(this.panTimer);</span><br><span class=\"line\">        let translateCoords = d3.transform(this.svgGroup.attr(&quot;transform&quot;));</span><br><span class=\"line\">        if (direction === &#x27;left&#x27; || direction === &#x27;right&#x27;) &#123;</span><br><span class=\"line\">          translateX = direction === &#x27;left&#x27; ? translateCoords.translate[0] + speed : translateCoords.translate[0] - speed;</span><br><span class=\"line\">          translateY = translateCoords.translate[1];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        else if (direction === &#x27;up&#x27; || direction === &#x27;down&#x27;) &#123;</span><br><span class=\"line\">          translateX = translateCoords.translate[0];</span><br><span class=\"line\">          translateY = direction === &#x27;up&#x27; ? translateCoords.translate[1] + speed : translateCoords.translate[1] - speed;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        let scaleX = translateCoords.scale[0];</span><br><span class=\"line\">        let scaleY = translateCoords.scale[1];</span><br><span class=\"line\">        let scale = this.zoomListener.scale();</span><br><span class=\"line\">        this.svgGroup.transition().attr(&quot;transform&quot;, &quot;translate(&quot; + translateX + &quot;,&quot; + translateY + &quot;)scale(&quot; + scale + &quot;)&quot;);</span><br><span class=\"line\">        d3.select(domNode).select(&#x27;g.node&#x27;).attr(&quot;transform&quot;, &quot;translate(&quot; + translateX + &quot;,&quot; + translateY + &quot;)&quot;);</span><br><span class=\"line\">        this.zoomListener.scale(this.zoomListener.scale());</span><br><span class=\"line\">        this.zoomListener.translate([translateX, translateY]);</span><br><span class=\"line\">        this.panTimer = setTimeout(()=&gt;&#123;</span><br><span class=\"line\">          this.pan(domNode, direction);</span><br><span class=\"line\">        &#125;,50)</span><br><span class=\"line\"></span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    //to update the temporary connector indicating dragging affiliation</span><br><span class=\"line\">    //更新指示拖动隶属关系的临时连接器</span><br><span class=\"line\">    updateTempConnector() &#123;</span><br><span class=\"line\">      var data = [];</span><br><span class=\"line\">      if (this.draggingNode !== null &amp;&amp; this.selectedNode !== null) &#123;</span><br><span class=\"line\">        // have to flip the source coordinates since we did this for the existing connectors on the original tree</span><br><span class=\"line\">        data = [&#123;</span><br><span class=\"line\">          source: &#123;</span><br><span class=\"line\">            x: this.selectedNode.y0,</span><br><span class=\"line\">            y: this.selectedNode.x0</span><br><span class=\"line\">          &#125;,</span><br><span class=\"line\">          target: &#123;</span><br><span class=\"line\">            x: this.draggingNode.y0,</span><br><span class=\"line\">            y: this.draggingNode.x0</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">        &#125;];</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">      let link = this.svgGroup.selectAll(&quot;.templink&quot;).data(data);</span><br><span class=\"line\"></span><br><span class=\"line\">      link.enter().append(&quot;path&quot;)</span><br><span class=\"line\">          .attr(&quot;class&quot;, &quot;templink&quot;)</span><br><span class=\"line\">          .attr(&quot;d&quot;, d3.svg.diagonal())</span><br><span class=\"line\">          .attr(&#x27;pointer-events&#x27;, &#x27;none&#x27;);</span><br><span class=\"line\"></span><br><span class=\"line\">      link.attr(&quot;d&quot;, d3.svg.diagonal());</span><br><span class=\"line\"></span><br><span class=\"line\">      link.exit().remove();</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\"></span><br><span class=\"line\">    //展开节点</span><br><span class=\"line\">    expand(d)&#123;</span><br><span class=\"line\">      if (d._children)&#123;</span><br><span class=\"line\">        d.children = d._children;</span><br><span class=\"line\">        d.children.forEach(this.expand)</span><br><span class=\"line\">        d._children = null</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    //在拖拽操作结束后，重置节点和虚拟节点的样式和属性，以确保它们恢复到正常状态并且不再响应鼠标事件。</span><br><span class=\"line\">    endDrag()&#123;</span><br><span class=\"line\">      this.selectedNode = null;</span><br><span class=\"line\">      d3.selectAll(&#x27;.ghostCircle&#x27;).attr(&#x27;class&#x27;,&#x27;ghostCircle&#x27;);</span><br><span class=\"line\">      d3.select(this.domNode).attr(&#x27;class&#x27;, &#x27;node&#x27;);</span><br><span class=\"line\">      //禁用这些元素的鼠标事件，使其在拖拽过程中不再响应鼠标交互</span><br><span class=\"line\">      d3.select(this.domNode).select(&#x27;.ghostCircle&#x27;).attr(&#x27;pointer-events&#x27;, &#x27;none&#x27;);</span><br><span class=\"line\">      this.updateTempConnector()</span><br><span class=\"line\">      if (this.draggingNode !=null )&#123;</span><br><span class=\"line\">        this.update(this.root)</span><br><span class=\"line\">        this.centerNode(this.draggingNode)</span><br><span class=\"line\">        this.draggingNode = null;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\"></span><br><span class=\"line\">    //节点更新   重点</span><br><span class=\"line\">    update(source)&#123;</span><br><span class=\"line\">      var width = 130,</span><br><span class=\"line\">          height = 70;</span><br><span class=\"line\">      //计算新 树图的布局</span><br><span class=\"line\">      this.nodes = this.tree.nodes(this.root).reverse();</span><br><span class=\"line\">      let links = this.tree.links(this.nodes)</span><br><span class=\"line\">      //设置y坐标点  每层占  200px；</span><br><span class=\"line\">      this.nodes.forEach(d=&gt;&#123;</span><br><span class=\"line\">        d.y=d.depth * 200</span><br><span class=\"line\">      &#125;)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">      //每个node对应一个group</span><br><span class=\"line\">      //data()：绑定一个数组到选择集上，数组的各项值分别与选择集的各元素绑定</span><br><span class=\"line\">      let node = this.svgGroup.selectAll(&quot;g.node&quot;)</span><br><span class=\"line\">          .data(this.nodes, (d) =&gt; &#123;</span><br><span class=\"line\">            return d.id || (d.id = ++ this.i)</span><br><span class=\"line\">          &#125;)</span><br><span class=\"line\"></span><br><span class=\"line\">      //新增节点数据集，设置位置</span><br><span class=\"line\">      //在 svg 中添加一个g，g是 svg 中的一个属性，是 group 的意思，</span><br><span class=\"line\">      // 它表示一组什么东西，如一组 lines ， rects ，circles</span><br><span class=\"line\">      // 其实坐标轴就是由这些东西构成的。</span><br><span class=\"line\">      let nodeEnter = node.enter().append(&quot;g&quot;)</span><br><span class=\"line\">          .attr(&quot;class&quot;, &quot;node&quot;) //attr设置html属性，style设置css属性</span><br><span class=\"line\">          .attr(&quot;transform&quot;, (d) =&gt; &#123;</span><br><span class=\"line\">            return &quot;translate(&quot; + source.y0 + &quot;,&quot; + source.x0 + &quot;)&quot;;</span><br><span class=\"line\">          &#125;).on(&quot;dblclick&quot;, (d) =&gt; &#123; this.click(d) &#125;);</span><br><span class=\"line\">      //添加连接点---此处设置的是圆圈过渡时候的效果（颜色）</span><br><span class=\"line\">      nodeEnter.append(&quot;rect&quot;)</span><br><span class=\"line\">          .attr(&quot;x&quot;, -65)</span><br><span class=\"line\">          .attr(&quot;y&quot;,-35)</span><br><span class=\"line\">          .attr(&quot;width&quot;, width)</span><br><span class=\"line\">          .attr(&quot;height&quot;, height)</span><br><span class=\"line\">          .attr(&quot;rx&quot;, 10)</span><br><span class=\"line\">          .style(&quot;fill&quot;, &quot;#FFF&quot;); //d 代表数据，也就是与某元素绑定的数据。</span><br><span class=\"line\"></span><br><span class=\"line\">      //指标名称</span><br><span class=\"line\">      nodeEnter.append(&quot;text&quot;)</span><br><span class=\"line\">          .attr(&quot;x&quot;, 0)</span><br><span class=\"line\">          .attr(&quot;dy&quot;, -25)</span><br><span class=\"line\">          .attr(&quot;text-anchor&quot;, &quot;middle&quot;)</span><br><span class=\"line\">          .text((d) =&gt; &#123;</span><br><span class=\"line\">            return d.name;</span><br><span class=\"line\">          &#125;)</span><br><span class=\"line\">          .style(&quot;fill&quot;, &quot;gray&quot;)</span><br><span class=\"line\">          .style(&quot;fill-opacity&quot;, 1)</span><br><span class=\"line\">          .style(&quot;font-size&quot;, &quot;10px&quot;);</span><br><span class=\"line\"></span><br><span class=\"line\">      //指标值</span><br><span class=\"line\">      nodeEnter.append(&quot;text&quot;)</span><br><span class=\"line\">          .attr(&quot;x&quot;, (d) =&gt; &#123;</span><br><span class=\"line\">            return d.children || d._children ? -15 : -15;</span><br><span class=\"line\">          &#125;)</span><br><span class=\"line\">          .attr(&quot;dy&quot;, -5)</span><br><span class=\"line\">          // .attr(&quot;text-anchor&quot;, (d) &#123; return d.children || d._children ? &quot;end&quot; : &quot;start&quot;; &#125;)</span><br><span class=\"line\">          .attr(&quot;text-anchor&quot;, &quot;middle&quot;)</span><br><span class=\"line\">          .text((d) =&gt; &#123;</span><br><span class=\"line\">            return d.value.toLocaleString();</span><br><span class=\"line\">          &#125;)</span><br><span class=\"line\">          .style(&quot;fill&quot;, &quot;blue&quot;)</span><br><span class=\"line\">          .style(&quot;font-size&quot;, &quot;18px&quot;);</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">      //指标单位</span><br><span class=\"line\">      nodeEnter.append(&quot;text&quot;)</span><br><span class=\"line\">          .attr(&quot;x&quot;, (d) =&gt; &#123;</span><br><span class=\"line\">            return d.children || d._children ? d.value != null ? d.value.toString().length * 6 - 4 : 10 : d.value != null ? d.value.toString().length * 6 - 4 : 10;</span><br><span class=\"line\">          &#125;)</span><br><span class=\"line\">          .attr(&quot;dy&quot;, -5)</span><br><span class=\"line\">          // .attr(&quot;text-anchor&quot;, (d) &#123; return d.children || d._children ? &quot;end&quot; : &quot;start&quot;; &#125;)</span><br><span class=\"line\">          .attr(&quot;text-anchor&quot;, &quot;middle&quot;)</span><br><span class=\"line\">          .text(&quot;万元&quot;)</span><br><span class=\"line\">          .style(&quot;fill&quot;, &quot;gray&quot;)</span><br><span class=\"line\">          .style(&quot;font-size&quot;, &quot;10px&quot;)</span><br><span class=\"line\"></span><br><span class=\"line\">      nodeEnter.append(&quot;line&quot;)</span><br><span class=\"line\">          .attr(&quot;x1&quot;, -width / 2)</span><br><span class=\"line\">          .attr(&quot;y1&quot;, 5)</span><br><span class=\"line\">          .attr(&quot;x2&quot;, width / 2)</span><br><span class=\"line\">          .attr(&quot;y2&quot;, 5)</span><br><span class=\"line\">          .attr(&quot;stroke&quot;,function(d)&#123;</span><br><span class=\"line\">            if(d.value === 0)&#123;</span><br><span class=\"line\">              return &#x27;#6b6b6b&#x27;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            return &#x27;steelblue&#x27;</span><br><span class=\"line\">          &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">      nodeEnter.append(&quot;text&quot;)</span><br><span class=\"line\">          .attr(&quot;x&quot;, (d) =&gt; &#123;</span><br><span class=\"line\">            return d.children || d._children ? -40 : -40;</span><br><span class=\"line\">          &#125;)</span><br><span class=\"line\">          .attr(&quot;dy&quot;, 15)</span><br><span class=\"line\">          .attr(&quot;text-anchor&quot;, &quot;middle&quot;)</span><br><span class=\"line\">          .text((d) =&gt; &#123;</span><br><span class=\"line\">            return &quot;同比&quot;</span><br><span class=\"line\">          &#125;)</span><br><span class=\"line\">          .style(&quot;fill&quot;, &quot;gray&quot;)</span><br><span class=\"line\">          .style(&quot;fill-opacity&quot;, 1)</span><br><span class=\"line\">          .style(&quot;font-size&quot;, &quot;10px&quot;);;</span><br><span class=\"line\"></span><br><span class=\"line\">      nodeEnter.append(&quot;text&quot;)</span><br><span class=\"line\">          .attr(&quot;x&quot;, (d) =&gt; &#123;</span><br><span class=\"line\">            return d.children || d._children ? -58 : -58;</span><br><span class=\"line\">          &#125;)</span><br><span class=\"line\">          .attr(&quot;dy&quot;, 30)</span><br><span class=\"line\">          .attr(&quot;text-anchor&quot;, &quot;middle&quot;)</span><br><span class=\"line\">          .text(&quot;↑&quot;)</span><br><span class=\"line\">          .style(&quot;fill&quot;, &quot;red&quot;)</span><br><span class=\"line\">          .style(&quot;font-size&quot;, &quot;15px&quot;);</span><br><span class=\"line\"></span><br><span class=\"line\">      // 新增标签标识</span><br><span class=\"line\">      nodeEnter.append(&quot;text&quot;)</span><br><span class=\"line\">          .attr(&quot;x&quot;, 50)</span><br><span class=\"line\">          .attr(&quot;dy&quot;, 29)</span><br><span class=\"line\">          .attr(&quot;text-anchor&quot;, &quot;middle&quot;)</span><br><span class=\"line\">          .text((d) =&gt; &#123;</span><br><span class=\"line\">            // return &quot;📌&quot;;📑🔖🔗🎫✎</span><br><span class=\"line\">            // return d.labelId != null ? &quot;📑&quot; : &quot;&quot;;</span><br><span class=\"line\">            return &quot;📌&quot;;</span><br><span class=\"line\">          &#125;)</span><br><span class=\"line\">          .style(&quot;fill&quot;,&quot;#2f6db3&quot;)</span><br><span class=\"line\">          .style(&quot;font-size&quot;, &quot;12px&quot;);//75px</span><br><span class=\"line\">      //同比值</span><br><span class=\"line\">      nodeEnter.append(&quot;text&quot;)</span><br><span class=\"line\">          .attr(&quot;x&quot;, (d) =&gt; &#123;</span><br><span class=\"line\">            return d.children || d._children ? -40 : -40;</span><br><span class=\"line\">          &#125;)</span><br><span class=\"line\">          .attr(&quot;dy&quot;, 30)</span><br><span class=\"line\">          .attr(&quot;text-anchor&quot;, &quot;middle&quot;)</span><br><span class=\"line\">          .text((d) =&gt; &#123;</span><br><span class=\"line\">            return d.anValue != null ? Math.abs(d.anValue)+&#x27;%&#x27; : &quot;&quot;;</span><br><span class=\"line\">          &#125;)</span><br><span class=\"line\">          .style(&quot;fill&quot;, (d) =&gt; &#123;</span><br><span class=\"line\">            return &quot;black&quot;;</span><br><span class=\"line\">          &#125;)</span><br><span class=\"line\">          .style(&quot;font-size&quot;, &quot;10px&quot;)</span><br><span class=\"line\">          //-鼠标移入事件</span><br><span class=\"line\">          .on(&quot;mouseover&quot;, (d) =&gt; &#123;</span><br><span class=\"line\">              let xPosition = d3.event.offsetX;</span><br><span class=\"line\">              let yPosition = d3.event.offsetY + 60;</span><br><span class=\"line\">              //添加标签</span><br><span class=\"line\">              this.tooltip.html(d.analysisContent.replace(/\\r/g, &quot;&lt;br&gt;&quot;).replace(/\\r\\n/g, &quot;&lt;br&gt;&quot;))</span><br><span class=\"line\">                  //设置tooltip的位置(left,top 相对于页面的距离)</span><br><span class=\"line\">                  .style(&quot;left&quot;, xPosition + &quot;px&quot;)</span><br><span class=\"line\">                  .style(&quot;top&quot;, yPosition + &quot;px&quot;)</span><br><span class=\"line\">                  .style(&quot;border-radius&quot;, &quot;10px&quot;)</span><br><span class=\"line\">                  .style(&quot;border&quot;, &quot; 1px solid #999&quot;)</span><br><span class=\"line\">                  .style(&quot;padding&quot;, &quot;5px 10px&quot;)</span><br><span class=\"line\">                  .style(&quot;display&quot;, &quot;block&quot;);</span><br><span class=\"line\">          &#125;)</span><br><span class=\"line\">          //--鼠标移出事件</span><br><span class=\"line\">          .on(&quot;mouseout&quot;, (d) =&gt; &#123;</span><br><span class=\"line\">            this.tooltip.style(&quot;display&quot;, &quot;none&quot;);</span><br><span class=\"line\">          &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">//计划值名称</span><br><span class=\"line\">      nodeEnter.append(&quot;text&quot;)</span><br><span class=\"line\">          .attr(&quot;x&quot;, (d) =&gt; &#123;</span><br><span class=\"line\">            return d.children || d._children ? 10 : 10;</span><br><span class=\"line\">          &#125;)</span><br><span class=\"line\">          .attr(&quot;dy&quot;, 15)</span><br><span class=\"line\">          .attr(&quot;text-anchor&quot;, &quot;middle&quot;)</span><br><span class=\"line\">          .text((d) =&gt; &#123;</span><br><span class=\"line\">            return &quot;计划值&quot;</span><br><span class=\"line\">          &#125;)</span><br><span class=\"line\">          .style(&quot;fill&quot;, &quot;gray&quot;)</span><br><span class=\"line\">          .style(&quot;fill-opacity&quot;, 1)</span><br><span class=\"line\">          .style(&quot;font-size&quot;, &quot;10px&quot;);</span><br><span class=\"line\"></span><br><span class=\"line\">      //计划值</span><br><span class=\"line\">      nodeEnter.append(&quot;text&quot;)</span><br><span class=\"line\">          .attr(&quot;x&quot;, (d) =&gt; &#123;</span><br><span class=\"line\">            return d.children || d._children ? 10 : 10;</span><br><span class=\"line\">          &#125;)</span><br><span class=\"line\">          .attr(&quot;dy&quot;, 30)</span><br><span class=\"line\">          .attr(&quot;text-anchor&quot;, &quot;middle&quot;)</span><br><span class=\"line\">          .text((d) =&gt; &#123;</span><br><span class=\"line\">            return d.value;</span><br><span class=\"line\">          &#125;)</span><br><span class=\"line\">          .style(&quot;fill&quot;, &quot;blue&quot;)</span><br><span class=\"line\">          .style(&quot;font-size&quot;, &quot;12px&quot;);</span><br><span class=\"line\">      //展开趋势图</span><br><span class=\"line\">      nodeEnter.append(&quot;text&quot;)</span><br><span class=\"line\">          .attr(&quot;x&quot;, (d) =&gt; &#123;</span><br><span class=\"line\">            return d.children || d._children ? 50 : 50;</span><br><span class=\"line\">          &#125;)</span><br><span class=\"line\">          .attr(&quot;dy&quot;, 15)</span><br><span class=\"line\">          .attr(&quot;text-anchor&quot;, &quot;middle&quot;)</span><br><span class=\"line\">          .text((d) =&gt; &#123;</span><br><span class=\"line\">            return &quot;...&quot;</span><br><span class=\"line\">          &#125;)</span><br><span class=\"line\">          .style(&quot;fill&quot;, &quot;gray&quot;)</span><br><span class=\"line\">          .style(&quot;fill-opacity&quot;, 1)</span><br><span class=\"line\">          .style(&quot;font-size&quot;, &quot;28px&quot;)</span><br><span class=\"line\">          .on(&quot;click&quot;, (d, i) =&gt; &#123;</span><br><span class=\"line\">            console.log(&quot;触发点击事件&quot;)</span><br><span class=\"line\">            // this.getChartsData()</span><br><span class=\"line\">            // this.dialogVisible.three = true</span><br><span class=\"line\">          &#125;);</span><br><span class=\"line\">      // Transition nodes to their new position.将节点过渡到一个新的位置-----主要是针对节点过渡过程中的过渡效果</span><br><span class=\"line\">      //node就是保留的数据集，为原来数据的图形添加过渡动画。首先是整个组的位置</span><br><span class=\"line\">      //子节点全出来了</span><br><span class=\"line\">      var nodeUpdate = node.transition() //开始一个动画过度</span><br><span class=\"line\">          .duration(this.duration) //过渡延迟时间 此处主要设置的是圆圈节点随斜线的过渡延迟</span><br><span class=\"line\">          .attr(&quot;transform&quot;, (d) =&gt; &#123;</span><br><span class=\"line\">            return &quot;translate(&quot; + d.y + &quot;,&quot; + d.x + &quot;)&quot;;</span><br><span class=\"line\">          &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">      nodeUpdate.select(&quot;rect&quot;)</span><br><span class=\"line\">          .attr(&quot;x&quot;, -65)</span><br><span class=\"line\">          .attr(&quot;y&quot;, -35)</span><br><span class=\"line\">          .attr(&quot;width&quot;, width)</span><br><span class=\"line\">          .attr(&quot;height&quot;, height)</span><br><span class=\"line\">          .attr(&quot;rx&quot;, 10)</span><br><span class=\"line\">          .style(&quot;fill&quot;, &quot;#FFF&quot;)</span><br><span class=\"line\">          .style(&quot;stroke&quot;,function(d)&#123;</span><br><span class=\"line\">            if(d.value === 0)&#123;</span><br><span class=\"line\">              return &#x27;#6b6b6b&#x27;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            return &#x27;steelblue&#x27;</span><br><span class=\"line\">          &#125;)</span><br><span class=\"line\">          .style(&quot;stroke-width&quot;, &quot;1.5px&quot;);</span><br><span class=\"line\"></span><br><span class=\"line\">      nodeUpdate.select(&quot;text&quot;)</span><br><span class=\"line\">          .attr(&quot;text-anchor&quot;, &quot;middle&quot;)</span><br><span class=\"line\">          .style(&quot;fill-opacity&quot;, 1);</span><br><span class=\"line\"></span><br><span class=\"line\">      // Transition exiting nodes to the parent&#x27;s new position.过渡现有的节点到父母的新位置。</span><br><span class=\"line\">      //最后处理消失的数据，添加消失动画</span><br><span class=\"line\">      var nodeExit = node.exit().transition()</span><br><span class=\"line\">          .duration(this.duration)</span><br><span class=\"line\">          .attr(&quot;transform&quot;, (d) =&gt; &#123;</span><br><span class=\"line\">            return &quot;translate(&quot; + source.y + &quot;,&quot; + source.x + &quot;)&quot;;</span><br><span class=\"line\">          &#125;)</span><br><span class=\"line\">          .remove();</span><br><span class=\"line\"></span><br><span class=\"line\">      nodeExit.select(&quot;rect&quot;)</span><br><span class=\"line\">          .attr(&quot;x&quot;, -65)</span><br><span class=\"line\">          .attr(&quot;y&quot;, -35)</span><br><span class=\"line\">          .attr(&quot;width&quot;, width)</span><br><span class=\"line\">          .attr(&quot;height&quot;, height)</span><br><span class=\"line\">          .attr(&quot;rx&quot;, 10)</span><br><span class=\"line\">          .style(&quot;fill&quot;, &quot;#FFF&quot;);</span><br><span class=\"line\"></span><br><span class=\"line\">      nodeExit.select(&quot;text&quot;)</span><br><span class=\"line\">          .attr(&quot;text-anchor&quot;, &quot;middle&quot;)</span><br><span class=\"line\">          .style(&quot;fill-opacity&quot;, 1e-6);</span><br><span class=\"line\"></span><br><span class=\"line\">      // Update the links…线操作相关</span><br><span class=\"line\">      //再处理连线集合</span><br><span class=\"line\">      let link = this.svgGroup.selectAll(&quot;path.link&quot;)</span><br><span class=\"line\">          .style(&quot;fill&quot;, &quot;none&quot;)</span><br><span class=\"line\">          .style(&quot;stroke&quot;, &quot;steelblue&quot;)</span><br><span class=\"line\">          .style(&quot;stroke-width&quot;, &quot;1.5px&quot;)</span><br><span class=\"line\">          .data(links, (d) =&gt; &#123;</span><br><span class=\"line\">            return d.target.id;</span><br><span class=\"line\">          &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">      // Enter any new links at the parent&#x27;s previous position.</span><br><span class=\"line\">      //添加新的连线</span><br><span class=\"line\"></span><br><span class=\"line\">      link.enter().insert(&quot;path&quot;, &quot;g&quot;)</span><br><span class=\"line\">          .style(&quot;fill&quot;, &quot;none&quot;)</span><br><span class=\"line\">          .style(&quot;stroke&quot;, &quot;steelblue&quot;)</span><br><span class=\"line\">          .style(&quot;stroke-width&quot;, &quot;1.5px&quot;)</span><br><span class=\"line\">          .attr(&quot;class&quot;, &quot;link&quot;)</span><br><span class=\"line\">          .attr(&quot;d&quot;, (d) =&gt; &#123;</span><br><span class=\"line\">            var o = &#123;</span><br><span class=\"line\">              x: source.x0,</span><br><span class=\"line\">              y: source.y0</span><br><span class=\"line\">            &#125;;</span><br><span class=\"line\">            return this.diagonal(&#123;</span><br><span class=\"line\">              source: o,</span><br><span class=\"line\">              target: o</span><br><span class=\"line\">            &#125;); //diagonal - 生成一个二维贝塞尔连接器, 用于节点连接图.</span><br><span class=\"line\">          &#125;)</span><br><span class=\"line\">          .attr(&#x27;marker-end&#x27;, &#x27;url(#arrow)&#x27;);</span><br><span class=\"line\"></span><br><span class=\"line\">      // Transition links to their new position.将斜线过渡到新的位置</span><br><span class=\"line\">      //保留的连线添加过渡动画</span><br><span class=\"line\">      link.transition()</span><br><span class=\"line\">          .duration(this.duration)</span><br><span class=\"line\">          .attr(&quot;d&quot;, this.diagonal);</span><br><span class=\"line\"></span><br><span class=\"line\">      // Transition exiting nodes to the parent&#x27;s new position.过渡现有的斜线到父母的新位置。</span><br><span class=\"line\">      //消失的连线添加过渡动画</span><br><span class=\"line\">      link.exit().transition()</span><br><span class=\"line\">          .duration(this.duration)</span><br><span class=\"line\">          .attr(&quot;d&quot;, (d) =&gt; &#123;</span><br><span class=\"line\">            var o = &#123;</span><br><span class=\"line\">              x: source.x,</span><br><span class=\"line\">              y: source.y</span><br><span class=\"line\">            &#125;;</span><br><span class=\"line\">            return this.diagonal(&#123;</span><br><span class=\"line\">              source: o,</span><br><span class=\"line\">              target: o</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">          &#125;)</span><br><span class=\"line\">          .remove();</span><br><span class=\"line\">      // Stash the old positions for transition.将旧的斜线过渡效果隐藏</span><br><span class=\"line\">      this.nodes.forEach((d) =&gt; &#123;</span><br><span class=\"line\">        d.x0 = d.x;</span><br><span class=\"line\">        d.y0 = d.y;</span><br><span class=\"line\">      &#125;);</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\"></span><br><span class=\"line\">    //收缩节点</span><br><span class=\"line\">    collapse(d)&#123;</span><br><span class=\"line\">      if (d.children)&#123;</span><br><span class=\"line\">        d._children=d.children;</span><br><span class=\"line\">        d.children=null</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\"></span><br><span class=\"line\">    //当点击/删除时，中心节点，这样节点在折叠/移动时不会丢失大量的子节点。</span><br><span class=\"line\">    centerNode(source)&#123;</span><br><span class=\"line\">      //scale()方法用于返回当前的缩放比例值  缩放比例值</span><br><span class=\"line\">      let scale = this.zoomListener.scale();</span><br><span class=\"line\">      let x = -source.y0;</span><br><span class=\"line\">      let y = -source.x0;</span><br><span class=\"line\">      x = x* scale +100;</span><br><span class=\"line\">      y = y* scale +this.viewerHeight /2;</span><br><span class=\"line\">      d3.select(&#x27;g&#x27;).transition()</span><br><span class=\"line\">          .duration(this.duration)</span><br><span class=\"line\">          .attr(&quot;transform&quot;, &quot;translate(&quot; + x + &quot;,&quot; + y + &quot;)scale(&quot; + scale + &quot;)&quot;);</span><br><span class=\"line\">      this.zoomListener.scale(scale);</span><br><span class=\"line\">      this.zoomListener.translate([x, y]);</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    //点击事件</span><br><span class=\"line\">    click(d)&#123;</span><br><span class=\"line\">      if (d.children)&#123;</span><br><span class=\"line\">        d._children=d.children;</span><br><span class=\"line\">        d.children = null</span><br><span class=\"line\">      &#125;else&#123;</span><br><span class=\"line\">        d.children = d._children</span><br><span class=\"line\">        if (d.children === [] || d.children == null)&#123;</span><br><span class=\"line\">          return;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        d.children.forEach(this.collapse)</span><br><span class=\"line\">        d._children = null;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">      let depths = this.treeDepths(this.treeData);</span><br><span class=\"line\">      this.viewerHeight = depths.length * 100;</span><br><span class=\"line\">      if (this.viewerHeight &lt; this.minHeight)</span><br><span class=\"line\">        this.viewerHeight = this.minHeight;</span><br><span class=\"line\">      this.tree = d3.layout.tree()</span><br><span class=\"line\">          .size([this.viewerHeight, this.viewerWidth]);</span><br><span class=\"line\">      this.update(d)</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\">&lt;/script&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;style&gt;</span><br><span class=\"line\">circle &#123;</span><br><span class=\"line\">  fill: #ccc;</span><br><span class=\"line\">  stroke: #000;</span><br><span class=\"line\">  stroke-width: 1px;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">text &#123;</span><br><span class=\"line\">  font-size: 12px;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">path.link &#123;</span><br><span class=\"line\">  fill: none;</span><br><span class=\"line\">  stroke: #ccc;</span><br><span class=\"line\">  stroke-width: 1.5px;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">&lt;/style&gt;</span><br></pre></td></tr></table></figure></p>\n",
            "tags": [
                "前端",
                "D3.js"
            ]
        },
        {
            "id": "http://example.com/2024/10/16/post/utils/utils/",
            "url": "http://example.com/2024/10/16/post/utils/utils/",
            "title": "实用小工具",
            "date_published": "2024-10-16T11:37:02.278Z",
            "content_html": "<h1 id=\"实用小工具\"><a class=\"anchor\" href=\"#实用小工具\">#</a> 实用小工具</h1>\n<h2 id=\"windows系统\"><a class=\"anchor\" href=\"#windows系统\">#</a> Windows 系统</h2>\n<h4 id=\"1-geek软件卸载工具\"><a class=\"anchor\" href=\"#1-geek软件卸载工具\">#</a> 1、Geek：软件卸载工具</h4>\n<p><strong>简介</strong>：GeekUninstaller 正式版是一款相当不错的单文件绿色卸载软件，它体积轻巧，反映迅速，并且完全免费，支持多国语言，完美支持支持 32 位与 64 位系统，并且它只有一个 exe 文件 (软件大小不到 2M)，你不需要安装即可直接卸载软件、强制彻底清除软件残留垃圾文件或是查看某软件的注册表项目等等，让你的系统瞬间变得高速流畅。</p>\n<p>果核剥壳链接：<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuZ2h4aS5jb20vZ2Vlay5odG1s\">https://www.ghxi.com/geek.html</span></p>\n<p>网盘分享链接：</p>\n<h4 id=\"2-everything数据检索工具\"><a class=\"anchor\" href=\"#2-everything数据检索工具\">#</a> 2、Everything：数据检索工具</h4>\n<p><strong>简介</strong>：Everything 是速度最快的文件搜索软件，可以瞬间搜索到你需要的文件。如果你用过 Windows 自 Everything 是速度最快的文件搜索软件，可以瞬间搜索到你需要的文件。如果你用过 Windows 自带的搜索工具、Total Commander 的搜索、Google 桌面搜索或百度硬盘搜索，都因为速度或其他原因而不满意；或者用了 Locate32 也不满意（或满意），推荐这款体积小巧、免安装、免费、速度极快（比 Locate32 更快）的文件搜索工具 Everything！</p>\n<p>果核剥壳链接：<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuZ2h4aS5jb20vZXZlcnl0aGluZy5odG1s\">https://www.ghxi.com/everything.html</span></p>\n<h4 id=\"3-formatfactory格式工厂格式转换工具\"><a class=\"anchor\" href=\"#3-formatfactory格式工厂格式转换工具\">#</a> 3、FormatFactory 格式工厂：格式转换工具</h4>\n<p><strong>简介</strong>：格式工厂是套万能的多媒体格式转换器，提供以下功能：所有类型视频转到 MP4/3GP/MPG/AVI/WMV/FLV/SWF。所有类型音频转到 MP3/WMA/MMF/AMR/OGG/M4A/WAV。你可以在格式工厂中文版界面的左侧列表中看到软件提供的主要功能，如视频转换、音频转换、图片转换、DVD/CD/ISO 转换，以及视频合并、音频合并、混流等高级功能。格式工厂强大的格式转换功能和友好的操作性，无疑使格式工厂成为同类软件中的佼者。</p>\n<p>果核剥壳链接：<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuZ2h4aS5jb20vZm9ybWF0ZmFjdG9yeS0yLmh0bWw=\">https://www.ghxi.com/formatfactory-2.html</span></p>\n<h4 id=\"4-timesync系统时间校准工具\"><a class=\"anchor\" href=\"#4-timesync系统时间校准工具\">#</a> 4、Timesync：系统时间校准工具</h4>\n<p><strong>简介</strong>：<strong>TimeSync</strong> 是一款由德国知名自由软件开发工程师 <strong>Horst Schaeffer</strong> 精心设计与荣誉出品的可用于获取来自 <strong>NIST</strong> 标准互联网时间服务的当前时间并在必要时校准与同步用户计算机时钟时间的实用管理工具。尽管当前系统的确切时间可以由较新版本的微软 Windows 平台的官方服务器或者您的路由器提供，然而在特定需要时您可能希望拥有这样一款额外的时间校准同步助手随叫随到。</p>\n<p>下载地址：</p>\n<p>【网站】<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cubGFuem91eC5jb20vYjA1YW8xYTRm\">蓝奏云</span>      <span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuOTBwYW4uY29tL28xNDM4NzA=\">90 网盘</span>       <span class=\"exturl\" data-url=\"aHR0cHM6Ly9jbG91ZC5kZWdvby5jb20vc2hhcmUvcmJDZ0VsUUlPU2FKTVk=\">Degoo 网盘</span></p>\n<h4 id=\"5-contextmenumanagernet35-右键管理工具\"><a class=\"anchor\" href=\"#5-contextmenumanagernet35-右键管理工具\">#</a> 5、ContextMenuManager.NET.3.5 ： 右键管理工具</h4>\n<p><strong>简介</strong>：ContextMenuManager 是一款 C# 开发的 Windows10 右键菜单管理软件，软件小巧，功能强大，使用起来非常方便。遗憾的是软件只支持 Windows10。</p>\n<p>果核剥壳链接：<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuZ2h4aS5jb20vY29udGV4dG1lbnVtYW5hZ2VyLmh0bWw=\">https://www.ghxi.com/contextmenumanager.html</span></p>\n<h4 id=\"6-iobit-unlocker文件文件夹解锁工具\"><a class=\"anchor\" href=\"#6-iobit-unlocker文件文件夹解锁工具\">#</a> 6、IObit Unlocker：文件 / 文件夹解锁工具</h4>\n<p><strong>简介</strong>：Obit Unlocker 是一款小巧、易用和免费的文件 / 文件夹解锁工具，您可通过拖放或点击添加按钮对目标文件 / 文件夹进行删除、重命名、移动和复制等操作，解决无法删除或访问被拒绝等问题。</p>\n<p>使用 IObit Unlocker，您不会再收到 “无法删除文件”、“访问被拒绝”、“文件未删除”、“该文件正被另一个程序或用户使用” 或 “共享冲突” 等提示消息。它是一个强大的工具，通过终止所有阻止您删除或访问文件 / 文件夹的相关进程解决这些问题。</p>\n<p>通过 “解锁 &amp; 删除”、“解锁 &amp; 重命名”、“解锁 &amp; 移动” 和 “解锁 &amp; 复制” 功能，为您提供了一种安全的方法修改您计算机上的文件和文件夹，以确保您的数据安全和磁盘的稳定性。</p>\n<p>果核剥壳链接：<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuZ2h4aS5jb20vaW9iaXR1bmxvY2tlci5odG1s\">https://www.ghxi.com/iobitunlocker.html</span></p>\n<h4 id=\"7-spacesniffer磁盘分析工具\"><a class=\"anchor\" href=\"#7-spacesniffer磁盘分析工具\">#</a> 7、SpaceSniffer：磁盘分析工具</h4>\n<p><strong>简介</strong>：有时候我们在整理磁盘时，想知道磁盘中哪些文件或文件夹占用了多少空间，要是一个个文件夹点进去看，那岂不是非常浪费时间，对整体也没有一个很直观的印象。<br />\nSpaceSniffer 可让您了解文件夹和文件在磁盘上的结构。通过使用可视化布局，您可以立即看到某个文件在磁盘中到底有 “多大”！看看是哪个文件夹或文件占用了大量空间，以便迅速一键删除。</p>\n<p>果核剥壳链接：<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuZ2h4aS5jb20vc3BhY2VzbmlmZmVyLmh0bWw=\">https://www.ghxi.com/spacesniffer.html</span></p>\n<h2 id=\"开发工具\"><a class=\"anchor\" href=\"#开发工具\">#</a> 开发工具</h2>\n<h4 id=\"1-idea-jrebel热部署插件\"><a class=\"anchor\" href=\"#1-idea-jrebel热部署插件\">#</a> 1、idea-&gt;JRebel 热部署插件</h4>\n<h4 id=\"2-datagrip-数据库jetbrains系列工具\"><a class=\"anchor\" href=\"#2-datagrip-数据库jetbrains系列工具\">#</a> 2、DataGrip 数据库 jetbrains 系列工具</h4>\n",
            "tags": [
                "实用小工具",
                "tools"
            ]
        },
        {
            "id": "http://example.com/2024/10/16/post/utils/JRebel%20%E4%BD%BF%E7%94%A8debug%E7%BC%96%E8%AF%91%E5%8D%A1%E4%BD%8F%E9%97%AE%E9%A2%98/",
            "url": "http://example.com/2024/10/16/post/utils/JRebel%20%E4%BD%BF%E7%94%A8debug%E7%BC%96%E8%AF%91%E5%8D%A1%E4%BD%8F%E9%97%AE%E9%A2%98/",
            "title": "实用小工具",
            "date_published": "2024-10-16T11:37:02.277Z",
            "content_html": "<h4 id=\"jrebel-使用debug编译卡住问题\"><a class=\"anchor\" href=\"#jrebel-使用debug编译卡住问题\">#</a> JRebel 使用 debug 编译卡住问题</h4>\n<p><img data-src=\"https://dlink.host/wx4.sinaimg.cn/large/006V2BDqly8hsob5h5rwuj30rr0jhdiq.jpg\" alt=\"\" /></p>\n",
            "tags": [
                "实用小工具",
                "tools"
            ]
        },
        {
            "id": "http://example.com/2024/10/16/post/sql/redis/04-Redis%E9%97%AE%E9%A2%98%E5%B0%8F%E8%AE%B0/",
            "url": "http://example.com/2024/10/16/post/sql/redis/04-Redis%E9%97%AE%E9%A2%98%E5%B0%8F%E8%AE%B0/",
            "title": "Redis问题小记",
            "date_published": "2024-10-16T11:37:02.261Z",
            "content_html": "<h1 id=\"redis问题小记\"><a class=\"anchor\" href=\"#redis问题小记\">#</a> Redis 问题小记</h1>\n<h2 id=\"1-redis为什么这么快\"><a class=\"anchor\" href=\"#1-redis为什么这么快\">#</a> 1、Redis 为什么这么快？</h2>\n<p>Redis 内部做了非常多的性能优化，比较重要的有下面 3 点：</p>\n<p>1.Redis 基于内存，内存的访问速度比磁盘快很多；</p>\n<p>2.Redis 基于 Reactor 模式设计开发了一套高效的事件处理模型，主要是单线程事件循环和 IO 多路复用；</p>\n<p>3.Redis 内置了多种优化过后的数据类型 / 结构实现，性能非常高</p>\n<p>4.Redis 通信协议实现简单且解析高效。</p>\n<p><img data-src=\"D:%5CPictures%5Ctypore%5C006V2BDqly8htd3bxd9m4j31b00u0ae5.jpg\" alt=\"\" /></p>\n<p>那既然都这么快了，为什么不直接用 Redis 当主数据库呢？主要是因为内存成本太高了且 Redis 提供的数据持久化仍然有数据丢失的风险。</p>\n<h2 id=\"redis应用\"><a class=\"anchor\" href=\"#redis应用\">#</a> Redis 应用</h2>\n<p>redis 出了做缓存，还能做什么？</p>\n<ul>\n<li><strong>分布式锁</strong>：通过 Redis 来做分布式锁是一种比较常见的方式。通常情况下，我们都是基于 Redisson 来实现分布式锁。</li>\n<li><strong>限流</strong>：一般是通过 Redis + Lua 脚本的方式来实现限流。如果不想自己写 Lua 脚本的话，也可以直接利用 Redisson 中的  <code>RRateLimiter</code>  来实现分布式限流，其底层实现就是基于 Lua 代码 + 令牌桶算法。</li>\n<li><strong>消息队列</strong>：Redis 自带的 List 数据结构可以作为一个简单的队列使用。Redis 5.0 中增加的 Stream 类型的数据结构更加适合用来做消息队列。它比较类似于 Kafka，有主题和消费组的概念，支持消息持久化以及 ACK 机制。</li>\n<li><strong>延时队列</strong>：Redisson 内置了延时队列（基于 Sorted Set 实现的）。</li>\n<li><strong>分布式 Session</strong> ：利用 String 或者 Hash 数据类型保存 Session 数据，所有的服务器都可以访问。</li>\n<li><strong>复杂业务场景</strong>：通过 Redis 以及 Redis 扩展（比如 Redisson）提供的数据结构，我们可以很方便地完成很多复杂的业务场景比如通过 Bitmap 统计活跃用户、通过 Sorted Set 维护排行榜。</li>\n<li>……</li>\n</ul>\n<h2 id=\"redis-事务\"><a class=\"anchor\" href=\"#redis-事务\">#</a> Redis 事务</h2>\n<h3 id=\"什么是-redis-事务\"><a class=\"anchor\" href=\"#什么是-redis-事务\">#</a> 什么是 Redis 事务？</h3>\n<p>你可以将 Redis 中的事务理解为：Redis 事务提供了一种将多个命令请求打包的功能。然后，再按顺序执行打包的所有命令，并且不会被中途打断。</p>\n<p>Redis 事务实际开发中使用的非常少，功能比较鸡肋，不要将其和我们平时理解的关系型数据库的事务混淆了。</p>\n<p>除了不满足原子性和持久性之外，事务中的每条命令都会与 Redis 服务器进行网络交互，这是比较浪费资源的行为。明明一次批量执行多个命令就可以了，这种操作实在是看不懂。</p>\n<p>因此，Redis 事务是不建议在日常开发中使用的。</p>\n<h3 id=\"如何使用-redis-事务\"><a class=\"anchor\" href=\"#如何使用-redis-事务\">#</a> 如何使用 Redis 事务？</h3>\n<p>Redis 可以通过 MULTI，EXEC，DISCARD 和 WATCH 等命令来实现事务 (Transaction) 功能。</p>\n<blockquote>\n<p>MULTI<br />\nOK<br />\nSET PROJECT &quot;JavaGuide&quot;<br />\nQUEUED<br />\nGET PROJECT<br />\nQUEUED<br />\nEXEC</p>\n</blockquote>\n<ol>\n<li>OK</li>\n<li>&quot;JavaGuide&quot;<br />\nMULTIopen in new window 命令后可以输入多个命令，Redis 不会立即执行这些命令，而是将它们放到队列，当调用了 EXECopen in new window 命令后，再执行所有的命令。</li>\n</ol>\n<p>这个过程是这样的：</p>\n<p>开始事务（MULTI）；<br />\n命令入队 (批量操作 Redis 的命令，先进先出（FIFO）的顺序执行)；<br />\n执行事务 (EXEC)。<br />\n你也可以通过 DISCARDopen in new window 命令取消一个事务，它会清空事务队列中保存的所有命令。</p>\n<blockquote>\n<p>MULTI<br />\nOK<br />\nSET PROJECT &quot;JavaGuide&quot;<br />\nQUEUED<br />\nGET PROJECT<br />\nQUEUED<br />\nDISCARD<br />\nOK<br />\n 你可以通过 WATCHopen in new window 命令监听指定的 Key，当调用 EXEC 命令执行事务时，如果一个被 WATCH 命令监视的 Key 被 其他客户端 / Session 修改的话，整个事务都不会被执行。</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 客户端 1</span><br><span class=\"line\">SET PROJECT &quot;RustGuide&quot;</span><br><span class=\"line\">OK</span><br><span class=\"line\">WATCH PROJECT</span><br><span class=\"line\">OK</span><br><span class=\"line\">MULTI</span><br><span class=\"line\">OK</span><br><span class=\"line\">SET PROJECT &quot;JavaGuide&quot;</span><br><span class=\"line\">QUEUED</span><br><span class=\"line\"></span><br><span class=\"line\"># 客户端 2</span><br><span class=\"line\"># 在客户端 1 执行 EXEC 命令提交事务之前修改 PROJECT 的值</span><br><span class=\"line\">SET PROJECT &quot;GoGuide&quot;</span><br><span class=\"line\"></span><br><span class=\"line\"># 客户端 1</span><br><span class=\"line\"># 修改失败，因为 PROJECT 的值被客户端2修改了</span><br><span class=\"line\">EXEC</span><br><span class=\"line\">(nil)</span><br><span class=\"line\">GET PROJECT</span><br><span class=\"line\">&quot;GoGuide&quot;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure></p>\n<p>不过，如果 WATCH 与 事务 在同一个 Session 里，并且被 WATCH 监视的 Key 被修改的操作发生在事务内部，这个事务是可以被执行成功的（相关 issue：WATCH 命令碰到 MULTI 命令时的不同效果 open in new window）。</p>\n</blockquote>\n<p>事务内部修改 WATCH 监视的 Key：</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt; SET PROJECT &quot;JavaGuide&quot;</span><br><span class=\"line\">&gt; OK</span><br><span class=\"line\">&gt; WATCH PROJECT</span><br><span class=\"line\">&gt; OK</span><br><span class=\"line\">&gt; MULTI</span><br><span class=\"line\">&gt; OK</span><br><span class=\"line\">&gt; SET PROJECT &quot;JavaGuide1&quot;</span><br><span class=\"line\">&gt; QUEUED</span><br><span class=\"line\">&gt; SET PROJECT &quot;JavaGuide2&quot;</span><br><span class=\"line\">&gt; QUEUED</span><br><span class=\"line\">&gt; SET PROJECT &quot;JavaGuide3&quot;</span><br><span class=\"line\">&gt; QUEUED</span><br><span class=\"line\">&gt; EXEC</span><br><span class=\"line\"></span><br><span class=\"line\">1) OK</span><br><span class=\"line\">2) OK</span><br><span class=\"line\">3) OK</span><br><span class=\"line\">   127.0.0.1:6379&gt; GET PROJECT</span><br><span class=\"line\">   &quot;JavaGuide3&quot;</span><br></pre></td></tr></table></figure></p>\n<p>事务外部修改 WATCH 监视的 Key：</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">SET PROJECT &quot;JavaGuide&quot;</span><br><span class=\"line\">OK</span><br><span class=\"line\">WATCH PROJECT</span><br><span class=\"line\">OK</span><br><span class=\"line\">SET PROJECT &quot;JavaGuide2&quot;</span><br><span class=\"line\">OK</span><br><span class=\"line\">MULTI</span><br><span class=\"line\">OK</span><br><span class=\"line\">GET USER</span><br><span class=\"line\">QUEUED</span><br><span class=\"line\">EXEC</span><br><span class=\"line\">(nil)</span><br></pre></td></tr></table></figure></p>\n",
            "tags": [
                "数据库",
                "redis"
            ]
        },
        {
            "id": "http://example.com/2024/10/16/post/sql/redis/03-Redis%E5%91%BD%E4%BB%A4/",
            "url": "http://example.com/2024/10/16/post/sql/redis/03-Redis%E5%91%BD%E4%BB%A4/",
            "title": "Redis命令",
            "date_published": "2024-10-16T11:37:02.260Z",
            "content_html": "<h1 id=\"redis命令\"><a class=\"anchor\" href=\"#redis命令\">#</a> Redis 命令</h1>\n<h2 id=\"redis数据备份与恢复\"><a class=\"anchor\" href=\"#redis数据备份与恢复\">#</a> Redis 数据备份与恢复</h2>\n<p>Redis SAVE 命令用于创建当前数据库的备份</p>\n<h3 id=\"语法\"><a class=\"anchor\" href=\"#语法\">#</a> 语法</h3>\n<p>redis save 命令基本语法如下：</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">redis 127.0.0.1:6379&gt; SAVE </span><br></pre></td></tr></table></figure></p>\n<p>该命令将在 redis 安装目录下中创建 dump.rdb 文件</p>\n<h3 id=\"恢复数据\"><a class=\"anchor\" href=\"#恢复数据\">#</a> 恢复数据</h3>\n<p>如果需要恢复数据，只需将备份文件 (dump.rdb) 移动到 redis 安装目录并启动服务即可。获取 redis 目录可以使用 <strong>CONFIG</strong> 命令，如下所示：</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">redis 127.0.0.1:6379&gt; CONFIG GET dir</span><br><span class=\"line\">1) &quot;dir&quot;</span><br><span class=\"line\">2) &quot;/usr/local/redis/bin&quot;</span><br></pre></td></tr></table></figure></p>\n<p>以上命令 <strong>CONFIG GET dir</strong> 输出的 redis 安装目录为 /usr/local/redis/bin。</p>\n<hr />\n<h3 id=\"bgsave\"><a class=\"anchor\" href=\"#bgsave\">#</a> Bgsave</h3>\n<p>创建 redis 备份文件也可以使用命令 <strong>BGSAVE</strong>，该命令在后台执行。</p>\n<h4 id=\"实例\"><a class=\"anchor\" href=\"#实例\">#</a> 实例</h4>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">127.0.0.1:6379&gt; BGSAVE</span><br><span class=\"line\"></span><br><span class=\"line\">Background saving started</span><br></pre></td></tr></table></figure></p>\n<h2 id=\"redis安全\"><a class=\"anchor\" href=\"#redis安全\">#</a> Redis 安全</h2>\n<p>我们可以通过 redis 的配置文件设置密码参数，这样客户端连接到 redis 服务就需要密码验证，这样可以让我们的 redis 服务更安全。</p>\n<h4 id=\"实例-2\"><a class=\"anchor\" href=\"#实例-2\">#</a> 实例</h4>\n<p>我们可以通过以下命令查看是否设置了密码验证：</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">127.0.0.1:6379&gt; CONFIG get requirepass</span><br><span class=\"line\">1) &quot;requirepass&quot;</span><br><span class=\"line\">2) &quot;&quot;</span><br></pre></td></tr></table></figure></p>\n<p>默认情况下 requirepass 参数是空的，这就意味着你无需通过密码验证就可以连接到 redis 服务。</p>\n<p>你可以通过以下命令来修改该参数：</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">127.0.0.1:6379&gt; CONFIG set requirepass &quot;runoob&quot;</span><br><span class=\"line\">OK</span><br><span class=\"line\">127.0.0.1:6379&gt; CONFIG get requirepass</span><br><span class=\"line\">1) &quot;requirepass&quot;</span><br><span class=\"line\">2) &quot;runoob&quot;</span><br></pre></td></tr></table></figure></p>\n<p>设置密码后，客户端连接 redis 服务就需要密码验证，否则无法执行命令。</p>\n<h4 id=\"语法-2\"><a class=\"anchor\" href=\"#语法-2\">#</a> 语法</h4>\n<p><strong>AUTH</strong> 命令基本语法格式如下：</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">127.0.0.1:6379&gt; AUTH password</span><br></pre></td></tr></table></figure></p>\n<h4 id=\"实例-3\"><a class=\"anchor\" href=\"#实例-3\">#</a> 实例</h4>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">127.0.0.1:6379&gt; AUTH &quot;runoob&quot;</span><br><span class=\"line\">OK</span><br><span class=\"line\">127.0.0.1:6379&gt; SET mykey &quot;Test value&quot;</span><br><span class=\"line\">OK</span><br><span class=\"line\">127.0.0.1:6379&gt; GET mykey</span><br><span class=\"line\">&quot;Test value&quot;</span><br></pre></td></tr></table></figure></p>\n<h2 id=\"redis性能测试\"><a class=\"anchor\" href=\"#redis性能测试\">#</a> Redis 性能测试</h2>\n<p>Redis 性能测试是通过同时执行多个命令实现的。</p>\n<h3 id=\"语法-3\"><a class=\"anchor\" href=\"#语法-3\">#</a> 语法</h3>\n<p>redis 性能测试的基本命令如下：</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">redis-benchmark [option] [option value]</span><br></pre></td></tr></table></figure></p>\n<p><strong>注意</strong>：该命令是在 redis 的目录下执行的，而不是 redis 客户端的内部指令。</p>\n<p>实例</p>\n<p>以下实例同时执行 10000 个请求来检测性能：</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ redis-benchmark -n 10000  -q</span><br><span class=\"line\"></span><br><span class=\"line\">PING_INLINE: 141043.72 requests per second</span><br><span class=\"line\">PING_BULK: 142857.14 requests per second</span><br><span class=\"line\">SET: 141442.72 requests per second</span><br><span class=\"line\">GET: 145348.83 requests per second</span><br><span class=\"line\">INCR: 137362.64 requests per second</span><br><span class=\"line\">LPUSH: 145348.83 requests per second</span><br><span class=\"line\">LPOP: 146198.83 requests per second</span><br><span class=\"line\">SADD: 146198.83 requests per second</span><br><span class=\"line\">SPOP: 149253.73 requests per second</span><br><span class=\"line\">LPUSH (needed to benchmark LRANGE): 148588.42 requests per second</span><br><span class=\"line\">LRANGE_100 (first 100 elements): 58411.21 requests per second</span><br><span class=\"line\">LRANGE_300 (first 300 elements): 21195.42 requests per second</span><br><span class=\"line\">LRANGE_500 (first 450 elements): 14539.11 requests per second</span><br><span class=\"line\">LRANGE_600 (first 600 elements): 10504.20 requests per second</span><br><span class=\"line\">MSET (10 keys): 93283.58 requests per second</span><br></pre></td></tr></table></figure></p>\n<p>redis 性能测试工具可选参数如下所示：</p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">序号</th>\n<th style=\"text-align:left\">选项</th>\n<th style=\"text-align:left\">描述</th>\n<th style=\"text-align:left\">默认值</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">1</td>\n<td style=\"text-align:left\"><strong>-h</strong></td>\n<td style=\"text-align:left\">指定服务器主机名</td>\n<td style=\"text-align:left\">127.0.0.1</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">2</td>\n<td style=\"text-align:left\"><strong>-p</strong></td>\n<td style=\"text-align:left\">指定服务器端口</td>\n<td style=\"text-align:left\">6379</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">3</td>\n<td style=\"text-align:left\"><strong>-s</strong></td>\n<td style=\"text-align:left\">指定服务器 socket</td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">4</td>\n<td style=\"text-align:left\"><strong>-c</strong></td>\n<td style=\"text-align:left\">指定并发连接数</td>\n<td style=\"text-align:left\">50</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">5</td>\n<td style=\"text-align:left\"><strong>-n</strong></td>\n<td style=\"text-align:left\">指定请求数</td>\n<td style=\"text-align:left\">10000</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">6</td>\n<td style=\"text-align:left\"><strong>-d</strong></td>\n<td style=\"text-align:left\">以字节的形式指定 SET/GET 值的数据大小</td>\n<td style=\"text-align:left\">2</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">7</td>\n<td style=\"text-align:left\"><strong>-k</strong></td>\n<td style=\"text-align:left\">1=keep alive 0=reconnect</td>\n<td style=\"text-align:left\">1</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">8</td>\n<td style=\"text-align:left\"><strong>-r</strong></td>\n<td style=\"text-align:left\">SET/GET/INCR 使用随机 key, SADD 使用随机值</td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">9</td>\n<td style=\"text-align:left\"><strong>-P</strong></td>\n<td style=\"text-align:left\">通过管道传输 &lt;numreq&gt; 请求</td>\n<td style=\"text-align:left\">1</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">10</td>\n<td style=\"text-align:left\"><strong>-q</strong></td>\n<td style=\"text-align:left\">强制退出 redis。仅显示 query/sec 值</td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">11</td>\n<td style=\"text-align:left\"><strong>--csv</strong></td>\n<td style=\"text-align:left\">以 CSV 格式输出</td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">12</td>\n<td style=\"text-align:left\">*<strong>-l*（L 的小写字母）</strong></td>\n<td style=\"text-align:left\">生成循环，永久执行测试</td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">13</td>\n<td style=\"text-align:left\"><strong>-t</strong></td>\n<td style=\"text-align:left\">仅运行以逗号分隔的测试命令列表。</td>\n<td style=\"text-align:left\"></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">14</td>\n<td style=\"text-align:left\">*<strong>-I*（i 的大写字母）</strong></td>\n<td style=\"text-align:left\">Idle 模式。仅打开 N 个 idle 连接并等待。</td>\n<td style=\"text-align:left\"></td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"实例-4\"><a class=\"anchor\" href=\"#实例-4\">#</a> 实例</h4>\n<p>以下实例我们使用了多个参数来测试 redis 性能：</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ redis-benchmark -h 127.0.0.1 -p 6379 -t set,lpush -n 10000 -q</span><br><span class=\"line\"></span><br><span class=\"line\">SET: 146198.83 requests per second</span><br><span class=\"line\">LPUSH: 145560.41 requests per second</span><br></pre></td></tr></table></figure></p>\n<p>以上实例中主机为 127.0.0.1，端口号为 6379，执行的命令为 set,lpush，请求数为 10000，通过 -q 参数让结果只显示每秒执行的请求数。</p>\n<h2 id=\"redis-客户端连接\"><a class=\"anchor\" href=\"#redis-客户端连接\">#</a> Redis 客户端连接</h2>\n<p>Redis 通过监听一个 TCP 端口或者 Unix socket 的方式来接收来自客户端的连接，当一个连接建立后，Redis 内部会进行以下一些操作：</p>\n<ul>\n<li>首先，客户端 socket 会被设置为非阻塞模式，因为 Redis 在网络事件处理上采用的是非阻塞多路复用模型。</li>\n<li>然后为这个 socket 设置 TCP_NODELAY 属性，禁用 Nagle 算法</li>\n<li>然后创建一个可读的文件事件用于监听这个客户端 socket 的数据发送</li>\n</ul>\n<hr />\n<h3 id=\"最大连接数\"><a class=\"anchor\" href=\"#最大连接数\">#</a> 最大连接数</h3>\n<p>在 Redis2.4 中，最大连接数是被直接硬编码在代码里面的，而在 2.6 版本中这个值变成可配置的。</p>\n<p>maxclients 的默认值是 10000，你也可以在 redis.conf 中对这个值进行修改。</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">config get maxclients</span><br><span class=\"line\"></span><br><span class=\"line\">1) &quot;maxclients&quot;</span><br><span class=\"line\">2) &quot;10000&quot;</span><br></pre></td></tr></table></figure></p>\n<h4 id=\"实例-5\"><a class=\"anchor\" href=\"#实例-5\">#</a> 实例</h4>\n<p>以下实例我们在服务启动时设置最大连接数为 100000：</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">redis-server --maxclients 100000</span><br></pre></td></tr></table></figure></p>\n<hr />\n<h3 id=\"客户端命令\"><a class=\"anchor\" href=\"#客户端命令\">#</a> 客户端命令</h3>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">S.N.</th>\n<th style=\"text-align:left\">命令</th>\n<th style=\"text-align:left\">描述</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">1</td>\n<td style=\"text-align:left\"><strong>CLIENT LIST</strong></td>\n<td style=\"text-align:left\">返回连接到 redis 服务的客户端列表</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">2</td>\n<td style=\"text-align:left\"><strong>CLIENT SETNAME</strong></td>\n<td style=\"text-align:left\">设置当前连接的名称</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">3</td>\n<td style=\"text-align:left\"><strong>CLIENT GETNAME</strong></td>\n<td style=\"text-align:left\">获取通过 CLIENT SETNAME 命令设置的服务名称</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">4</td>\n<td style=\"text-align:left\"><strong>CLIENT PAUSE</strong></td>\n<td style=\"text-align:left\">挂起客户端连接，指定挂起的时间以毫秒计</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">5</td>\n<td style=\"text-align:left\"><strong>CLIENT KILL</strong></td>\n<td style=\"text-align:left\">关闭客户端连接</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"redis-管道技术\"><a class=\"anchor\" href=\"#redis-管道技术\">#</a> Redis 管道技术</h2>\n<p>Redis 是一种基于客户端 - 服务端模型以及请求 / 响应协议的 TCP 服务。这意味着通常情况下一个请求会遵循以下步骤：</p>\n<ul>\n<li>客户端向服务端发送一个查询请求，并监听 Socket 返回，通常是以阻塞模式，等待服务端响应。</li>\n<li>服务端处理命令，并将结果返回给客户端。</li>\n</ul>\n<hr />\n<h3 id=\"redis-管道技术-2\"><a class=\"anchor\" href=\"#redis-管道技术-2\">#</a> Redis 管道技术</h3>\n<p>Redis 管道技术可以在服务端未响应时，客户端可以继续向服务端发送请求，并最终一次性读取所有服务端的响应。</p>\n<h4 id=\"实例-6\"><a class=\"anchor\" href=\"#实例-6\">#</a> 实例</h4>\n<p>查看 redis 管道，只需要启动 redis 实例并输入以下命令：</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$(echo -en &quot;PING\\r\\n SET runoobkey redis\\r\\nGET runoobkey\\r\\nINCR visitor\\r\\nINCR visitor\\r\\nINCR visitor\\r\\n&quot;; sleep 10) | nc localhost 6379</span><br><span class=\"line\"></span><br><span class=\"line\">+PONG</span><br><span class=\"line\">+OK</span><br><span class=\"line\">redis</span><br><span class=\"line\">:1</span><br><span class=\"line\">:2</span><br><span class=\"line\">:3</span><br></pre></td></tr></table></figure></p>\n<p>以上实例中我们通过使用 <strong>PING</strong> 命令查看 redis 服务是否可用， 之后我们设置了 runoobkey 的值为 redis，然后我们获取 runoobkey 的值并使得 visitor 自增 3 次。</p>\n<p>在返回的结果中我们可以看到这些命令一次性向 redis 服务提交，并最终一次性读取所有服务端的响应</p>\n<hr />\n<h3 id=\"管道技术的优势\"><a class=\"anchor\" href=\"#管道技术的优势\">#</a> 管道技术的优势</h3>\n<p>管道技术最显著的优势是提高了 redis 服务的性能。</p>\n<p><strong>一些测试数据</strong></p>\n<p>在下面的测试中，我们将使用 Redis 的 Ruby 客户端，支持管道技术特性，测试管道技术对速度的提升效果。</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">require &#x27;rubygems&#x27; </span><br><span class=\"line\">require &#x27;redis&#x27;</span><br><span class=\"line\">def bench(descr) </span><br><span class=\"line\">start = Time.now </span><br><span class=\"line\">yield </span><br><span class=\"line\">puts &quot;#&#123;descr&#125; #&#123;Time.now-start&#125; seconds&quot; </span><br><span class=\"line\">end</span><br><span class=\"line\">def without_pipelining </span><br><span class=\"line\">r = Redis.new </span><br><span class=\"line\">10000.times &#123; </span><br><span class=\"line\">    r.ping </span><br><span class=\"line\">&#125; </span><br><span class=\"line\">end</span><br><span class=\"line\">def with_pipelining </span><br><span class=\"line\">r = Redis.new </span><br><span class=\"line\">r.pipelined &#123; </span><br><span class=\"line\">    10000.times &#123; </span><br><span class=\"line\">        r.ping </span><br><span class=\"line\">    &#125; </span><br><span class=\"line\">&#125; </span><br><span class=\"line\">end</span><br><span class=\"line\">bench(&quot;without pipelining&quot;) &#123; </span><br><span class=\"line\">    without_pipelining </span><br><span class=\"line\">&#125; </span><br><span class=\"line\">bench(&quot;with pipelining&quot;) &#123; </span><br><span class=\"line\">    with_pipelining </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>从处于局域网中的 Mac OS X 系统上执行上面这个简单脚本的数据表明，开启了管道操作后，往返延时已经被改善得相当低了。</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">without pipelining 1.185238 seconds </span><br><span class=\"line\">with pipelining 0.250783 seconds</span><br></pre></td></tr></table></figure></p>\n<p>如你所见，开启管道后，我们的速度效率提升了 5 倍。</p>\n<h2 id=\"redis-分区\"><a class=\"anchor\" href=\"#redis-分区\">#</a> Redis 分区</h2>\n<p>分区是分割数据到多个 Redis 实例的处理过程，因此每个实例只保存 key 的一个子集。</p>\n<h3 id=\"分区的优势\"><a class=\"anchor\" href=\"#分区的优势\">#</a> 分区的优势</h3>\n<ul>\n<li>通过利用多台计算机内存的和值，允许我们构造更大的数据库。</li>\n<li>通过多核和多台计算机，允许我们扩展计算能力；通过多台计算机和网络适配器，允许我们扩展网络带宽。</li>\n</ul>\n<h3 id=\"分区的不足\"><a class=\"anchor\" href=\"#分区的不足\">#</a> 分区的不足</h3>\n<p>redis 的一些特性在分区方面表现的不是很好：</p>\n<ul>\n<li>涉及多个 key 的操作通常是不被支持的。举例来说，当两个 set 映射到不同的 redis 实例上时，你就不能对这两个 set 执行交集操作。</li>\n<li>涉及多个 key 的 redis 事务不能使用。</li>\n<li>当使用分区时，数据处理较为复杂，比如你需要处理多个 rdb/aof 文件，并且从多个实例和主机备份持久化文件。</li>\n<li>增加或删除容量也比较复杂。redis 集群大多数支持在运行时增加、删除节点的透明数据平衡的能力，但是类似于客户端分区、代理等其他系统则不支持这项特性。然而，一种叫做 presharding 的技术对此是有帮助的。</li>\n</ul>\n<hr />\n<h3 id=\"分区类型\"><a class=\"anchor\" href=\"#分区类型\">#</a> 分区类型</h3>\n<p>Redis 有两种类型分区。 假设有 4 个 Redis 实例 R0，R1，R2，R3，和类似 user:1，user:2 这样的表示用户的多个 key，对既定的 key 有多种不同方式来选择这个 key 存放在哪个实例中。也就是说，有不同的系统来映射某个 key 到某个 Redis 服务。</p>\n<h4 id=\"范围分区\"><a class=\"anchor\" href=\"#范围分区\">#</a> 范围分区</h4>\n<p>最简单的分区方式是按范围分区，就是映射一定范围的对象到特定的 Redis 实例。</p>\n<p>比如，ID 从 0 到 10000 的用户会保存到实例 R0，ID 从 10001 到 20000 的用户会保存到 R1，以此类推。</p>\n<p>这种方式是可行的，并且在实际中使用，不足就是要有一个区间范围到实例的映射表。这个表要被管理，同时还需要各 种对象的映射表，通常对 Redis 来说并非是好的方法。</p>\n<h4 id=\"哈希分区\"><a class=\"anchor\" href=\"#哈希分区\">#</a> 哈希分区</h4>\n<p>另外一种分区方法是 hash 分区。这对任何 key 都适用，也无需是 object_name: 这种形式，像下面描述的一样简单：</p>\n<ul>\n<li>用一个 hash 函数将 key 转换为一个数字，比如使用 crc32 hash 函数。对 key foobar 执行 crc32 (foobar) 会输出类似 93024922 的整数。</li>\n<li>对这个整数取模，将其转化为 0-3 之间的数字，就可以将这个整数映射到 4 个 Redis 实例中的一个了。93024922 % 4 = 2，就是说 key foobar 应该被存到 R2 实例中。注意：取模操作是取除的余数，通常在多种编程语言中用 % 操作符实现。</li>\n</ul>\n",
            "tags": [
                "数据库",
                "redis"
            ]
        },
        {
            "id": "http://example.com/2024/10/16/post/sql/redis/02-Java%E4%BD%BF%E7%94%A8Redis/",
            "url": "http://example.com/2024/10/16/post/sql/redis/02-Java%E4%BD%BF%E7%94%A8Redis/",
            "title": "Java使用Redis",
            "date_published": "2024-10-16T11:37:02.235Z",
            "content_html": "<h1 id=\"java使用redis\"><a class=\"anchor\" href=\"#java使用redis\">#</a> Java 使用 Redis</h1>\n<h4 id=\"安装\"><a class=\"anchor\" href=\"#安装\">#</a> 安装</h4>\n<p>开始在 Java 中使用 Redis 前， 我们需要确保已经安装了 redis 服务及 Java redis 驱动，且你的机器上能正常使用 Java。 Java 的安装配置可以参考我们的 <span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cucnVub29iLmNvbS9yZWRpcy9qYXZhLWVudmlyb25tZW50LXNldHVwLmh0bWw=\">Java 开发环境配置 </span>接下来让我们安装 Java redis 驱动：</p>\n<ul>\n<li>首先你需要下载驱动包 <a href=\"https://mvnrepository.com/artifact/redis.clients/jedis\"><strong>下载 jedis.jar</strong></a>，确保下载最新驱动包。</li>\n<li>在你的 classpath 中包含该驱动包。</li>\n</ul>\n<div class=\"note info\">\n<p><em>本站提供了 2.9.0 jar 版本下载：</em> <span class=\"exturl\" data-url=\"aHR0cHM6Ly9zdGF0aWMucnVub29iLmNvbS9kb3dubG9hZC9qZWRpcy0yLjkuMC5qYXI=\">jedis-2.9.0.jar</span></p>\n</div>\n<h2 id=\"连接到redis服务\"><a class=\"anchor\" href=\"#连接到redis服务\">#</a> 连接到 Redis 服务</h2>\n<p><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">RedisJava</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">//连接本地的 Redis 服务</span></span><br><span class=\"line\">        <span class=\"type\">Jedis</span> <span class=\"variable\">jedis</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Jedis</span>(<span class=\"string\">&quot;localhost&quot;</span>);</span><br><span class=\"line\">        <span class=\"comment\">// 如果 Redis 服务设置了密码，需要下面这行，没有就不需要</span></span><br><span class=\"line\">        <span class=\"comment\">// jedis.auth(&quot;123456&quot;); </span></span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;连接成功&quot;</span>);</span><br><span class=\"line\">        <span class=\"comment\">//查看服务是否运行</span></span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;服务正在运行: &quot;</span>+jedis.ping());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">连接成功</span><br><span class=\"line\">服务正在运行: PONG</span><br></pre></td></tr></table></figure></p>\n<h2 id=\"redis-java-string字符串-实例\"><a class=\"anchor\" href=\"#redis-java-string字符串-实例\">#</a> Redis Java String (字符串) 实例</h2>\n<p><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">RedisStringJava</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">//连接本地的 Redis 服务</span></span><br><span class=\"line\">        <span class=\"type\">Jedis</span> <span class=\"variable\">jedis</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Jedis</span>(<span class=\"string\">&quot;localhost&quot;</span>);</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;连接成功&quot;</span>);</span><br><span class=\"line\">        <span class=\"comment\">//设置 redis 字符串数据</span></span><br><span class=\"line\">        jedis.set(<span class=\"string\">&quot;runoobkey&quot;</span>, <span class=\"string\">&quot;www.runoob.com&quot;</span>);</span><br><span class=\"line\">        <span class=\"comment\">// 获取存储的数据并输出</span></span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;redis 存储的字符串为: &quot;</span>+ jedis.get(<span class=\"string\">&quot;runoobkey&quot;</span>));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">连接成功</span><br><span class=\"line\">redis 存储的字符串为: www.runoob.com</span><br></pre></td></tr></table></figure></p>\n<h2 id=\"redis-java-list列表-实例\"><a class=\"anchor\" href=\"#redis-java-list列表-实例\">#</a> Redis Java List (列表) 实例</h2>\n<p><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> java.util.List;</span><br><span class=\"line\"><span class=\"keyword\">import</span> redis.clients.jedis.Jedis;</span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">RedisListJava</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">//连接本地的 Redis 服务</span></span><br><span class=\"line\">        <span class=\"type\">Jedis</span> <span class=\"variable\">jedis</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Jedis</span>(<span class=\"string\">&quot;localhost&quot;</span>);</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;连接成功&quot;</span>);</span><br><span class=\"line\">        <span class=\"comment\">//存储数据到列表中</span></span><br><span class=\"line\">        jedis.lpush(<span class=\"string\">&quot;site-list&quot;</span>, <span class=\"string\">&quot;Runoob&quot;</span>);</span><br><span class=\"line\">        jedis.lpush(<span class=\"string\">&quot;site-list&quot;</span>, <span class=\"string\">&quot;Google&quot;</span>);</span><br><span class=\"line\">        jedis.lpush(<span class=\"string\">&quot;site-list&quot;</span>, <span class=\"string\">&quot;Taobao&quot;</span>);</span><br><span class=\"line\">        <span class=\"comment\">// 获取存储的数据并输出</span></span><br><span class=\"line\">        List&lt;String&gt; list = jedis.lrange(<span class=\"string\">&quot;site-list&quot;</span>, <span class=\"number\">0</span> ,<span class=\"number\">2</span>);</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">0</span>; i&lt;list.size(); i++) &#123;</span><br><span class=\"line\">            System.out.println(<span class=\"string\">&quot;列表项为: &quot;</span>+list.get(i));</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">连接成功</span><br><span class=\"line\">列表项为: Taobao</span><br><span class=\"line\">列表项为: Google</span><br><span class=\"line\">列表项为: Runoob</span><br></pre></td></tr></table></figure></p>\n<h2 id=\"redis-java-keys-实例\"><a class=\"anchor\" href=\"#redis-java-keys-实例\">#</a> Redis Java Keys 实例</h2>\n<p><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> java.util.Iterator;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Set;</span><br><span class=\"line\"><span class=\"keyword\">import</span> redis.clients.jedis.Jedis;</span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">RedisKeyJava</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">//连接本地的 Redis 服务</span></span><br><span class=\"line\">        <span class=\"type\">Jedis</span> <span class=\"variable\">jedis</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Jedis</span>(<span class=\"string\">&quot;localhost&quot;</span>);</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;连接成功&quot;</span>);</span><br><span class=\"line\"> </span><br><span class=\"line\">        <span class=\"comment\">// 获取数据并输出</span></span><br><span class=\"line\">        Set&lt;String&gt; keys = jedis.keys(<span class=\"string\">&quot;*&quot;</span>); </span><br><span class=\"line\">        Iterator&lt;String&gt; it=keys.iterator() ;   </span><br><span class=\"line\">        <span class=\"keyword\">while</span>(it.hasNext())&#123;   </span><br><span class=\"line\">            <span class=\"type\">String</span> <span class=\"variable\">key</span> <span class=\"operator\">=</span> it.next();   </span><br><span class=\"line\">            System.out.println(key);   </span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">连接成功</span><br><span class=\"line\">runoobkey</span><br><span class=\"line\">site-list</span><br></pre></td></tr></table></figure></p>\n",
            "tags": [
                "数据库",
                "redis"
            ]
        },
        {
            "id": "http://example.com/2024/10/16/post/sql/redis/01-Redis%E7%AE%80%E4%BB%8B/",
            "url": "http://example.com/2024/10/16/post/sql/redis/01-Redis%E7%AE%80%E4%BB%8B/",
            "title": "Redis简介",
            "date_published": "2024-10-16T11:37:02.233Z",
            "content_html": "<h1 id=\"redis简介\"><a class=\"anchor\" href=\"#redis简介\">#</a> Redis 简介</h1>\n<p>Redis 是一个开源的内存数据库，遵守<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cucnVub29iLmNvbS9ub3RlLzEzMTc2\"> BSD 协议</span>，它提供了一个高性能的键值（key-value）存储系统，常用于缓存、消息队列、会话存储等应用场景。</p>\n<ul>\n<li><strong>性能极高</strong>：Redis 以其极高的性能而著称，能够支持每秒数十万次的读写操作。这使得 Redis 成为处理高并发请求的理想选择，尤其是在需要快速响应的场景中，如缓存、会话管理、排行榜等。</li>\n<li><strong>丰富的数据类型</strong>：Redis 不仅支持基本的键值存储，还提供了丰富的数据类型，包括字符串，列表，集合，哈希表，有序集合等。</li>\n<li><strong>原子性操作</strong>：Redis 的所有操作都是原子性的，这意味着操作要么完全执行，要么完全不执行。这种特性对于确保数据的一致性和完整性至关重要，尤其是再高并发环境下处理事务时。</li>\n<li><strong>持久化</strong>：Redis 支持数据的持久化，可以将内存中的数据保存到磁盘中，以便在系统重启后恢复数据。这为 Redis 提供了数据安全性，确保数据不会因为系统故障而丢失。</li>\n<li>** 支持发布 / 订阅模式：**Redis 内置了发布 / 订阅模式（Pub/Sub），允许客户端之间通过消息传递进行通信。这使得 Redis 可以作为消息队列和实时数据传输的平台。</li>\n<li>** 单线程模型：** 尽管 Redis 是单线程的，但它通过高效的事件驱动模型来处理并发请求，确保了高性能和低延迟。单线程模型也简化了并发控制的复杂性</li>\n<li>** 主从复制：**Redis 支持主从复制，可以通过从节点来备份数据或分担读请求，提高数据的可用性和系统的伸缩性。</li>\n<li>** 应用场景广泛：**Redis 被广泛应用于各种场景，包括但不限于缓存系统、会话存储、排行榜、实时分析、地理空间数据索引等。</li>\n<li>** 社区支持：**Redis 拥有一个活跃的开发者社区，提供了大量的文档、教程和第三方库，这为开发者提供了强大的支持和丰富的资源。</li>\n<li>** 跨平台兼容性：**Redis 可以在多种操作系统上运行，包括 Linux、macOS 和 Windows，这使得它能够在不同的技术栈中灵活部署。</li>\n</ul>\n<h2 id=\"redis-与其他-key-value-存储有什么不同\"><a class=\"anchor\" href=\"#redis-与其他-key-value-存储有什么不同\">#</a> Redis 与其他 key-value 存储有什么不同？</h2>\n<p>Redis 与其他 key-value 存储系统的主要区别在于其提供了丰富的数据类型、高性能的读写能力、原子性操作、持久化机制、以及丰富的特性集。</p>\n<p>以下是 Redis 的一些独特之处：</p>\n<ul>\n<li>** 丰富的数据类型：**Redis 不仅仅支持简单的 key-value 类型的数据，还提供了 list、set、zset（有序集合）、hash 等数据结构的存储。这些数据类型可以更好地满足特定的业务需求，使得 Redis 可以用于更广泛的应用场景。</li>\n<li>** 高性能的读写能力：**Redis 能读的速度是 110000 次 /s，写的速度是 81000 次 /s。这种高性能主要得益于 Redis 将数据存储在内存中，从而显著提高了数据的访问速度。</li>\n<li>** 原子性操作：**Redis 的所有操作都是原子性的，这意味着操作要么完全执行，要么完全不执行。这种特性对于确保数据的一致性和完整性非常重要。</li>\n<li>** 持久化机制：**Redis 支持数据的持久化，可以将内存中的数据保存在磁盘中，以便在系统重启后能够再次加载使用。这为 Redis 提供了数据安全性，确保数据不会因为系统故障而丢失。</li>\n<li>** 丰富的特性集：**Redis 还支持 publish/subscribe（发布 / 订阅）模式、通知、key 过期等高级特性。这些特性使得 Redis 可以用于消息队列、实时数据分析等复杂的应用场景。</li>\n<li>** 主从复制和高可用性：**Redis 支持 master-slave 模式的数据备份，提供了数据的备份和主从复制功能，增强了数据的可用性和容错性。</li>\n<li>** 支持 Lua 脚本：**Redis 支持使用 Lua 脚本来编写复杂的操作，这些脚本可以在服务器端执行，提供了更多的灵活性和强大的功能。</li>\n<li>** 单线程模型：** 尽管 Redis 是单线程的，但它通过高效的事件驱动模型来处理并发请求，确保了高性能和低延迟。</li>\n</ul>\n",
            "tags": [
                "数据库",
                "redis"
            ]
        },
        {
            "id": "http://example.com/2024/10/16/post/sql/02-%E6%97%B6%E9%97%B4%E5%88%A4%E6%96%AD%E6%9F%A5%E8%AF%A2/",
            "url": "http://example.com/2024/10/16/post/sql/02-%E6%97%B6%E9%97%B4%E5%88%A4%E6%96%AD%E6%9F%A5%E8%AF%A2/",
            "title": "PostgreSQL中筛选月份和年份查询数据集",
            "date_published": "2024-10-16T11:37:02.223Z",
            "content_html": "<p><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">--        日期查询  PostgreSQL中筛选月份和年份查询数据集   三种方法</span></span><br><span class=\"line\"><span class=\"keyword\">select</span> <span class=\"operator\">*</span> <span class=\"keyword\">from</span> srm.cux_5_offline_purchase <span class=\"keyword\">where</span>  <span class=\"built_in\">extract</span>(<span class=\"keyword\">year</span> <span class=\"keyword\">from</span> op_createdate )<span class=\"operator\">=</span><span class=\"number\">2024</span> <span class=\"keyword\">and</span> <span class=\"built_in\">extract</span>(<span class=\"keyword\">month</span> <span class=\"keyword\">from</span> op_createdate)<span class=\"operator\">=</span><span class=\"number\">2</span>;</span><br><span class=\"line\"><span class=\"keyword\">select</span> <span class=\"operator\">*</span> <span class=\"keyword\">from</span> srm.cux_5_offline_purchase <span class=\"keyword\">where</span>  date_part(<span class=\"string\">&#x27;year&#x27;</span>, op_createdate) <span class=\"operator\">=</span> <span class=\"number\">2024</span> <span class=\"keyword\">AND</span> date_part(<span class=\"string\">&#x27;month&#x27;</span>, op_createdate) <span class=\"operator\">=</span> <span class=\"number\">3</span>;</span><br><span class=\"line\"><span class=\"comment\">-- SELECT * FROM srm.cux_5_offline_purchase WHERE op_createdate &gt;= &#x27;2024-2-01&#x27; AND op_createdate &lt;= &#x27;2024-2-28&#x27;;  不推荐</span></span><br></pre></td></tr></table></figure></p>\n",
            "tags": [
                "数据库",
                "time"
            ]
        },
        {
            "id": "http://example.com/2024/10/16/post/sql/01-sql/",
            "url": "http://example.com/2024/10/16/post/sql/01-sql/",
            "title": "数据库",
            "date_published": "2024-10-16T11:37:02.222Z",
            "content_html": "<h1 id=\"数据库小记\"><a class=\"anchor\" href=\"#数据库小记\">#</a> 数据库小记</h1>\n<h3 id=\"1-字符串排序转类型\"><a class=\"anchor\" href=\"#1-字符串排序转类型\">#</a> 1、字符串排序，转类型</h3>\n<p><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">在这个查询中，<span class=\"built_in\">CAST</span>(j.ops_jl_start <span class=\"keyword\">AS</span> <span class=\"type\">INTEGER</span>) 将 j.ops_jl_start 字符串转换为整数，然后按整数值进行排序，从而确保排序顺序为 <span class=\"number\">1</span>、<span class=\"number\">2</span>、<span class=\"number\">3</span>、<span class=\"number\">5</span>。</span><br><span class=\"line\"></span><br><span class=\"line\">如果你的数据库系统不支持 CAST 函数（例如在某些数据库系统中，可能需要使用 <span class=\"keyword\">CONVERT</span> 函数），你可以根据具体的数据库系统语法进行调整。例如，在 MySQL 中，可以使用：</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">sql</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">ORDER</span> <span class=\"keyword\">BY</span> <span class=\"built_in\">CAST</span>(j.ops_jl_start <span class=\"keyword\">AS</span> <span class=\"type\">INTEGER</span>);</span><br><span class=\"line\"><span class=\"keyword\">ORDER</span> <span class=\"keyword\">BY</span> <span class=\"keyword\">CONVERT</span>(j.ops_jl_start, SIGNED <span class=\"type\">INTEGER</span>);</span><br></pre></td></tr></table></figure></p>\n<h3 id=\"2-左连接按照某种条件只保留一条\"><a class=\"anchor\" href=\"#2-左连接按照某种条件只保留一条\">#</a> 2、左连接按照某种条件只保留一条</h3>\n<p><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">FROM</span></span><br><span class=\"line\">  (<span class=\"keyword\">SELECT</span> <span class=\"operator\">*</span>,</span><br><span class=\"line\">          <span class=\"built_in\">ROW_NUMBER</span>() <span class=\"keyword\">OVER</span> (<span class=\"keyword\">PARTITION</span> <span class=\"keyword\">BY</span> supplier_id</span><br><span class=\"line\">                               <span class=\"keyword\">ORDER</span> <span class=\"keyword\">BY</span> approve_date <span class=\"keyword\">DESC</span>) num</span><br><span class=\"line\">   <span class=\"keyword\">FROM</span> black_vl</span><br><span class=\"line\">   <span class=\"keyword\">WHERE</span> status <span class=\"operator\">=</span> <span class=\"string\">&#x27;XX&#x27;</span></span><br><span class=\"line\">     <span class=\"keyword\">AND</span> mean <span class=\"operator\">=</span> <span class=\"string\">&#x27;XXX&#x27;</span>) h</span><br><span class=\"line\"><span class=\"keyword\">WHERE</span> num <span class=\"operator\">=</span> <span class=\"number\">1</span>) h <span class=\"keyword\">ON</span> h.supplier_id <span class=\"operator\">=</span> cps.supplier_id</span><br><span class=\"line\">这边就是按照有多条按照approve_date最大值保存</span><br></pre></td></tr></table></figure></p>\n<h3 id=\"3-数据库查询优化\"><a class=\"anchor\" href=\"#3-数据库查询优化\">#</a> 3、数据库查询优化</h3>\n<h3 id=\"4\"><a class=\"anchor\" href=\"#4\">#</a> 4、</h3>\n",
            "tags": [
                "数据库"
            ]
        },
        {
            "id": "http://example.com/2024/10/16/post/springboot/04-%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/",
            "url": "http://example.com/2024/10/16/post/springboot/04-%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/",
            "title": "正则表达式",
            "date_published": "2024-10-16T11:37:02.191Z",
            "content_html": "<h1 id=\"正则表达式\"><a class=\"anchor\" href=\"#正则表达式\">#</a> 正则表达式</h1>\n<p>正则表达式是一种用于匹配和操作文本的强大工具，它是由一系列字符和特殊字符组成的模式，用于描述要匹配的文本模式。</p>\n<p>正则表达式可以在文本中查找、替换、提取和验证特定的模式。</p>\n<h2 id=\"使用方法\"><a class=\"anchor\" href=\"#使用方法\">#</a> 使用方法</h2>\n<h4 id=\"普通字符\"><a class=\"anchor\" href=\"#普通字符\">#</a> 普通字符</h4>\n<p>普通字符包括没有显式指定为元字符的所有可打印和不可打印字符。这包括所有大写和小写字母、所有数字、所有标点符号和一些其他符号。</p>\n<table>\n<thead>\n<tr>\n<th>字符</th>\n<th>描述</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><strong>[ABC]</strong></td>\n<td>匹配 <strong>[...]</strong> 中的所有字符，例如 <strong>[aeiou]</strong> 匹配字符串 &quot;google runoob taobao&quot; 中所有的 e o u a 字母。<img data-src=\"https://www.runoob.com/wp-content/uploads/2014/03/E691DDE1-E5CB-4EA8-8D16-759BD0D2B09D.jpg\" alt=\"img\" /></td>\n</tr>\n<tr>\n<td><strong>[^ABC]</strong></td>\n<td>匹配除了 <strong>[...]</strong> 中字符的所有字符，例如 <strong>[^aeiou]</strong> 匹配字符串 &quot;google runoob taobao&quot; 中除了 e o u a 字母的所有字符。<img data-src=\"https://www.runoob.com/wp-content/uploads/2014/03/ED971D92-30F4-4768-A2C7-02A84A3A9DEB.jpg\" alt=\"img\" /></td>\n</tr>\n<tr>\n<td><strong>[A-Z]</strong></td>\n<td>[A-Z] 表示一个区间，匹配所有大写字母，[a-z] 表示所有小写字母。<img data-src=\"https://www.runoob.com/wp-content/uploads/2014/03/C5E357BD-65E3-4EB3-9D80-10D096F19287.jpg\" alt=\"img\" /></td>\n</tr>\n<tr>\n<td><strong>.</strong></td>\n<td>匹配除换行符（\\n、\\r）之外的任何单个字符，相等于 [^\\n\\r]。<img data-src=\"https://www.runoob.com/wp-content/uploads/2014/03/0FD7E77D-38A7-43BC-B51A-7DBA23A77756.jpg\" alt=\"img\" /></td>\n</tr>\n<tr>\n<td><strong>[\\s\\S]</strong></td>\n<td>匹配所有。\\s 是匹配所有空白符，包括换行，\\S 非空白符，不包括换行。<img data-src=\"https://www.runoob.com/wp-content/uploads/2014/03/47CA6C59-64CF-433A-909E-1E342349A4E0.jpg\" alt=\"img\" /></td>\n</tr>\n<tr>\n<td><strong>\\w</strong></td>\n<td>匹配字母、数字、下划线。等价于 [A-Za-z0-9_]<img data-src=\"https://www.runoob.com/wp-content/uploads/2014/03/F35A5971-3519-4CAE-8BEC-9DE8F4A55257.jpg\" alt=\"img\" /></td>\n</tr>\n<tr>\n<td><strong>\\d</strong></td>\n<td>匹配任意一个阿拉伯数字（0 到 9）。等价于 <strong>[0-9]</strong></td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"非打印字符\"><a class=\"anchor\" href=\"#非打印字符\">#</a> 非打印字符</h4>\n<p>非打印字符也可以是正则表达式的组成部分。下表列出了表示非打印字符的转义序列：</p>\n<table>\n<thead>\n<tr>\n<th>字符</th>\n<th>描述</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>\\cx</td>\n<td>匹配由 x 指明的控制字符。例如， \\cM 匹配一个 Control-M 或回车符。x 的值必须为 A-Z 或 a-z 之一。否则，将 c 视为一个原义的 'c' 字符。</td>\n</tr>\n<tr>\n<td>\\f</td>\n<td>匹配一个换页符。等价于 \\x0c 和 \\cL。</td>\n</tr>\n<tr>\n<td>\\n</td>\n<td>匹配一个换行符。等价于 \\x0a 和 \\cJ。</td>\n</tr>\n<tr>\n<td>\\r</td>\n<td>匹配一个回车符。等价于 \\x0d 和 \\cM。</td>\n</tr>\n<tr>\n<td>\\s</td>\n<td>匹配任何空白字符，包括空格、制表符、换页符等等。等价于 [\\f\\n\\r\\t\\v]。注意 Unicode 正则表达式会匹配全角空格符。</td>\n</tr>\n<tr>\n<td>\\S</td>\n<td>匹配任何非空白字符。等价于 [^ \\f\\n\\r\\t\\v]。</td>\n</tr>\n<tr>\n<td>\\t</td>\n<td>匹配一个制表符。等价于 \\x09 和 \\cI。</td>\n</tr>\n<tr>\n<td>\\v</td>\n<td>匹配一个垂直制表符。等价于 \\x0b 和 \\cK。</td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"特殊字符\"><a class=\"anchor\" href=\"#特殊字符\">#</a> 特殊字符</h4>\n<p>所谓特殊字符，就是一些有特殊含义的字符，如上面说的 <strong>runoo*b</strong> 中的 *****，简单的说就是表示任何字符串的意思。如果要查找字符串中的 ***** 符号，则需要对 ***** 进行转义，即在其前加一个 ****，<strong>runo*ob</strong> 匹配字符串 <strong>runo*ob</strong>。</p>\n<p>许多元字符要求在试图匹配它们时特别对待。若要匹配这些特殊字符，必须首先使字符 &quot;转义&quot;，即，将反斜杠字符 **** 放在它们前面。下表列出了正则表达式中的特殊字符：</p>\n<table>\n<thead>\n<tr>\n<th>特别字符</th>\n<th>描述</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>$</td>\n<td>匹配输入字符串的结尾位置。如果设置了 RegExp 对象的 Multiline 属性，则 $ 也匹配 '\\n' 或 '\\r'。要匹配 $ 字符本身，请使用 $。</td>\n</tr>\n<tr>\n<td>( )</td>\n<td>标记一个子表达式的开始和结束位置。子表达式可以获取供以后使用。要匹配这些字符，请使用 (和)。</td>\n</tr>\n<tr>\n<td>*</td>\n<td>匹配前面的子表达式零次或多次。要匹配 * 字符，请使用 *。</td>\n</tr>\n<tr>\n<td>+</td>\n<td>匹配前面的子表达式一次或多次。要匹配 + 字符，请使用 +。</td>\n</tr>\n<tr>\n<td>.</td>\n<td>匹配除换行符 \\n 之外的任何单字符。要匹配 . ，请使用 . 。</td>\n</tr>\n<tr>\n<td>[</td>\n<td>标记一个中括号表达式的开始。要匹配 [，请使用 [。</td>\n</tr>\n<tr>\n<td>?</td>\n<td>匹配前面的子表达式零次或一次，或指明一个非贪婪限定符。要匹配？字符，请使用？。</td>\n</tr>\n<tr>\n<td>\\</td>\n<td>将下一个字符标记为或特殊字符、或原义字符、或向后引用、或八进制转义符。例如， 'n' 匹配字符 'n'。'\\n' 匹配换行符。序列 '\\' 匹配 &quot;&quot;，而 '(' 则匹配&quot;(&quot;。</td>\n</tr>\n<tr>\n<td>^</td>\n<td>匹配输入字符串的开始位置，除非在方括号表达式中使用，当该符号在方括号表达式中使用时，表示不接受该方括号表达式中的字符集合。要匹配 ^ 字符本身，请使用 ^。</td>\n</tr>\n<tr>\n<td>{</td>\n<td>标记限定符表达式的开始。要匹配 {，请使用 {。</td>\n</tr>\n<tr>\n<td>|</td>\n<td>指明两项之间的一个选择。要匹配 |，请使用 |。</td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"限定符\"><a class=\"anchor\" href=\"#限定符\">#</a> 限定符</h4>\n<p>限定符用来指定正则表达式的一个给定组件必须要出现多少次才能满足匹配。有 ***** 或 <strong>+</strong> 或 <strong>?</strong> 或 <strong>{n}</strong> 或 <strong>{n,}</strong> 或 <strong>{n,m}</strong> 共 6 种。</p>\n<p>正则表达式的限定符有：</p>\n<table>\n<thead>\n<tr>\n<th>字符</th>\n<th>描述</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>*</td>\n<td>匹配前面的子表达式零次或多次。例如，<strong>zo*</strong> 能匹配 <strong>&quot;z&quot;</strong> 以及 <strong>&quot;zoo&quot;</strong>。***** 等价于 <strong>{0,}</strong>。</td>\n</tr>\n<tr>\n<td>+</td>\n<td>匹配前面的子表达式一次或多次。例如，<strong>zo+</strong> 能匹配 <strong>&quot;zo&quot;</strong>以及&quot;<strong>zoo&quot;</strong>，但不能匹配 <strong>&quot;z&quot;</strong>。<strong>+</strong> 等价于 <strong>{1,}</strong>。</td>\n</tr>\n<tr>\n<td>?</td>\n<td>匹配前面的子表达式零次或一次。例如，<strong>do(es)?</strong> 可以匹配 <strong>&quot;do&quot;</strong> 、 <strong>&quot;does&quot;</strong>、 <strong>&quot;doxy&quot;</strong> 中的 <strong>&quot;do&quot;</strong> 和 <strong>&quot;does&quot;</strong>。<strong>?</strong> 等价于 <strong>{0,1}</strong>。<img data-src=\"https://www.runoob.com/wp-content/uploads/2014/03/CA742DA3-826D-463B-85F5-316DAB3515C1.jpeg\" alt=\"img\" /></td>\n</tr>\n<tr>\n<td n=\"\"></td>\n<td>n 是一个非负整数。匹配确定的 <strong>n</strong> 次。例如，<strong>o{2}</strong> 不能匹配 <strong>&quot;Bob&quot;</strong> 中的 <strong>o</strong>，但是能匹配 <strong>&quot;food&quot;</strong> 中的两个 <strong>o</strong>。</td>\n</tr>\n<tr>\n<td n,=\"\"></td>\n<td>n 是一个非负整数。至少匹配 n 次。例如，<strong>o{2,}</strong> 不能匹配 <strong>&quot;Bob&quot;</strong> 中的 <strong>o</strong>，但能匹配 <strong>&quot;foooood&quot;</strong> 中的所有 <strong>o</strong>。<strong>o{1,}</strong> 等价于 <strong>o+</strong>。<strong>o{0,}</strong> 则等价于 <strong>o*</strong>。</td>\n</tr>\n<tr>\n<td n,m=\"\"></td>\n<td>m 和 n 均为非负整数，其中 n &lt;= m。最少匹配 n 次且最多匹配 m 次。例如，<strong>o{1,3}</strong> 将匹配 <strong>&quot;fooooood&quot;</strong> 中的前三个 <strong>o</strong>。<strong>o{0,1}</strong> 等价于 <strong>o?</strong>。请注意在逗号和两个数之间不能有空格。</td>\n</tr>\n</tbody>\n</table>\n<p>以下正则表达式匹配一个正整数，<strong>[1-9]<strong> 设置第一个数字不是 0，</strong>[0-9]*</strong> 表示任意多个数字：</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/[1-9][0-9]*/</span><br></pre></td></tr></table></figure></p>\n<p><img data-src=\"D:%5CPictures%5Ctypore%5CF249891D-F3D9-48D5-A3CB-6FD8FD029117.jpg\" alt=\"img\" /></p>\n<p>请注意，限定符出现在范围表达式之后。因此，它应用于整个范围表达式，在本例中，只指定从 0 到 9 的数字（包括 0 和 9）。</p>\n<p>这里不使用 + 限定符，因为在第二个位置或后面的位置不一定需要有一个数字。也不使用？字符，因为使用？会将整数限制到只有两位数。</p>\n<p>如果你想设置 0~99 的两位数，可以使用下面的表达式来至少指定一位但至多两位数字。</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/[0-9]&#123;1,2&#125;/</span><br></pre></td></tr></table></figure></p>\n<p>上面的表达式的缺点是，只能匹配两位数字，而且可以匹配 0、00、01、10 99 的章节编号仍只匹配开头两位数字。</p>\n<p>改进下，匹配 1~99 的正整数表达式如下：</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/[1-9][0-9]?/</span><br></pre></td></tr></table></figure></p>\n<p>或</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/[1-9][0-9]&#123;0,1&#125;/</span><br></pre></td></tr></table></figure></p>\n<p><em><em><em>*</em>*</em> 和 *</em>+** 限定符都是贪婪的，因为它们会尽可能多的匹配文字，只有在它们的后面加上一个？就可以实现非贪婪或最小匹配。**</p>\n<p>例如，您可能搜索 HTML 文档，以查找在 <strong>h1</strong> 标签内的内容。HTML 代码如下：</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;h1&gt;RUNOOB-菜鸟教程&lt;/h1&gt;</span><br></pre></td></tr></table></figure></p>\n<p>** 贪婪：** 下面的表达式匹配从开始小于符号 (&lt;) 到关闭 h1 标记的大于符号 (&gt;) 之间的所有内容。</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/&lt;.*&gt;/</span><br></pre></td></tr></table></figure></p>\n<p><img data-src=\"D:%5CPictures%5Ctypore%5CAD8F3320-2F2E-4513-9BB5-84450D62783D.jpg\" alt=\"img\" /></p>\n<p>** 非贪婪：** 如果您只需要匹配开始和结束 h1 标签，下面的非贪婪表达式只匹配 &lt;h1&gt;。</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/&lt;.*?&gt;/</span><br></pre></td></tr></table></figure></p>\n<p><img data-src=\"D:%5CPictures%5Ctypore%5CA6E72665-CE61-46F4-A72B-A34BC13F5820.jpg\" alt=\"img\" /></p>\n<p>也可以使用以下正则表达式来匹配 h1 标签，表达式则是：</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/&lt;\\w+?&gt;/</span><br></pre></td></tr></table></figure></p>\n<p><img data-src=\"D:%5CPictures%5Ctypore%5CC6E89F76-D059-4600-A507-74C42306A790.jpg\" alt=\"img\" /></p>\n<p>通过在 *<strong><strong>、</strong>+</strong> 或 <strong>?</strong> 限定符之后放置 <strong>?</strong>，该表达式从 &quot;贪婪&quot; 表达式转换为 &quot;非贪婪&quot; 表达式或者最小匹配。</p>\n<h4 id=\"定位符\"><a class=\"anchor\" href=\"#定位符\">#</a> 定位符</h4>\n<p>定位符使您能够将正则表达式固定到行首或行尾。它们还使您能够创建这样的正则表达式，这些正则表达式出现在一个单词内、在一个单词的开头或者一个单词的结尾。</p>\n<p>定位符用来描述字符串或单词的边界，<strong>^</strong> 和 <strong>$</strong> 分别指字符串的开始与结束，<strong>\\b</strong> 描述单词的前或后边界，<strong>\\B</strong> 表示非单词边界。</p>\n<p>正则表达式的定位符有：</p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">字符</th>\n<th style=\"text-align:left\">描述</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">^</td>\n<td style=\"text-align:left\">匹配输入字符串开始的位置。如果设置了 RegExp 对象的 Multiline 属性，^ 还会与 \\n 或 \\r 之后的位置匹配。</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">$</td>\n<td style=\"text-align:left\">匹配输入字符串结尾的位置。如果设置了 RegExp 对象的 Multiline 属性，$ 还会与 \\n 或 \\r 之前的位置匹配。</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">\\b</td>\n<td style=\"text-align:left\">匹配一个单词边界，即字与空格间的位置。</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">\\B</td>\n<td style=\"text-align:left\">非单词边界匹配。</td>\n</tr>\n</tbody>\n</table>\n<p><strong>注意</strong>：不能将限定符与定位符一起使用。由于在紧靠换行或者单词边界的前面或后面不能有一个以上位置，因此不允许诸如 <strong>^*</strong> 之类的表达式。</p>\n<p>若要匹配一行文本开始处的文本，请在正则表达式的开始使用 <strong>^</strong> 字符。不要将 <strong>^</strong> 的这种用法与中括号表达式内的用法混淆。</p>\n<p>若要匹配一行文本的结束处的文本，请在正则表达式的结束处使用 <strong>$</strong> 字符。</p>\n<p>若要在搜索章节标题时使用定位点，下面的正则表达式匹配一个章节标题，该标题只包含两个尾随数字，并且出现在行首：</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/^Chapter [1-9][0-9]&#123;0,1&#125;/</span><br></pre></td></tr></table></figure></p>\n<p>真正的章节标题不仅出现行的开始处，而且它还是该行中仅有的文本。它既出现在行首又出现在同一行的结尾。下面的表达式能确保指定的匹配只匹配章节而不匹配交叉引用。通过创建只匹配一行文本的开始和结尾的正则表达式，就可做到这一点。</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/^Chapter [1-9][0-9]&#123;0,1&#125;$/</span><br></pre></td></tr></table></figure></p>\n<p>匹配单词边界稍有不同，但向正则表达式添加了很重要的能力。单词边界是单词和空格之间的位置。非单词边界是任何其他位置。下面的表达式匹配单词 Chapter 的开头三个字符，因为这三个字符出现在单词边界后面：</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/\\bCha/</span><br></pre></td></tr></table></figure></p>\n<p><strong>\\b</strong> 字符的位置是非常重要的。如果它位于要匹配的字符串的开始，它在单词的开始处查找匹配项。如果它位于字符串的结尾，它在单词的结尾处查找匹配项。例如，下面的表达式匹配单词 Chapter 中的字符串 ter，因为它出现在单词边界的前面：</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/ter\\b/</span><br></pre></td></tr></table></figure></p>\n<p>下面的表达式匹配 Chapter 中的字符串 apt，但不匹配 aptitude 中的字符串 apt：</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/\\Bapt/</span><br></pre></td></tr></table></figure></p>\n<p>字符串 apt 出现在单词 Chapter 中的非单词边界处，但出现在单词 aptitude 中的单词边界处。对于 <strong>\\B</strong> 非单词边界运算符，不可以匹配单词的开头或结尾，如果是下面的表达式，就不匹配 Chapter 中的 Cha：</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">\\BCha</span><br></pre></td></tr></table></figure></p>\n<h4 id=\"选择\"><a class=\"anchor\" href=\"#选择\">#</a> 选择</h4>\n<p>用圆括号 <strong>()</strong> 将所有选择项括起来，相邻的选择项之间用 <strong>|</strong> 分隔。</p>\n<p><strong>()</strong> 表示捕获分组，<strong>()</strong> 会把每个分组里的匹配的值保存起来， 多个匹配值可以通过数字 n 来查看 (<strong>n</strong> 是一个数字，表示第 n 个捕获组的内容)。</p>\n<p><img data-src=\"D:%5CPictures%5Ctypore%5C366574CC-3706-4B4C-8782-1BFF4CF57582.jpg\" alt=\"img\" /></p>\n<p><img data-src=\"D:%5CPictures%5Ctypore%5C82A7298A-2A94-49E3-AA27-A7778EE89711.jpg\" alt=\"img\" /></p>\n<p>但用圆括号会有一个副作用，使相关的匹配会被缓存，此时可用 <strong>?:</strong> 放在第一个选项前来消除这种副作用。</p>\n<p>其中 <strong>?:</strong> 是非捕获元之一，还有两个非捕获元是 <strong>?=</strong> 和 <strong>?!</strong>，这两个还有更多的含义，前者为正向预查，在任何开始匹配圆括号内的正则表达式模式的位置来匹配搜索字符串，后者为负向预查，在任何开始不匹配该正则表达式模式的位置来匹配搜索字符串。</p>\n<h3 id=\"以下列出-的使用区别\"><a class=\"anchor\" href=\"#以下列出-的使用区别\">#</a> 以下列出？=、?&lt;=、?!、?&lt;! 的使用区别</h3>\n<p><strong>exp1(?=exp2)</strong>：查找 exp2 前面的 exp1。</p>\n<p><img data-src=\"D:%5CPictures%5Ctypore%5Creg-111.jpg\" alt=\"img\" /></p>\n<p><strong>(?&lt;=exp2)exp1</strong>：查找 exp2 后面的 exp1。</p>\n<p><img data-src=\"D:%5CPictures%5Ctypore%5Creg-222.jpg\" alt=\"img\" /></p>\n<p><strong>exp1(?!exp2)</strong>：查找后面不是 exp2 的 exp1。</p>\n<p><img data-src=\"D:%5CPictures%5Ctypore%5Creg-333.jpg\" alt=\"img\" /></p>\n<p><strong>(?&lt;!exp2)exp1</strong>：查找前面不是 exp2 的 exp1。</p>\n<p><img data-src=\"D:%5CPictures%5Ctypore%5Creg-444.jpg\" alt=\"img\" /></p>\n<h2 id=\"示例\"><a class=\"anchor\" href=\"#示例\">#</a> 示例</h2>\n<h5 id=\"1-匹配-html-标签及内容\"><a class=\"anchor\" href=\"#1-匹配-html-标签及内容\">#</a> 1、匹配 HTML 标签及内容</h5>\n<p>以下正则表达式用于匹配 iframe 标签：</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/&lt;iframe(([\\s\\S])*?)&lt;\\/iframe&gt;/</span><br></pre></td></tr></table></figure></p>\n<p>其他标签的匹配可以替换 <strong>iframe</strong> 。</p>\n<p>匹配 id=&quot;mydiv&quot; 的 div 标签：</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/&lt;div id=&quot;mydiv&quot;(([\\s\\S])*?)&lt;\\/div&gt;/</span><br></pre></td></tr></table></figure></p>\n<h5 id=\"2-中文正则表达式\"><a class=\"anchor\" href=\"#2-中文正则表达式\">#</a> 2、中文正则表达式</h5>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/[\\u4E00-\\u9FA5]/;</span><br></pre></td></tr></table></figure></p>\n<h5 id=\"3-密码强度正则表达式\"><a class=\"anchor\" href=\"#3-密码强度正则表达式\">#</a> 3、密码强度正则表达式</h5>\n<p>最少六位，包括至少 1 个大写字母，1 个小写字母，1 个数字，1 个特殊字符</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/^.*(?=.&#123;6,&#125;)(?=.*\\d)(?=.*[A-Z])(?=.*[a-z])(?=.*[!@#$%^&amp;*? ]).*$/;、</span><br></pre></td></tr></table></figure></p>\n<h5 id=\"4-邮箱正则表达式\"><a class=\"anchor\" href=\"#4-邮箱正则表达式\">#</a> 4、邮箱正则表达式</h5>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/^(([^&lt;&gt;()[\\]\\\\.,;:\\s@\\&quot;]+(\\.[^&lt;&gt;()[\\]\\\\.,;:\\s@\\&quot;]+)*)|(\\&quot;.+\\&quot;))@((\\[[0-9]&#123;1,3&#125;\\.[0-9]&#123;1,3&#125;\\.[0-9]&#123;1,3&#125;\\.[0-9]&#123;1,3&#125;\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]&#123;2,&#125;))$/</span><br><span class=\"line\"> );</span><br></pre></td></tr></table></figure></p>\n<p>附录：</p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">正则表达式</th>\n<th style=\"text-align:left\">描述</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\"><code>/\\b([a-z]+) \\1\\b/gi</code></td>\n<td style=\"text-align:left\">一个单词连续出现的位置。</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><code>/(\\w+):\\/\\/([^/:]+)(:\\d*)?([^# ]*)/</code></td>\n<td style=\"text-align:left\">匹配一个 URL 解析为协议、域、端口及相对路径。</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><code>/^(?:Chapter|Section) [1-9][0-9]&#123;0,1&#125;$/</code></td>\n<td style=\"text-align:left\">定位章节的位置。</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><code>/[-a-z]/</code></td>\n<td style=\"text-align:left\">a 至 z 共 26 个 字母再加一个 <strong>-</strong> 号。</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><code>/ter\\b/</code></td>\n<td style=\"text-align:left\">可匹配 chapter，而不能匹配 terminal。</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><code>/\\Bapt/</code></td>\n<td style=\"text-align:left\">可匹配 chapter，而不能匹配 aptitude。</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><code>/Windows(?=95 |98 |NT )/</code></td>\n<td style=\"text-align:left\">可匹配 Windows95 或 Windows98 或 WindowsNT，当找到一个匹配后，从 Windows 后面开始进行下一次的检索匹配。</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><code>/^\\s*$/</code></td>\n<td style=\"text-align:left\">匹配空行。</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><code>/\\d&#123;2&#125;-\\d&#123;5&#125;/</code></td>\n<td style=\"text-align:left\">验证由两位数字、一个连字符再加 5 位数字组成的 ID 号。</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><code>&lt;[a-zA-Z]+.*?&gt;([\\s\\S]*?)&lt;/[a-zA-Z]*?&gt;</code></td>\n<td style=\"text-align:left\">匹配 HTML 标记。</td>\n</tr>\n</tbody>\n<tbody>\n<tr>\n<td style=\"text-align:left\">正则表达式</td>\n<td style=\"text-align:left\">描述</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">:--------------------</td>\n<td style=\"text-align:left\">:-----------------------------------------------------------</td>\n</tr>\n<tr hello=\"\">\n<td style=\"text-align:left\"><code>hello</code></td>\n<td style=\"text-align:left\">匹配</td>\n</tr>\n<tr gray,=\"\" grey=\"\">\n<td style=\"text-align:left\"><code>gray|grey</code></td>\n<td style=\"text-align:left\">匹配</td>\n</tr>\n<tr gray,=\"\" grey=\"\">\n<td style=\"text-align:left\"><code>gr(a|e)y</code></td>\n<td style=\"text-align:left\">匹配</td>\n</tr>\n<tr gray,=\"\" grey=\"\">\n<td style=\"text-align:left\"><code>gr[ae]y</code></td>\n<td style=\"text-align:left\">匹配</td>\n</tr>\n<tr babble,=\"\" bebble,=\"\" bibble,=\"\" bobble,=\"\" bubble=\"\">\n<td style=\"text-align:left\"><code>b[aeiou]bble</code></td>\n<td style=\"text-align:left\">匹配</td>\n</tr>\n<tr bat,=\"\" cat,=\"\" hat,=\"\" mat,=\"\" nat,=\"\" oat,=\"\" pat,=\"\" Pat,=\"\" ot=\"\">\n<td style=\"text-align:left\"><code>[b-chm-pP]at|ot</code></td>\n<td style=\"text-align:left\">匹配</td>\n</tr>\n<tr color,=\"\" colour=\"\">\n<td style=\"text-align:left\"><code>colou?r</code></td>\n<td style=\"text-align:left\">匹配</td>\n</tr>\n<tr regex,=\"\" regexes,=\"\" regexp,=\"\" regexps=\"\">\n<td style=\"text-align:left\"><code>rege(x(es)?|xps?)</code></td>\n<td style=\"text-align:left\">匹配</td>\n</tr>\n<tr ggle,=\"\" gogle,=\"\" google,=\"\" gooogle,=\"\" goooogle,=\"\" css-module=\".\">\n<td style=\"text-align:left\"><code>go*gle</code></td>\n<td style=\"text-align:left\">匹配</td>\n</tr>\n<tr gogle,=\"\" google,=\"\" gooogle,=\"\" goooogle,=\"\" css-module=\".\">\n<td style=\"text-align:left\"><code>go+gle</code></td>\n<td style=\"text-align:left\">匹配</td>\n</tr>\n<tr google,=\"\" googoogle,=\"\" googoogoogle,=\"\" googoogoogoogle,=\"\" css-module=\".\">\n<td style=\"text-align:left\"><code>g(oog)+le</code></td>\n<td style=\"text-align:left\">匹配</td>\n</tr>\n<tr zzz=\"\">\n<td style=\"text-align:left\"><code>z&#123;3&#125;</code></td>\n<td style=\"text-align:left\">匹配</td>\n</tr>\n<tr zzz,=\"\" zzzz,=\"\" zzzzz,=\"\" zzzzzz=\"\">\n<td style=\"text-align:left\"><code>z&#123;3,6&#125;</code></td>\n<td style=\"text-align:left\">匹配</td>\n</tr>\n<tr zzz,=\"\" zzzz,=\"\" zzzzz,=\"\" css-module=\".\">\n<td style=\"text-align:left\"><code>z&#123;3,&#125;</code></td>\n<td style=\"text-align:left\">匹配</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><code>[Bb]rainf\\*\\*k</code></td>\n<td style=\"text-align:left\">匹配 {Brainf<strong>k, brainf</strong>k}</td>\n</tr>\n<tr 0,1,2,3,4,5,6,7,8,9=\"\">\n<td style=\"text-align:left\"><code>\\d</code></td>\n<td style=\"text-align:left\">匹配</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><code>1\\d&#123;10&#125;</code></td>\n<td style=\"text-align:left\">匹配 11 个数字，以 1 开头</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><code>[2-9]|[12]\\d|3[0-6]</code></td>\n<td style=\"text-align:left\">匹配 2 到 36 范围内的整数</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><code>Hello\\nworld</code></td>\n<td style=\"text-align:left\">匹配 Hello 后跟换行符，后跟 world</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><code>\\d+(\\.\\d\\d)?</code></td>\n<td style=\"text-align:left\">包含一个正整数或包含两位小数位的浮点数。</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><code>[^*@#]</code></td>\n<td style=\"text-align:left\">排除 *、@ 、# 三个特色符号</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><code>//[^\\r\\n]*[\\r\\n]</code></td>\n<td style=\"text-align:left\">匹配 <strong>//</strong> 开头的注释</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><code>^dog</code></td>\n<td style=\"text-align:left\">匹配以 &quot;dog&quot; 开始</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><code>dog$</code></td>\n<td style=\"text-align:left\">匹配以 &quot;dog&quot; 结尾</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><code>^dog$</code></td>\n<td style=\"text-align:left\">is exactly &quot;dog&quot;</td>\n</tr>\n</tbody>\n</table>\n",
            "tags": [
                "后端",
                "正则"
            ]
        },
        {
            "id": "http://example.com/2024/10/16/post/springboot/03-Mybatis-Plus%20@SqlParser%E6%B3%A8%E8%A7%A3/",
            "url": "http://example.com/2024/10/16/post/springboot/03-Mybatis-Plus%20@SqlParser%E6%B3%A8%E8%A7%A3/",
            "title": "03-Mybatis-Plus @SqlParser注解",
            "date_published": "2024-10-16T11:37:02.189Z",
            "content_html": "<h1 id=\"mybatis-plus-sqlparser注解\"><a class=\"anchor\" href=\"#mybatis-plus-sqlparser注解\">#</a> Mybatis-Plus @SqlParser 注解</h1>\n<p>@SqlParser 注解在<span class=\"exturl\" data-url=\"aHR0cHM6Ly9zby5jc2RuLm5ldC9zby9zZWFyY2g/cT0lRTUlQTQlOUElRTclQTclOUYlRTYlODglQjcmYW1wO3NwbT0xMDAxLjIxMDEuMzAwMS43MDIw\">多租户</span>的模式下，用来过滤的注解，在最新的 Mybatis Plus 中这个 @SqlParser1 注解已经过时。</p>\n<h4 id=\"那什么是多租户模式\"><a class=\"anchor\" href=\"#那什么是多租户模式\">#</a> 那什么是多租户模式？</h4>\n<p>MyBatis 的多租户模式是指在数据库设计和应用程序开发中，针对需要支持多个独立用户群体（如企业客户 A、B、C 等，每个都有各自的业务数据）的情况，通过一些特定的技术手段来处理。在这种模式下，我们通常会做以下几个步骤：</p>\n<ol>\n<li><strong>数据库表设计</strong>：为每个租户创建单独的数据表空间或者隔离区，比如添加一个 <code>tenant_id</code>  字段用于标识租户。</li>\n<li><strong>Mapper 配置</strong>：在 MyBatis 的 mapper XML 文件中，通过 <code>where</code>  条件基于 <code>tenant_id</code>  动态过滤查询结果，只返回对应租户的数据。</li>\n<li><strong>事务管理</strong>：在多租户环境下，可能需要为每个租户维护单独的数据库连接或事务，避免数据交叉污染。</li>\n<li><strong>服务层封装</strong>：在业务层，使用工厂模式或者策略模式，为每个租户创建对应的 Service 实例，调用对应的 Mapper。</li>\n<li><strong>安全访问控制</strong>：除了数据库层面，还需要在应用层对租户进行权限验证和访问控制。</li>\n</ol>\n<h4 id=\"替代注解\"><a class=\"anchor\" href=\"#替代注解\">#</a> 替代注解</h4>\n<p>当我们的需要过滤多租户，我们就需要用 @InterceptorIgnore (tenantLine = “1”) 注解来代替。</p>\n<p>拦截忽略注解 @InterceptorIgnore</p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">属性名</th>\n<th style=\"text-align:center\">类型</th>\n<th style=\"text-align:center\">默认值</th>\n<th style=\"text-align:center\">描述</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">tenantLine</td>\n<td style=\"text-align:center\">String</td>\n<td style=\"text-align:center\">&quot;&quot;</td>\n<td style=\"text-align:center\">行级租户</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">dynamicTableName</td>\n<td style=\"text-align:center\">String</td>\n<td style=\"text-align:center\">&quot;&quot;</td>\n<td style=\"text-align:center\">动态表名</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">blockAttack</td>\n<td style=\"text-align:center\">String</td>\n<td style=\"text-align:center\">&quot;&quot;</td>\n<td style=\"text-align:center\">攻击 SQL 阻断解析器，防止全表更新与删除</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">iillegeSql</td>\n<td style=\"text-align:center\">String</td>\n<td style=\"text-align:center\">&quot;&quot;</td>\n<td style=\"text-align:center\">垃圾 SQL 拦截</td>\n</tr>\n</tbody>\n</table>\n<p>该注解作用于 xxMapper.java 方法之上 各属性代表对应的插件 各属性不给值则默认为 false 设置为 true 忽略拦截 更多说明详见源码注释</p>\n<p>@SqlParser (filter = true) 与 @InterceptorIgnore (tenantLine = “1”) 等价</p>\n",
            "tags": [
                "后端",
                "Mybatis-Plus"
            ]
        },
        {
            "id": "http://example.com/2024/10/16/post/springboot/02-String%E3%80%81Date%E3%80%81LocalDate%E4%B9%8B%E9%97%B4%E7%9A%84%E8%BD%AC%E6%8D%A2/",
            "url": "http://example.com/2024/10/16/post/springboot/02-String%E3%80%81Date%E3%80%81LocalDate%E4%B9%8B%E9%97%B4%E7%9A%84%E8%BD%AC%E6%8D%A2/",
            "title": "02-String、Date、LocalDate之间的转换",
            "date_published": "2024-10-16T11:37:02.173Z",
            "content_html": "<h1 id=\"string-date-localdate之间的转换\"><a class=\"anchor\" href=\"#string-date-localdate之间的转换\">#</a> String、Date、LocalDate 之间的转换</h1>\n<h3 id=\"一-date和string\"><a class=\"anchor\" href=\"#一-date和string\">#</a> 一、Date 和 String</h3>\n<blockquote>\n<p>使用 SimpleDateFormat 对象指定目标日期格式</p>\n</blockquote>\n<h4 id=\"1-date转string\"><a class=\"anchor\" href=\"#1-date转string\">#</a> 1、Date 转 String</h4>\n<p><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//主要根据&quot;yyyy-MM-dd HH:mm:ss&quot;进行格式的变换</span></span><br><span class=\"line\"><span class=\"type\">Date</span> <span class=\"variable\">date</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>();</span><br><span class=\"line\">\t<span class=\"type\">SimpleDateFormat</span> <span class=\"variable\">formatter</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">SimpleDateFormat</span>(<span class=\"string\">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>);</span><br><span class=\"line\">\tSystem.out.println(formatter.format(date));</span><br></pre></td></tr></table></figure></p>\n<h4 id=\"2-string转date\"><a class=\"anchor\" href=\"#2-string转date\">#</a> 2、String 转 Date</h4>\n<p><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">String</span> <span class=\"variable\">date</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;2023-05-31 22:41:21&quot;</span>;</span><br><span class=\"line\">    <span class=\"type\">SimpleDateFormat</span> <span class=\"variable\">formatter</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">SimpleDateFormat</span>(<span class=\"string\">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>);</span><br><span class=\"line\">    System.out.println(formatter.parse(date));</span><br></pre></td></tr></table></figure></p>\n<h3 id=\"二-date和localdate\"><a class=\"anchor\" href=\"#二-date和localdate\">#</a> 二、Date 和 LocalDate</h3>\n<blockquote>\n<p>转变为中间对象 Instant，都需要用到 ZoneId 时区</p>\n</blockquote>\n<h4 id=\"1-date转localdate\"><a class=\"anchor\" href=\"#1-date转localdate\">#</a> 1、Date 转 LocalDate</h4>\n<p><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">&quot;====LocalDate====&quot;</span></span><br><span class=\"line\"><span class=\"type\">Date</span> <span class=\"variable\">date</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>();</span><br><span class=\"line\"><span class=\"type\">LocalDate</span> <span class=\"variable\">localDate</span> <span class=\"operator\">=</span> date.toInstant().atZone(ZoneId.systemDefault()).toLocalDate();</span><br><span class=\"line\">System.out.println(localDate);</span><br><span class=\"line\"><span class=\"string\">&quot;====LocalDateTime====&quot;</span></span><br><span class=\"line\"><span class=\"type\">LocalDateTime</span> <span class=\"variable\">localDateTime</span> <span class=\"operator\">=</span> date.toInstant().atZone(ZoneId.systemDefault()).toLocalDateTime();</span><br><span class=\"line\">System.out.println(localDateTime);</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure></p>\n<h4 id=\"2-localdate转date\"><a class=\"anchor\" href=\"#2-localdate转date\">#</a> 2、LocalDate 转 Date</h4>\n<p><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">ZoneId</span> <span class=\"variable\">zone</span> <span class=\"operator\">=</span> ZoneId.systemDefault();</span><br><span class=\"line\"><span class=\"string\">&quot;====LocalDate====&quot;</span></span><br><span class=\"line\">    <span class=\"type\">LocalDate</span> <span class=\"variable\">localDate</span> <span class=\"operator\">=</span> LocalDate.of(<span class=\"number\">2023</span>, <span class=\"number\">5</span>, <span class=\"number\">31</span>);</span><br><span class=\"line\">    <span class=\"type\">Instant</span> <span class=\"variable\">instant</span> <span class=\"operator\">=</span> localDate.atStartOfDay().atZone(zone).toInstant();</span><br><span class=\"line\">    Sy stem.out.println(Date.from(instant));</span><br><span class=\"line\"></span><br><span class=\"line\"> \t<span class=\"type\">LocalDate</span> <span class=\"variable\">date2</span> <span class=\"operator\">=</span> LocalDate.parse(<span class=\"string\">&quot;2023-05-13&quot;</span>, DateTimeFormatter.ISO_LOCAL_DATE);</span><br><span class=\"line\">    <span class=\"type\">Instant</span> <span class=\"variable\">instant2</span> <span class=\"operator\">=</span> date2.atStartOfDay().atZone(zone).toInstant();</span><br><span class=\"line\">    System.out.println(Date.from(instant2));</span><br><span class=\"line\"><span class=\"string\">&quot;====LocalDateTime====&quot;</span></span><br><span class=\"line\">    <span class=\"type\">LocalDateTime</span> <span class=\"variable\">localDateTime2</span> <span class=\"operator\">=</span> LocalDateTime.of(<span class=\"number\">2023</span>, <span class=\"number\">5</span>, <span class=\"number\">31</span>, <span class=\"number\">23</span>, <span class=\"number\">13</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"type\">Instant</span> <span class=\"variable\">instant3</span> <span class=\"operator\">=</span> localDateTime2.atZone(zone).toInstant();</span><br><span class=\"line\">    System.out.println(Date.from(instant3));</span><br></pre></td></tr></table></figure></p>\n<h3 id=\"三-localdate和string\"><a class=\"anchor\" href=\"#三-localdate和string\">#</a> 三、LocalDate 和 String</h3>\n<blockquote>\n<p>使用 DateTimeFormatter 指定目标日期格式</p>\n</blockquote>\n<h4 id=\"1-localdate转string\"><a class=\"anchor\" href=\"#1-localdate转string\">#</a> 1、LocalDate 转 String</h4>\n<p><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">&quot;====LocalDate====&quot;</span></span><br><span class=\"line\">\t<span class=\"type\">DateTimeFormatter</span> <span class=\"variable\">df</span> <span class=\"operator\">=</span> DateTimeFormatter.ofPattern(<span class=\"string\">&quot;yyyy-MM-dd&quot;</span>);</span><br><span class=\"line\">\t<span class=\"type\">LocalDate</span> <span class=\"variable\">localDate</span> <span class=\"operator\">=</span> LocalDate.of(<span class=\"string\">&quot;2020-2-5&quot;</span>);</span><br><span class=\"line\">\t<span class=\"comment\">//LocalDate localDate = LocalDate.of(2020, 2, 5);</span></span><br><span class=\"line\">    System.out.println(localDate.format(df));</span><br><span class=\"line\"><span class=\"string\">&quot;====LocalDateTime====&quot;</span></span><br><span class=\"line\">    <span class=\"type\">DateTimeFormatter</span> <span class=\"variable\">df3</span> <span class=\"operator\">=</span> DateTimeFormatter.ofPattern(YYYY_MM_DD_HH_MM_SS_12);</span><br><span class=\"line\">\t<span class=\"comment\">//DateTimeFormatter df3 = DateTimeFormatter.ofPattern(&quot;yyyy-MM-dd HH:mm:ss&quot;);</span></span><br><span class=\"line\">    <span class=\"type\">LocalDateTime</span> <span class=\"variable\">localDateTime</span> <span class=\"operator\">=</span> LocalDateTime.of(<span class=\"number\">2020</span>, <span class=\"number\">2</span>, <span class=\"number\">5</span>, <span class=\"number\">14</span>, <span class=\"number\">30</span>);</span><br><span class=\"line\">    System.out.println(df3.format(localDateTime));</span><br></pre></td></tr></table></figure></p>\n<h4 id=\"2-string转localdate\"><a class=\"anchor\" href=\"#2-string转localdate\">#</a> 2、String 转 LocalDate</h4>\n<p><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">&quot;====LocalDate====&quot;</span></span><br><span class=\"line\">    <span class=\"type\">String</span> <span class=\"variable\">dateStr</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;2023-05-31&quot;</span>;</span><br><span class=\"line\">    <span class=\"type\">DateTimeFormatter</span> <span class=\"variable\">df</span> <span class=\"operator\">=</span> DateTimeFormatter.ofPattern(<span class=\"string\">&quot;yyyy-MM-dd&quot;</span>);</span><br><span class=\"line\">    System.out.println(LocalDate.parse(dateStr, df));</span><br><span class=\"line\"><span class=\"string\">&quot;====LocalDateTime====&quot;</span></span><br><span class=\"line\">    <span class=\"type\">String</span> <span class=\"variable\">timeStr</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;2023-05-31 16:41:21&quot;</span>;</span><br><span class=\"line\">    <span class=\"type\">DateTimeFormatter</span> <span class=\"variable\">df3</span> <span class=\"operator\">=</span> DateTimeFormatter.ofPattern(<span class=\"string\">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>);</span><br><span class=\"line\">    System.out.println(LocalDateTime.parse(timeStr, df3));</span><br></pre></td></tr></table></figure></p>\n<h3 id=\"四-localdate日期判断\"><a class=\"anchor\" href=\"#四-localdate日期判断\">#</a> 四、LocalDate 日期判断</h3>\n<p>例子：</p>\n<h4 id=\"1-判断月份与时间\"><a class=\"anchor\" href=\"#1-判断月份与时间\">#</a> 1、判断月份与时间</h4>\n<p><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">DateTimeFormatter</span> <span class=\"variable\">df</span> <span class=\"operator\">=</span> DateTimeFormatter.ofPattern(<span class=\"string\">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>);</span><br><span class=\"line\"><span class=\"type\">LocalDateTime</span> <span class=\"variable\">time</span> <span class=\"operator\">=</span> LocalDateTime.parse(TimeStr,df);</span><br><span class=\"line\"><span class=\"comment\">//判断是这个月的最后一天且 时间没有过中午十二点</span></span><br><span class=\"line\"><span class=\"keyword\">if</span>(time.getDayOfMonth()==time.getMonth().maxLength() &amp;&amp; sj.getHour()&lt;<span class=\"number\">12</span>)</span><br><span class=\"line\">    </span><br><span class=\"line\"><span class=\"comment\">//判断日期小于24号，如果为24号，也小于下午四点</span></span><br><span class=\"line\"><span class=\"keyword\">if</span>(time.getDayOfMonth()&lt;<span class=\"number\">24</span> || (time.getDayOfMonth()==<span class=\"number\">24</span> &amp;&amp; time.getHour()&lt;<span class=\"number\">16</span>)</span><br></pre></td></tr></table></figure></p>\n<h4 id=\"2-设置时间\"><a class=\"anchor\" href=\"#2-设置时间\">#</a> 2、设置时间</h4>\n<p><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//比time 多一个月，设1日  00:00:00</span></span><br><span class=\"line\"><span class=\"type\">LocalDateTime</span> <span class=\"variable\">transDate</span> <span class=\"operator\">=</span> time.plusMonths(<span class=\"number\">1</span>).withDayOfMonth(<span class=\"number\">1</span>).withHour(<span class=\"number\">0</span>).withMinute(<span class=\"number\">0</span>).withSecond(<span class=\"number\">0</span>);</span><br></pre></td></tr></table></figure></p>\n",
            "tags": [
                "后端",
                "Java",
                "数据类型"
            ]
        },
        {
            "id": "http://example.com/2024/10/16/post/linux/linux%E5%9F%BA%E7%A1%80/",
            "url": "http://example.com/2024/10/16/post/linux/linux%E5%9F%BA%E7%A1%80/",
            "title": "linux基础",
            "date_published": "2024-10-16T11:37:02.129Z",
            "content_html": "<h1 id=\"linux基础\"><a class=\"anchor\" href=\"#linux基础\">#</a> Linux 基础</h1>\n<h3 id=\"linux-简介\"><a class=\"anchor\" href=\"#linux-简介\">#</a> <a href=\"#linux-%E7%AE%80%E4%BB%8B\">Linux 简介</a></h3>\n<p>通过以下三点可以概括 Linux 到底是什么：</p>\n<ul>\n<li><strong>类 Unix 系统</strong>：Linux 是一种自由、开放源码的类似 Unix 的操作系统</li>\n<li><strong>Linux 本质是指 Linux 内核</strong>：严格来讲，Linux 这个词本身只表示 Linux 内核，单独的 Linux 内核并不能成为一个可以正常工作的操作系统。所以，就有了各种 Linux 发行版。</li>\n<li><strong>Linux 之父 (林纳斯・本纳第克特・托瓦兹 Linus Benedict Torvalds)</strong>：一个编程领域的传奇式人物，真大佬！我辈崇拜敬仰之楷模。他是 <strong>Linux 内核</strong> 的最早作者，随后发起了这个开源项目，担任 Linux 内核的首要架构师。他还发起了 Git 这个开源项目，并为主要的开发者。</li>\n</ul>\n<h2 id=\"linux文件系统\"><a class=\"anchor\" href=\"#linux文件系统\">#</a> Linux 文件系统</h2>\n<h3 id=\"linux文件系统简介\"><a class=\"anchor\" href=\"#linux文件系统简介\">#</a> <a href=\"#Linux%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E7%AE%80%E4%BB%8B\">Linux 文件系统简介</a></h3>\n<p>在 Linux 操作系统中，一切被操作系统管理的资源，如网络接口卡、磁盘驱动器、打印机、输入输出设备、普通文件或目录等，都被视为文件。这是 Linux 系统中一个重要的概念，即 &quot;一切都是文件&quot;。</p>\n<p>这种概念源自 UNIX 哲学，即将所有资源都抽象为文件的方式来进行管理和访问。Linux 的文件系统也借鉴了 UNIX 文件系统的设计理念。这种设计使得 Linux 系统可以通过统一的文件接口来管理和操作不同类型的资源，从而实现了一种统一的文件操作方式。例如，可以使用类似于读写文件的方式来对待网络接口、磁盘驱动器、设备文件等，使得操作和管理这些资源更加统一和简便。</p>\n<p>这种文件为中心的设计理念为 Linux 系统带来了灵活性和可扩展性，使得 Linux 成为一种强大的操作系统。同时，这也是 Linux 系统的一大特点，深受广大用户和开发者的喜欢和推崇。</p>\n<h3 id=\"inode-介绍\"><a class=\"anchor\" href=\"#inode-介绍\">#</a> <a href=\"#inode-%E4%BB%8B%E7%BB%8D\">inode 介绍</a></h3>\n<p>inode 是 Linux/Unix 文件系统的基础。那 inode 到是什么？有什么作用呢？</p>\n<p>通过以下五点可以概括 inode 到底是什么：</p>\n<p>硬盘的最小存储单位是扇区 (Sector)，块 (block) 由多个扇区组成。文件数据存储在块中。块的最常见的大小是 4kb，约为 8 个连续的扇区组成（每个扇区存储 512 字节）。一个文件可能会占用多个 block，但是一个块只能存放一个文件。虽然，我们将文件存储在了块 (block) 中，但是我们还需要一个空间来存储文件的 元信息 metadata：如某个文件被分成几块、每一块在的地址、文件拥有者，创建时间，权限，大小等。这种 存储文件元信息的区域就叫 inode，译为索引节点：i（index）+node。 每个文件都有一个唯一的 inode，存储文件的元信息。<br />\ninode 是一种固定大小的数据结构，其大小在文件系统创建时就确定了，并且在文件的生命周期内保持不变。<br />\ninode 的访问速度非常快，因为系统可以直接通过 inode 号码定位到文件的元数据信息，无需遍历整个文件系统。<br />\ninode 的数量是有限的，每个文件系统只能包含固定数量的 inode。这意味着当文件系统中的 inode 用完时，无法再创建新的文件或目录，即使磁盘上还有可用空间。因此，在创建文件系统时，需要根据文件和目录的预期数量来合理分配 inode 的数量。<br />\n可以使用 stat 命令可以查看文件的 inode 信息，包括文件的 inode 号、文件类型、权限、所有者、文件大小、修改时间。<br />\n简单来说：inode 就是用来维护某个文件被分成几块、每一块在的地址、文件拥有者，创建时间，权限，大小等信息。</p>\n<p>再总结一下 inode 和 block：</p>\n<p>inode：记录文件的属性信息，可以使用 stat 命令查看 inode 信息。<br />\nblock：实际文件的内容，如果一个文件大于一个块时候，那么将占用多个 block，但是一个块只能存放一个文件。（因为数据是由 inode 指向的，如果有两个文件的数据存放在同一个块中，就会乱套了）</p>\n<h3 id=\"硬链接和软链接\"><a class=\"anchor\" href=\"#硬链接和软链接\">#</a> 硬链接和软链接</h3>\n<p>在 Linux / 类 Unix 系统上，文件链接（File Link）是一种特殊的文件类型，可以在文件系统中指向另一个文件。常见的文件链接类型有两种：</p>\n<p><strong>1、硬链接（Hard Link）</strong></p>\n<ul>\n<li>在 Linux / 类 Unix 文件系统中，每个文件和目录都有一个唯一的索引节点（inode）号，用来标识该文件或目录。硬链接通过 inode 节点号建立连接，硬链接和源文件的 inode 节点号相同，两者对文件系统来说是完全平等的（可以看作是互为硬链接，源头是同一份文件），删除其中任何一个对另外一个没有影响，可以通过给文件设置硬链接文件来防止重要文件被误删。</li>\n<li>只有删除了源文件和所有对应的硬链接文件，该文件才会被真正删除。</li>\n<li>硬链接具有一些限制，不能对目录以及不存在的文件创建硬链接，并且，硬链接也不能跨越文件系统。</li>\n<li><code>ln</code>  命令用于创建硬链接。</li>\n</ul>\n<p><strong>2、软链接（Symbolic Link 或 Symlink）</strong></p>\n<ul>\n<li>软链接和源文件的 inode 节点号不同，而是指向一个文件路径。</li>\n<li>源文件删除后，软链接依然存在，但是指向的是一个无效的文件路径。</li>\n<li>软连接类似于 Windows 系统中的快捷方式。</li>\n<li>不同于硬链接，可以对目录或者不存在的文件创建软链接，并且，软链接可以跨越文件系统。</li>\n<li><code>ln -s</code>  命令用于创建软链接。</li>\n</ul>\n<p><strong>硬链接为什么不能跨文件系统？</strong></p>\n<p>我们之前提到过，硬链接是通过 inode 节点号建立连接的，而硬链接和源文件共享相同的 inode 节点号。</p>\n<p>然而，每个文件系统都有自己的独立 inode 表，且每个 inode 表只维护该文件系统内的 inode。如果在不同的文件系统之间创建硬链接，可能会导致 inode 节点号冲突的问题，即目标文件的 inode 节点号已经在该文件系统中被使用。</p>\n<h3 id=\"linux-文件类型\"><a class=\"anchor\" href=\"#linux-文件类型\">#</a> <a href=\"#linux-%E6%96%87%E4%BB%B6%E7%B1%BB%E5%9E%8B\">Linux 文件类型</a></h3>\n<p>Linux 支持很多文件类型，其中非常重要的文件类型有: <strong>普通文件</strong>，<strong>目录文件</strong>，<strong>链接文件</strong>，<strong>设备文件</strong>，<strong>管道文件</strong>，<strong>Socket 套接字文件</strong> 等。</p>\n<ul>\n<li><strong>普通文件（-）</strong>：用于存储信息和数据， Linux 用户可以根据访问权限对普通文件进行查看、更改和删除。比如：图片、声音、PDF、text、视频、源代码等等。</li>\n<li><strong>目录文件（d，directory file）</strong>：目录也是文件的一种，用于表示和管理系统中的文件，目录文件中包含一些文件名和子目录名。打开目录事实上就是打开目录文件。</li>\n<li><strong>符号链接文件（l，symbolic link）</strong>：保留了指向文件的地址而不是文件本身。</li>\n<li><strong>字符设备（c，char）</strong>：用来访问字符设备比如键盘。</li>\n<li><strong>设备文件（b，block）</strong>：用来访问块设备比如硬盘、软盘。</li>\n<li><strong>管道文件 (p，pipe)</strong> : 一种特殊类型的文件，用于进程之间的通信。</li>\n<li><strong>套接字文件 (s，socket)</strong>：用于进程间的网络通信，也可以用于本机之间的非网络通信。</li>\n</ul>\n<p>每种文件类型都有不同的用途和属性，可以通过命令如 <code>ls</code> 、 <code>file</code>  等来查看文件的类型信息。</p>\n<p><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 普通文件（-）</span></span><br><span class=\"line\">-rw-r--r--  1 user  group  1024 Apr 14 10:00 file.txt</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 目录文件（d，directory file）*</span></span><br><span class=\"line\">drwxr-xr-x  2 user  group  4096 Apr 14 10:00 directory/</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 套接字文件(s，socket)</span></span><br><span class=\"line\">srwxrwxrwx  1 user  group    0 Apr 14 10:00 socket</span><br></pre></td></tr></table></figure></p>\n<h3 id=\"linux目录树\"><a class=\"anchor\" href=\"#linux目录树\">#</a> Linux 目录树</h3>\n<p>Linux 使用一种称为目录树的层次结构来组织文件和目录。目录树由根目录（/）作为起始点，向下延伸，形成一系列的目录和子目录。每个目录可以包含文件和其他子目录。结构层次鲜明，就像一棵倒立的树。</p>\n<p><img data-src=\"https://dlink.host/wx4.sinaimg.cn/large/006V2BDqly8htd953kl4fj30mv08rt9b.jpg\" alt=\"alt\" /></p>\n<p><strong>常见目录说明：</strong></p>\n<ul>\n<li><strong>/bin：</strong> 存放二进制可执行文件 (ls、cat、mkdir 等)，常用命令一般都在这里；</li>\n<li><strong>/etc：</strong> 存放系统管理和配置文件；</li>\n<li><strong>/home：</strong> 存放所有用户文件的根目录，是用户主目录的基点，比如用户 user 的主目录就是 /home/user，可以用～user 表示；</li>\n<li><strong>/usr：</strong> 用于存放系统应用程序；</li>\n<li><strong>/opt：</strong> 额外安装的可选应用程序包所放置的位置。一般情况下，我们可以把 tomcat 等都安装到这里；</li>\n<li><strong>/proc：</strong> 虚拟文件系统目录，是系统内存的映射。可直接访问这个目录来获取系统信息；</li>\n<li><strong>/root：</strong> 超级用户（系统管理员）的主目录（特权阶级<sup> o</sup>）；</li>\n<li><strong>/sbin:</strong> 存放二进制可执行文件，只有 root 才能访问。这里存放的是系统管理员使用的系统级别的管理命令和程序。如 ifconfig 等；</li>\n<li><strong>/dev：</strong> 用于存放设备文件；</li>\n<li><strong>/mnt：</strong> 系统管理员安装临时文件系统的安装点，系统提供这个目录是让用户临时挂载其他的文件系统；</li>\n<li><strong>/boot：</strong> 存放用于系统引导时使用的各种文件；</li>\n<li><strong>/lib 和 /lib64：</strong> 存放着和系统运行相关的库文件 ；</li>\n<li><strong>/tmp：</strong> 用于存放各种临时文件，是公用的临时文件存储点；</li>\n<li><strong>/var：</strong> 用于存放运行时需要改变数据的文件，也是某些大文件的溢出区，比方说各种服务的日志文件（系统启动日志等。）等；</li>\n<li><strong>/lost+found：</strong> 这个目录平时是空的，系统非正常关机而留下 “无家可归” 的文件（windows 下叫什么.chk）就在这里。</li>\n</ul>\n<h2 id=\"linux常用命令\"><a class=\"anchor\" href=\"#linux常用命令\">#</a> Linux 常用命令</h2>\n<p>下面只是给出了一些比较常用的命令。</p>\n<p>推荐一个 Linux 命令快查网站，非常不错，大家如果遗忘某些命令或者对某些命令不理解都可以在这里得到解决。Linux 命令在线速查手册：<span class=\"exturl\" data-url=\"aHR0cHM6Ly93YW5nY2h1amlhbmcuY29tL2xpbnV4LWNvbW1hbmQv\">https://wangchujiang.com/linux-command/open in new window</span> 。</p>\n<p>另外，<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuc2hlbGwuaG93Lw==\">shell.howopen in new window</span> 这个网站可以用来解释常见命令的意思，对你学习 Linux 基本命令以及其他常用命令（如 Git、NPM）。</p>\n<h3 id=\"目录切换\"><a class=\"anchor\" href=\"#目录切换\">#</a> 目录切换</h3>\n<ul>\n<li><code>cd usr</code> ：切换到该目录下 usr 目录</li>\n<li><code>cd ..（或cd../）</code> ：切换到上一层目录</li>\n<li><code>cd /</code> ：切换到系统根目录</li>\n<li><code>cd ~</code> ：切换到用户主目录</li>\n<li><code>cd -</code> ： 切换到上一个操作所在目录</li>\n</ul>\n<h3 id=\"目录操作\"><a class=\"anchor\" href=\"#目录操作\">#</a> 目录操作</h3>\n<ul>\n<li>\n<p>```ls <code>：显示目录中的文件和子目录的列表。例如：</code> ls /home <code>，显示</code>  /home `` 目录下的文件和子目录列表。</p>\n</li>\n<li>\n<p><code>ll</code> ： <code>ll</code>  是 <code> ls -l</code>  的别名， <code>ll </code> 命令可以看到该目录下的所有目录和文件的详细信息</p>\n</li>\n<li>\n<p><code>mkdir [选项] 目录名</code> ：创建新目录（增）。例如： <code>mkdir -m 755 my_directory</code> ，创建一个名为  <code>my_directory </code> 的新目录，并将其权限设置为 <code> 755</code> ，即所有用户对该目录有读、写和执行的权限。</p>\n</li>\n<li>\n<p><code>find [路径] [表达式]</code> ：在指定目录及其子目录中搜索文件或目录（查），非常强大灵活。例如：① 列出当前目录及子目录下所有文件和文件夹: <code>find</code> .；② 在 <code>/home</code>  目录下查找以 <code>.txt</code>  结尾的文件名: <code>find /home -name &quot;*.txt&quot;</code>  , 忽略大小写: <code>find /home -i name &quot;*.txt&quot; </code> ；③ 当前目录及子目录下查找所有以 <code>.txt</code>  和 <code>.pdf</code>  结尾的文件: <code>find . \\( -name &quot;*.txt&quot; -o -name &quot;*.pdf&quot; \\)</code>  或 <code>find . -name &quot;*.txt&quot; -o -name &quot;*.pdf&quot;</code> 。</p>\n</li>\n<li>\n<p><code>pwd</code> ：显示当前工作目录的路径。</p>\n</li>\n<li>\n<p><code>rmdir [选项] 目录名</code> ：删除空目录（删）。例如： <code>rmdir -p my_directory</code> ，删除名为  <code>my_directory </code> 的空目录，并且会递归删除 <code>my_directory</code>  的空父目录，直到遇到非空目录或根目录。</p>\n</li>\n<li>\n<p><code>rm [选项] 文件或目录名</code> ：删除文件 / 目录（删）。例如： <code>rm -r my_directory</code> ，删除名为  <code>my_directory</code>  的目录， <code>-r</code>  (recursive, 递归) 表示会递归删除指定目录及其所有子目录和文件。</p>\n</li>\n<li>\n<p><code>cp [选项] 源文件/目录 目标文件/目录</code> ：复制文件或目录（移）。例如： <code>cp file.txt /home/file.txt</code> ，将  <code>file.txt </code> 文件复制到 <code>/home</code>  目录下，并重命名为  <code>file.txt</code> 。 <code>cp -r source destination</code> ，将  <code>source</code>  目录及其下的所有子目录和文件复制到  <code>destination </code> 目录下，并保留源文件的属性和目录结构。</p>\n</li>\n<li>\n<p><code>mv [选项] 源文件/目录 目标文件/目录</code> ：移动文件或目录（移），也可以用于重命名文件或目录。例如： <code>mv file.txt /home/file.txt</code> ，将  <code>file.txt</code>  文件移动到 <code>/home</code>  目录下，并重命名为 <code> file.txt</code> 。 <code>mv </code> 与  <code>cp </code> 的结果不同， <code>mv</code>  好像文件 “搬家”，文件个数并未增加。而  <code>cp </code> 对文件进行复制，文件个数增加了。</p>\n</li>\n</ul>\n<h3 id=\"文件操作\"><a class=\"anchor\" href=\"#文件操作\">#</a> 文件操作</h3>\n<p>像  <code>mv</code> 、 <code>cp</code> 、 <code>rm</code>  等文件和目录都适用的命令，这里就不重复列举了。</p>\n<ul>\n<li><code>touch [选项] 文件名..</code> ：创建新文件或更新已存在文件（增）。例如： <code>touch file1.txt file2.txt file3.txt </code> ，创建 3 个文件。</li>\n<li><code>ln [选项] &lt;源文件&gt; &lt;硬链接/软链接文件&gt;</code> ：创建硬链接 / 软链接。例如： <code>ln -s file.txt file_link</code> ，创建名为 <code> file_link</code>  的软链接，指向  <code>file.txt</code>  文件。 <code>-s</code>  选项代表的就是创建软链接， <code>s </code> 即 <code> symbolic</code> （软链接又名符号链接） 。</li>\n<li><code>cat/more/less/tail 文件名</code> ：文件的查看（查） 。命令 <code>tail -f</code>  文件 可以对某个文件进行动态监控，例如 Tomcat 的日志文件， 会随着程序的运行，日志会变化，可以使用 <code>tail -f catalina-2016-11-11.log</code>  监控文件的变化 。</li>\n<li><code>vim 文件名</code> ：修改文件的内容（改）。 <code>vim</code>  编辑器是 <code> Linux</code>  中的强大组件，是  <code>vi</code>  编辑器的加强版， <code>vim</code>  编辑器的命令和快捷方式有很多，但此处不一一阐述，大家也无需研究的很透彻，使用 <code>vim</code>  编辑修改文件的方式基本会使用就可以了。在实际开发中，使用 <code>vim</code>  编辑器主要作用就是修改配置文件，下面是一般步骤： <code>vim 文件------&gt;进入文件-----&gt;命令模式------&gt;按i进入编辑模式-----&gt;编辑文件 -------&gt;按Esc进入底行模式-----&gt;输入：wq/q! （</code> 输入 wq 代表写入内容并退出，即保存；输入 q! 代表强制退出不保存）。</li>\n</ul>\n<h3 id=\"文件压缩\"><a class=\"anchor\" href=\"#文件压缩\">#</a> 文件压缩</h3>\n<h4 id=\"1打包并压缩文件\"><a class=\"anchor\" href=\"#1打包并压缩文件\">#</a> 1）打包并压缩文件：</h4>\n<p>Linux 中的打包文件一般是以 <code>.tar</code>  结尾的，压缩的命令一般是以 <code> .gz</code>  结尾的。而一般情况下打包和压缩是一起进行的，打包并压缩后的文件的后缀名一般  <code>.tar.gz</code> 。</p>\n<p>命令： <code>tar -zcvf </code> 打包压缩后的文件名 要打包压缩的文件 ，其中：</p>\n<ul>\n<li>\n<p>z：调用 gzip 压缩命令进行压缩</p>\n</li>\n<li>\n<p>c：打包文件</p>\n</li>\n<li>\n<p>v：显示运行过程</p>\n</li>\n<li>\n<p>f：指定文件名</p>\n</li>\n</ul>\n<p>比如：假如 test 目录下有三个文件分别是： <code>aaa.txt</code> 、 <code> bbb.txt</code> 、 <code>ccc.txt</code> ，如果我们要打包 <code>test</code>  目录并指定压缩后的压缩包名称为 <code>test.tar.gz</code>  可以使用命令： <code>tar -zcvf test.tar.gz aaa.txt bbb.txt ccc.txt </code> 或  <code>tar -zcvf test.tar.gz /test/</code>  。</p>\n<h4 id=\"2解压压缩包\"><a class=\"anchor\" href=\"#2解压压缩包\">#</a> 2）解压压缩包：</h4>\n<p>命令： <code>tar [-xvf] 压缩文件</code></p>\n<p>其中 x 代表解压</p>\n<p>示例：</p>\n<ul>\n<li>\n<p>将 /test 下的  <code>test.tar.gz</code>  解压到当前目录下可以使用命令： <code>tar -xvf test.tar.gz</code></p>\n</li>\n<li>\n<p>将 /test 下的 <code>test.tar.gz</code>  解压到根目录 /usr 下: <code>tar -xvf test.tar.gz -C /usr</code> （-C 代表指定解压的位置）</p>\n</li>\n</ul>\n<h3 id=\"文件传输\"><a class=\"anchor\" href=\"#文件传输\">#</a> 文件传输</h3>\n<ul>\n<li><code>scp [选项] 源文件 远程文件 </code> （scp 即 secure copy，安全复制）：用于通过 SSH 协议进行安全的文件传输，可以实现从本地到远程主机的上传和从远程主机到本地的下载。例如： <code>scp -r my_directoryuser@remote:/home/user</code>  ，将本地目录 <code>my_directory</code>  上传到远程服务器  <code>/home/user </code> 目录下。 <code>scp -r user@remote:/home/user/my_directory </code> ，将远程服务器的 <code>/home/user</code>  目录下的 <code>my_directory</code>  目录下载到本地。需要注意的是， <code>scp</code>  命令需要在本地和远程系统之间建立 SSH 连接进行文件传输，因此需要确保远程服务器已经配置了 SSH 服务，并且具有正确的权限和认证方式。</li>\n<li><code>rsync [选项] 源文件 远程文件</code> ：可以在本地和远程系统之间高效地进行文件复制，并且能够智能地处理增量复制，节省带宽和时间。例如： <code>rsync -r my_directory user@remote:/home/user</code> ，将本地目录 <code>my_directory</code>  上传到远程服务器 <code>/home/user</code>  目录下。</li>\n<li><code>ftp </code> (File Transfer Protocol)：提供了一种简单的方式来连接到远程 FTP 服务器并进行文件上传、下载、删除等操作。使用之前需要先连接登录远程 FTP 服务器，进入 FTP 命令行界面后，可以使用 <code> put</code>  命令将本地文件上传到远程主机，可以使用 <code>get</code>  命令将远程主机的文件下载到本地，可以使用 <code> delete</code>  命令删除远程主机的文件。这里就不进行演示了。</li>\n</ul>\n<h3 id=\"文件权限\"><a class=\"anchor\" href=\"#文件权限\">#</a> 文件权限</h3>\n<p>操作系统中每个文件都拥有特定的权限、所属用户和所属组。权限是操作系统用来限制资源访问的机制，在 Linux 中权限一般分为读 (readable)、写 (writable) 和执行 (executable)，分为三组。分别对应文件的属主 (owner)，属组 (group) 和其他用户 (other)，通过这样的机制来限制哪些用户、哪些组可以对特定的文件进行什么样的操作。</p>\n<p>通过 <code>ls -l</code>  命令我们可以 查看某个目录下的文件或目录的权限</p>\n<p>示例：在随意某个目录下 <code>ls -l</code></p>\n<p><img data-src=\"https://dlink.host/wx1.sinaimg.cn/large/006V2BDqly8htd9kj4jqcj30gd06cjsj.jpg\" alt=\"\" /></p>\n<p><img data-src=\"https://dlink.host/wx1.sinaimg.cn/large/006V2BDqly8htd9kjwbjxj30dl05tweo.jpg\" alt=\"\" /></p>\n<p>下面将详细讲解文件的类型、Linux 中权限以及文件有所有者、所在组、其它组具体是什么？</p>\n<p><strong>文件的类型：</strong></p>\n<ul>\n<li>\n<p>d：代表目录</p>\n</li>\n<li>\n<p>-：代表文件</p>\n</li>\n<li>\n<p>l：代表软链接（可以认为是 window 中的快捷方式）</p>\n</li>\n</ul>\n<p><strong>Linux 中权限分为以下几种：</strong></p>\n<ul>\n<li>\n<p>r：代表权限是可读，r 也可以用数字 4 表示</p>\n</li>\n<li>\n<p>w：代表权限是可写，w 也可以用数字 2 表示</p>\n</li>\n<li>\n<p>x：代表权限是可执行，x 也可以用数字 1 表示</p>\n</li>\n</ul>\n<p><strong>文件和目录权限的区别：</strong></p>\n<p>对文件和目录而言，读写执行表示不同的意义。</p>\n<p>对于文件：</p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">权限名称</th>\n<th style=\"text-align:right\">可执行操作</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">r</td>\n<td style=\"text-align:right\">可以使用 cat 查看文件的内容</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">w</td>\n<td style=\"text-align:right\">可以修改文件的内容</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">x</td>\n<td style=\"text-align:right\">可以将其运行为二进制文件</td>\n</tr>\n</tbody>\n</table>\n<p>对于目录：</p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">权限名称</th>\n<th style=\"text-align:right\">可执行操作</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">r</td>\n<td style=\"text-align:right\">可以查看目录下列表</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">w</td>\n<td style=\"text-align:right\">可以创建和删除目录下文件</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">x</td>\n<td style=\"text-align:right\">可以使用 cd 进入目录</td>\n</tr>\n</tbody>\n</table>\n<p>需要注意的是：<strong>超级用户可以无视普通用户的权限，即使文件目录权限是 000，依旧可以访问。</strong></p>\n<p><strong>在 linux 中的每个用户必须属于一个组，不能独立于组外。在 linux 中每个文件有所有者、所在组、其它组的概念。</strong></p>\n<ul>\n<li>所有者 (u)：一般为文件的创建者，谁创建了该文件，就天然的成为该文件的所有者，用 ls ‐ahl 命令可以看到文件的所有者 也可以使用 chown 用户名 文件名来修改文件的所有者 。</li>\n<li>文件所在组 (g)：当某个用户创建了一个文件后，这个文件的所在组就是该用户所在的组用 ls ‐ahl 命令可以看到文件的所有组也可以使用 chgrp 组名 文件名来修改文件所在的组。</li>\n<li>其它组 (o)：除开文件的所有者和所在组的用户外，系统的其它用户都是文件的其它组。</li>\n</ul>\n<p>我们再来看看如何修改文件 / 目录的权限。</p>\n<p><strong>修改文件 / 目录的权限的命令： <code>chmod</code> </strong></p>\n<p>示例：修改 <code>/test </code> 下的  <code>aaa.txt</code>  的权限为文件所有者有全部权限，文件所有者所在的组有读写权限，其他用户只有读的权限。</p>\n<p><code>chmod u=rwx,g=rw,o=r aaa.txt </code> 或者  <code>chmod 764 aaa.txt</code></p>\n<p><strong>补充一个比较常用的东西:</strong></p>\n<p>假如我们装了一个 zookeeper，我们每次开机到要求其自动启动该怎么办？</p>\n<ol>\n<li>\n<p>新建一个脚本 zookeeper</p>\n</li>\n<li>\n<p>为新建的脚本 zookeeper 添加可执行权限，命令是:chmod +x zookeeper</p>\n</li>\n<li>\n<p>把 zookeeper 这个脚本添加到开机启动项里面，命令是：chkconfig --add zookeeper</p>\n</li>\n<li>\n<p>如果想看看是否添加成功，命令是：chkconfig --list</p>\n</li>\n</ol>\n<h3 id=\"用户管理\"><a class=\"anchor\" href=\"#用户管理\">#</a> 用户管理</h3>\n<p>Linux 系统是一个多用户多任务的分时操作系统，任何一个要使用系统资源的用户，都必须首先向系统管理员申请一个账号，然后以这个账号的身份进入系统。</p>\n<p>用户的账号一方面可以帮助系统管理员对使用系统的用户进行跟踪，并控制他们对系统资源的访问；另一方面也可以帮助用户组织文件，并为用户提供安全性保护。</p>\n<p><strong>Linux 用户管理相关命令:</strong></p>\n<ul>\n<li><code>useradd [选项] 用户名</code> ：创建用户账号。使用 <code>useradd</code>  指令所建立的帐号，实际上是保存在  <code>/etc/passwd</code>  文本文件中。</li>\n<li><code>userdel [选项] 用户名</code> ：删除用户帐号。</li>\n<li><code>usermod [选项] 用户名</code> ：修改用户账号的属性和配置比如用户名、用户 ID、家目录。</li>\n<li><code>passwd [选项] 用户名</code> ：设置用户的认证信息，包括用户密码、密码过期时间等。。例如： <code>passwd -S 用户名</code>  ，显示用户账号密码信息。 <code>passwd -d 用户名</code> ：清除用户密码，会导致用户无法登录。 <code>passwd 用户名</code> ，修改用户密码，随后系统会提示输入新密码并确认密码。</li>\n<li><code>su [选项] 用户名</code> （su 即 Switch User，切换用户）：在当前登录的用户和其他用户之间切换身份。</li>\n</ul>\n<h3 id=\"用户组管理\"><a class=\"anchor\" href=\"#用户组管理\">#</a> 用户组管理</h3>\n<p>每个用户都有一个用户组，系统可以对一个用户组中的所有用户进行集中管理。不同 Linux 系统对用户组的规定有所不同，如 Linux 下的用户属于与它同名的用户组，这个用户组在创建用户时同时创建。</p>\n<p>用户组的管理涉及用户组的添加、删除和修改。组的增加、删除和修改实际上就是对 <code>/etc/group</code>  文件的更新。</p>\n<p><strong>Linux 系统用户组的管理相关命令:</strong></p>\n<ul>\n<li>groupadd [选项] 用户组：增加一个新的用户组。</li>\n<li>groupdel 用户组：要删除一个已有的用户组。</li>\n<li>groupmod [选项] 用户组：修改用户组的属性。</li>\n</ul>\n<h3 id=\"系统状态\"><a class=\"anchor\" href=\"#系统状态\">#</a> 系统状态</h3>\n<ul>\n<li><code>top [选项]</code> ：用于实时查看系统的 CPU 使用率、内存使用率、进程信息等。</li>\n<li><code>htop [选项]</code> ：类似于 <code> top</code> ，但提供了更加交互式和友好的界面，可让用户交互式操作，支持颜色主题，可横向或纵向滚动浏览进程列表，并支持鼠标操作。</li>\n<li><code>uptime [选项]</code> ：用于查看系统总共运行了多长时间、系统的平均负载等信息。</li>\n<li><code>vmstat [间隔时间] [重复次数]</code> ：vmstat （Virtual Memory Statistics） 的含义为显示虚拟内存状态，但是它可以报告关于进程、内存、I/O 等系统整体运行状态。</li>\n<li><code>free [选项]</code> ：用于查看系统的内存使用情况，包括已用内存、可用内存、缓冲区和缓存等。</li>\n<li><code>df [选项] [文件系统]</code> ：用于查看系统的磁盘空间使用情况，包括磁盘空间的总量、已使用量和可用量等，可以指定文件系统上。例如： <code>df -a</code> ，查看全部文件系统。</li>\n<li><code>du [选项] [文件]</code> ：用于查看指定目录或文件的磁盘空间使用情况，可以指定不同的选项来控制输出格式和单位。</li>\n<li><code>sar [选项] [时间间隔] [重复次数]</code> ：用于收集、报告和分析系统的性能统计信息，包括系统的 CPU 使用、内存使用、磁盘 I/O、网络活动等详细信息。它的特点是可以连续对系统取样，获得大量的取样数据。取样数据和分析的结果都可以存入文件，使用它时消耗的系统资源很小。</li>\n<li><code>ps [选项]</code> ：用于查看系统中的进程信息，包括进程的 ID、状态、资源使用情况等。 <code>ps -ef</code> / <code>ps -aux</code> ：这两个命令都是查看当前系统正在运行进程，两者的区别是展示格式不同。如果想要查看特定的进程可以使用这样的格式： <code>ps aux|grep redis </code> （查看包括 redis 字符串的进程），也可使用  <code>pgrep redis -a</code> 。</li>\n<li><code>systemctl [命令] [服务名称]</code> ：用于管理系统的服务和单元，可以查看系统服务的状态、启动、停止、重启等。</li>\n</ul>\n<h3 id=\"网络通信\"><a class=\"anchor\" href=\"#网络通信\">#</a> 网络通信</h3>\n<ul>\n<li><code>ping [选项] 目标主机</code> ：测试与目标主机的网络连接。</li>\n<li><code>ifconfig </code> 或  <code>ip</code> ：用于查看系统的网络接口信息，包括网络接口的 IP 地址、MAC 地址、状态等。</li>\n<li><code>netstat [选项]</code> ：用于查看系统的网络连接状态和网络统计信息，可以查看当前的网络连接情况、监听端口、网络协议等。</li>\n<li><code>ss [选项]</code> ：比 netstat 更好用，提供了更快速、更详细的网络连接信息。</li>\n</ul>\n<h3 id=\"其他\"><a class=\"anchor\" href=\"#其他\">#</a> 其他</h3>\n<ul>\n<li><code>sudo + 其他命令</code> ：以系统管理者的身份执行指令，也就是说，经由 sudo 所执行的指令就好像是 root 亲自执行。</li>\n<li><code>grep 要搜索的字符串 要搜索的文件 --color</code> ：搜索命令， <code>--color </code> 代表高亮显示。</li>\n<li><code>kill -9 进程的pid</code> ：杀死进程（-9 表示强制终止）先用 ps 查找进程，然后用 kill 杀掉。</li>\n<li><code>shutdown</code> ： <code>shutdown -h now</code> ：指定现在立即关机； <code>shutdown +5 &quot;System will shutdown after 5 minutes&quot;</code> ：指定 5 分钟后关机，同时送出警告信息给登入用户。</li>\n<li><code>reboot</code> ： <code>reboot</code> ：重开机。 <code>reboot -w</code> ：做个重开机的模拟（只有纪录并不会真的重开机）。</li>\n</ul>\n<h2 id=\"linux-环境变量\"><a class=\"anchor\" href=\"#linux-环境变量\">#</a> Linux 环境变量</h2>\n<p>在 Linux 系统中，环境变量是用来定义系统运行环境的一些参数，比如每个用户不同的主目录（HOME）。</p>\n<h4 id=\"环境变量分类\"><a class=\"anchor\" href=\"#环境变量分类\">#</a> 环境变量分类</h4>\n<p>按照作用域来分，环境变量可以简单的分成:</p>\n<ul>\n<li>\n<p>用户级别环境变量 :  <code>~/.bashrc</code> 、 <code>~/.bash_profile</code> 。</p>\n</li>\n<li>\n<p>系统级别环境变量 : <code> /etc/bashrc</code> 、 <code>/etc/environment</code> 、 <code>/etc/profile</code> 、 <code>/etc/profile.d</code> 。</p>\n</li>\n</ul>\n<p>上述配置文件执行先后顺序为： <code>/etc/environment </code> –&gt;  <code>/etc/profile </code> –&gt; <code>/etc/profile.d</code> –&gt;  <code>~/.bash_profile</code>  –&gt;  <code>/etc/bashrc </code> –&gt;  <code>~/.bashrc</code></p>\n<p>如果要修改系统级别环境变量文件，需要管理员具备对该文件的写入权限。</p>\n<p>建议用户级别环境变量在  <code>~/.bash_profile</code>  中配置，系统级别环境变量在 <code> /etc/profile.d</code>  中配置。</p>\n<p>按照生命周期来分，环境变量可以简单的分成:</p>\n<ul>\n<li>\n<p>永久的：需要用户修改相关的配置文件，变量永久生效。</p>\n</li>\n<li>\n<p>临时的：用户利用 export 命令，在当前终端下声明环境变量，关闭 shell 终端失效。</p>\n</li>\n</ul>\n<h3 id=\"读取环境变量\"><a class=\"anchor\" href=\"#读取环境变量\">#</a> 读取环境变量</h3>\n<p>通过 <code> export</code>  命令可以输出当前系统定义的所有环境变量。</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 列出当前的环境变量值</span><br><span class=\"line\"></span><br><span class=\"line\">export -p</span><br></pre></td></tr></table></figure></p>\n<p>除了  <code>export</code>  命令之外，  <code>env </code> 命令也可以列出所有环境变量。</p>\n<p><code>echo</code>  命令可以输出指定环境变量的值。</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 输出当前的PATH环境变量的值</span><br><span class=\"line\"></span><br><span class=\"line\">echo $PATH</span><br><span class=\"line\"></span><br><span class=\"line\"># 输出当前的HOME环境变量的值</span><br><span class=\"line\"></span><br><span class=\"line\">echo $HOME</span><br></pre></td></tr></table></figure></p>\n<h3 id=\"环境变量修改\"><a class=\"anchor\" href=\"#环境变量修改\">#</a> 环境变量修改</h3>\n<p>通过 <code> export</code>  命令可以修改指定的环境变量。不过，这种方式修改环境变量仅仅对当前 shell 终端生效，关闭 shell 终端就会失效。修改完成之后，立即生效。</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">export CLASSPATH=./JAVA_HOME/lib;$JAVA_HOME/jre/lib</span><br></pre></td></tr></table></figure></p>\n<p>通过  <code>vim </code> 命令修改环境变量配置文件。这种方式修改环境变量永久有效。</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim ~/.bash_profile</span><br></pre></td></tr></table></figure></p>\n<p>如果修改的是系统级别环境变量则对所有用户生效，如果修改的是用户级别环境变量则仅对当前用户生效。</p>\n<p>修改完成之后，需要  <code>source</code>  命令让其生效或者关闭 shell 终端重新登录。</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">source /etc/profile</span><br></pre></td></tr></table></figure></p>\n",
            "tags": [
                "linux",
                "linux"
            ]
        },
        {
            "id": "http://example.com/2024/10/16/post/job/06-%E7%8F%A0%E5%95%A4%E5%BC%80%E5%8F%91%E4%BB%BB%E5%8A%A1%E5%B0%8F%E8%AE%B0/",
            "url": "http://example.com/2024/10/16/post/job/06-%E7%8F%A0%E5%95%A4%E5%BC%80%E5%8F%91%E4%BB%BB%E5%8A%A1%E5%B0%8F%E8%AE%B0/",
            "title": "06-珠啤开发任务小记",
            "date_published": "2024-10-16T11:37:02.126Z",
            "content_html": "<div class=\"hbe hbe-container\" id=\"hexo-blog-encrypt\" data-wpm=\"抱歉，这个密码看着不太对，请再试试。\" data-whm=\"抱歉，这个文章不能被校验，不过您还是能看看解密后的内容。\">\n  <script id=\"hbeData\" type=\"hbeData\" data-hmacdigest=\"0529bdd4b3123377f1f47c2ab571e5061161e5289693eaf2e530064d73767150\">2c43a34c906e7926d65a40b8b08e3a789ece16853979b723871f651d33396ff5f047035ee28253b9ecd9883de9dda87ed2b89d29b34a5e6168f682ea9998ad8cb2171a5058cfd62e2170c84a3e39c077cf399b787a0c6df6d93399999afcb7b810a0fd135b3a9361c41f487992132032826502c4cd80678633528e69090015d339f1c9a1cd12dfbde056b03a15d5433f66225e998396fba1fd9ef3ef6d13beb19f3c47025d63e9461e23576c20986d69806d67a49487ee2269549ce73127d343191b5820d23b4f8139f6669c1759c5ec0e1b1ac2c86179e102ee523e0bed9671b07987b629604de771e878e9489b62a37b92691a5e703f4c7fed81195c72e6bc09503d464f6e6909dfbdbf5177843f297ed7aceab5cf4578c2543f1e9aad873fedf8c10831c5f95623eaa1e7c18ae90f6b7bc443aca9e912fc39225b3c82071b58f2ad5ef0550cda0b31524f76659b223682c8f9f6b0754bbb7e9f26d0288cc17cbc5047268c807cd3a040dc5cd399e7c84d4f553d9970420385f8410f6a721f8def1e387fac66623a9ad681598583eb3e4df5f496852913f894bb0663c7c5f654b0a3420a033912ca757236f2d1d79b253858e40826bd51dfb33a5c5fa9c2e6bcf10a7dd02cfde90c1627864f89e295ff7d94249304d6dcc3f3f0f6c46e04d1016385f23a61b19ba85d9956552a8b4881bc5174e5ff15efbba81be5ace70803e4ab5d31ab2d49435504c513110e7e20beb9a92c95208260a7774a8f09af20105f2581d87894d35d2c806d11bdac3891e44199db4c8e5ab595a4cab6e130f2b93139df9d2667412df2a03e3e04f25b204cd7c0f738322992c5eed44e79d87e8b97c275ca27c4e9a383c96ffcf38eb15b25b6de6db524349bc477b5923b71d1c08e9e910cc95a13f66727c3844008aa45f7eab346b1503fac8ff2fcb292c0e778d6afd0c4472b6ee5d525d35ccd06e524a9e365eac2cbce7368d357d135a9a6dc29f39edd921cea030dd985d2be70fdc3944e1cc15b74e8fea871df23f3cfcb88ecc04c6e9865cd68fe5c69db8312428f13a28d9ed8f7ff329d1169f87946edcf3ed51142f9ec7d0294d9af302c6f1c2612d463167b93acbfc58c9ecfcbd8aca0a3874098d23f2f52e09223fafd5276e48cd244ab52aaf03e375fb4df6905d6fbffd36663adfe7e511031796b41ee45a1cd24adfdbd38f76d54f3072ab1edd01d131ab3ff6fb6b911a8634ba4904c4ac5d3054b70599a083b2897371742561791ed667f090c3d64f5f02e725505f2dd187269917c773a56ada5686b82ef09fa78fc53454d4693e7f7813036165c0f5e486d8646916bac20e91188b99038ee975c4184c89c9d89cae90b859c2e51344fbf44bd94402a415d299f4b39f3f90e24c7214d05d60cfb7fe1eb6c97f176f3911a117cc575b8f1e6ef484a055fe43f12031e82f13287f78412cc3434cf5f31a6a93e98afc9ed4c585685127b49d5f2eb65f8e2401b4566f689fb2788e8cc056567d86121447b89724d7632487fc2edc3b00bb0df40a3d5fa373471a6ad01a3b428a01eff8356994d95b5f73e9d845bb930786fbc1290883dacd38a6c438c1e4d10b483a2922a99d6181a1b2aa1bfaacb97a1e75f5680306e767e3a060e893f06186ca0667bd75d219383d36d01d9f5f4fc9e06a0d6b855dca9b2d35f1b407675c509fe3455e1100d1cc2aeb26fc9eac26f5a273a5c8a246ca5df98eeb94fe978383f1f509454f504fa51de4550848df13059a9b549b58b872610c3162cad091dc18bb2d1285bbb18b85e7bac660500d6173342f9b59661c27754fb99e1a303347385cb2527425932f6bc54ac00c8b96c430b0e162b5db208c7a6939199e6ce4ab8825bfc9eb7d7c4138c2588c951085e607864d814a2e81ec496aa6f0a879a541ce6c67f26439432c07c25e948a9cf86f203fafe64177e0357c84d053b8683324874e56c7c602589f237d1035f96f204b4134a69b65a3b9f8b72c6663afd9dd37a89976075976b42ef96708d6fb8fe85add19d4ed900b3cfbcaebcf9db7137d9117c11472b2041b955d36edc52f01f0a74a9fc80f790afabf39dd8123337eab8da70dfd826f2d92dafed4ed8f3ffc5e9d5cea7e84e6f4b949bb94df28e9e96b214c75a79cb34029c0d3d890d183dd417137c38c2da9c400108a477149d603ac3d54791764b24dd37b7d5ab64bf289cc95d8d67a0392cf5a630aa9a9fe6e379d74428fb2179e0c419aaf8749c190e51d84b2a2c4e998729ba899fbf8ae935ed5917e7bd2a114acee483b7a2b01a6e78c62df847798ea29504170800f347c7cb5676da67e71a0402409e3eefb8163e02d7ba3de0cb8c7613f4beb8c93ea82ca42be2330f2ee8cc2ef0ad75256966f7e3aedba74888f2ad86fa3d84bd5ce3b505298c0359b09cfff7b300a375d31a8258749e6d94c2fd51cd6fc8e13ad2ff128fb298a4127a9c9ddbd98976bef134e831dcc09ac9196d00e3071e5889d4bef9d0f175c9075e0e02d51080213eb3f0d5470164bec512425d6a4c2d2865bd50825478e9082abb5ebf812c30d07d0abad525d205b5add1155fb55a78d2a5e6d32d74bd260ea6c3ff9480fee2d716b1289f58934cd32bbe0e5b04da1b34110417146eed304ba401d7ea77243ea6beab2860ebc516d1e06e9e413a58ca3622807218583975540f56eb91bb6109bd148e27aba2204be49f0e517b8cd5cb0c47c1e7f358a4e8a77983aa72ef0a6b80dac808d0071bf334faa15e96eb968b6df6b4020148430456f6fbdcc272ad1330f03d1986adced87734da4ebe0fb5c2b75094160aac982369e344c67b649fd9467e7282ec8a3db6447ce538ffc30c871f35d0b54d4d15ed5de5400556d18b84b08dbe0d45e2ae54299418b4ad38f856f09e463a0f16eae51954bcd75a87f4b948f49f396657406b0c25e0a45bebd51b6bea217b9db2c6b38649359b120598dd07921b38b9a74b250a9d0b8737793bfae56fd562bcdf71da737e4ee9d52ea66a1db31dbdbaa893dd51a8d0bb613a12fd52d0b49ba9a1c68112f4225334338a6bcf7c1e12439dcf089ad31b387f5622cc929d6a22a143066cabec5fbe62b128a76969e3d394ea807b1769b71a2b3e310381a2f4e6ef1ae1b8d5e3157b8bc09bf59907de0ae0c68f431553bbefd119705667f8c1aad38cff41ee89a23c569274a7c0f6c7888a12a4cd4369a31d1611f1be4268163f4d76e8d228c5511d82624dcbc524e4fd947708c814a616ec8126e49db57b699cf69bf1f5d1b1447cc64fdeda9ed8aba6cd0fa6d84343413e73fbe472493b52c4d458d0cbaaf5649fe238df7b2c692ccb8978fcebaff721e20508ee95e3abea148a52a21260f8492c52d65603219826080f74af6777008461cc405e7f7ccc4b9eaab03011d53da604bbedaf6962d58811dd5b3b553a1bc4c980c2007dced2e8ce3df6fefea6fe5486c784f0a72f45d64b79e39032f730dd2b80c8a00e7a87d93eb259cdcf58df9f128e0b1e017fb4faa116496244207c90c7dc8f0196f88729743b148290cf7046e21d54af9cd6e86451f3cf5824002a7eb2315c797459c0311de7bbd99db19bfb9c4980568872087eb6513b616ea32085e4220396884e68f926685d5946ba7f3312f601e9fdeb6155b54673c5e1476809e217cb06886ff1892b1bf0e648e8cc86d7aa4966f72b91fe6e8a165fe4aeb443d1a7c73133c889fc7e944b1fd2ac73317881af163ad4bbcdc71a7f4e3b1c2a78827580d3b97c07be6f64dd1867b837bff6ad60833cf0caa5b4064ebd61683047a795f80ce97e12eb7cae18680689548c13a77517dcaa886655ed339951feb297218dc5c7d4cbbfb152850f5966073182ed3bc65e14c0ef58083c592d369fb1cd06761c9939ea7da247926e044fd76fe49cfc821df9bb158f106ea20dcf937be82d87ade4a7235c1401502daf87895ead7fb027a6224acca1b63b2ecf9f4430403214104f93fae5ae6d6062d36ab799af3da1fe735946d248409923d401e60edfde849418053e692fb3948c5fec68b3b39e3739c2666ef9faf3655dfb1f708b04d652535e23fcc3048dea16daa336a1daa1879dfc4297915926513cdb27988ea6c7ef0fe12d3eb642960003acc894377a3ff3ad729e4bc7d58ab48d314688574e9df93abf9607887fefffb12004136fc96c943716e4953a6242967d3ce88ae60d1d94407b3088302aae013c60a03bd385d44a8d4a5b91945865350001eb7690f942af6568be4505c2a3cdf8cc7eb96e0c78711999007ed773b7126e51412f4153a07935b01e5df4ff18050bb6a7c560b10ae4f6cdba564bde67c4686a97645cc9f9ec138c2e9e73d7a0b6126ac34be4162301e4bc7163095833c611c2118cb5226337bd5046bfb985dd91bf82b3583af1251bed23bc186c988433867c4653697183d4afc9dc7fcbdece1ee60f060321d0d105de140c52e26eeb71fefe54ddbd245870ba9cc19ba5d5019447241c90553988f307fd160ec05c948c57d51e47ce4684ae27bff1927493f6993861a832357c335f515d77cc767cfa58ab1745e5f59b1b0a5373cd94fe74277e8850359e74d4ec8109920e6f8ef0ed5eeca47e29b5437dc5829b05488f8b20317f1412f54f1897079a8dd5fc23394e7e10bc8cc39fb8f6d01587fee797dc93b9704b3e398e9a4d307be01d80d5baff8381b1174b548f5f56f2bbf9a18db4774420a8150efe63abbd5ac30e3f237ce1e96e53d17463419bf17485454d8acfe9d0310d2cd13df2982e608f6af8afdd946e2d4d43f5e6ad4c06af1253a9e81e2044268eac973dedd8cad090578af5c3ca578d3999bdd49a4dfcc2a7a2360d97806ca59ce10f479dee11a07bd6a9a77e24c530bdc9147671150812a070be52c24d9e12808abfcd4a62464a6975854c8dee139099e8bfbb1befbca064ebb1b904caea704ea22c0e874b88d77d8708d0e85b622a8af143848638562a041075dcca4587c35accb4c0442dc93af3ac7a8f54b37b272710512c0a1481cb0570a2dd526122162dee9b5c9679109bfff183d0487ccb09be0ef61e302a0b536591e4a131a0a2baff852a003854af213e4c05e703180c672c979a9f8682985e8e39abe668bb6ba4a2eefa0c489402bd6719ab79892ff5711b4da109562bb704b822daafebca9bc43aa750250e4c34da21eaad48b7ebd608a278ce738e36ee8200c3bc26d76f44bd8a9d8bb10d40b8b2161e19e83bfcdb4f45cb3adc4f8ea49b92142e4b6d67770a664ba5b47404232ab84272e292afd360a5d5965f09c53b3db6561377786e35da653dd2ab568f2fcedc92fddb9254356fb1f802b104c8e2a0fedf723b788c64c964b7db7ecebc1cb933c1b105dcd95c4e90cf90cdfa74ce8523acd7f2a1b13651dd3f911859cf69a5ff86d0e0731b8092723e4ea47993532b8fc62f62de12afacd8b156a26d19556bf8c7b0c2aa2012537db32e8dd80f9e6e9344f4e76a301ce9f8d5cddf1b9f7226e497cb2151518cabd62cf79732440c2cb273c8c0500f8427acfb55b39274383fce4e61453d9fa714439870e935443cb57a084ae709afae7aa762f7d7dade32b1fe7918dad75dd7acf75d3af4103dfa7f359d7089f450451143b94171c339e8e244ea734c0ec1ce4b9eb506264f55c127a6662ff5fb2bdd5456def97d63c1fea6d270fd863e033719f42d2d253ef4778fcb194733188682cadbaec748e3da3636d7a62af5f52b196939a537e1ea1aa6ea980adaa4d296b142d1fe2008a161428207319c924e173f35a78690696d517ba9a2a9a2e2aa817dda8b777deec6390e047b7e7062cc00281c158b1eec98b03d56ee40ac08a5881f88ab22d63dbe2b5f98a48e4f64bd3ece7c4a05bf3bd41b72d387e5eba811d75854934de2b07b6058777c1677b084894d6a8b69a39843265692c36b729fb729f786e421b2dae5b6b1467e414c4d7c93ee389d0799842e4eec953a23387f463d15f62d40d4104834fabdd315b8fe62d986b66652186d170abebc850953164921d420c4b4db31a585bb7f21d577894f2c0940623b0b2631e47d2b41cb2d6288d5e8aa94e6972abfb8a3a1be99ccd83073827c953ba0bbefa0faa02024ef931058272455c4eb187123ccb5b045063bd7f0a882593a23620417c9ad43f194ffc7102581b1f6822ec12fc9bc5ef9b4e6a8cb4c7b77b6006c5e154a324542711c53bb360aac6d0ec05a8dedcea938d170cd5cd8118cf63600a391a99791fbb8234ea87616f8ea1d76bc3c75df50128a8eed5d29e8794234eb78ae3e44872737053b54735dc618c248dba2064bea59b7604f9169a4c06bb19f3299b3c9e9c9ae013ed291fc844f8fad43e333e5fad358d3d32e80fe5fc6321f2d3dc8749c4c6174643ef68cf3bd54ea40812854a417fcb617d3391e514fa8c49e124ce4a1916d77ed33712167ca3e27d6776fdb195731d31a6bfa4fefc8fbe9fa2cf9f978897c53b0b4b1a1a45366975a5e78c9fcf8b93c38055e717e491993d841e27961909c554f6dd290660599815a60f0d8c1055123b999ccfde132f5a736da4a99f5f34235946c689003d5fd820bfd60a6cc692fea465da8f205f4a2bf7074a83410be421eeed91220e5841c3f3bfe3dfadcf74a9e9236d549b93139e6d710ef591ec06ab79a971de72d71bf3ad50feb94d51c3448b82ef776c22de60361928b0be986d765204eb37901addf2baada11362162bad057acc65d7ba678c31c18275ade3724b78fbd84fc8e9037a04f262f3e81e5c2f61a06796cc2c8e1d026ce8336b00a759b2494926fbaaf682a446e46d2ec81e9fceb873f4cfba63d4dfbe4dba618c1bdb9ed55199aeddde0adafd34ed0ae898aa3af387bce376f442ece95e42d9879cedbfd52d6ec08e18de2c7e3b6a78890cb480dcb66fb536b75ca0ccdddd2d24bbb1d8896d33335abfd6f9af833f3ffb8ca1ecbc82224f47d1599d19a6a8178cec75d23d1f8736807d7129143ca836cb7cf8f58d884e0a0edb3bc8c2feeb12b7430591460d2761101772289eeb217c3936bd1a7b904ad552280132155db7075c5cfb10c684db8a7c34231c4cff452c80801e367660ce7d4482411cea4cebdd1ad2942cae0de326f3a57d63e1a6473d38904d0f4a0cbcf3c9320d5e5b1721ec9ed6d6772b8e37232ae997b924589ff0a5238588d8db5e43e2b0f9691133723fb3d76870675a499b64a9d472c615d7d111cd1d10bb9e6471534cf57746189b983d69c3b3986d7aff1e45775f9dd4074a89b43bc25ccd00c62cfc2c26c463b37d47f4b1c858ad7cee2a2732368013c94a4b7be97fbeff2595b1e6dce5af41de890e96d72c9225d086eec567cdcd07a0a9c783d63ebdaeb9852c83bc3b8c60b98aed8c03fc992afbf13c1bd6e50d1f4a64408603b2f2adad8fe6bf7db43e475fcaf6ef380e329e10ac366d4ba57525f35e4cf4669421f6b991f9c8df691323854d552f0a9c836bd6467a47d813a6900fcc157c57cc66db03a6d558d7b427b663b60087723010eb85fe51ff32ba968683902f7094335e45f7bddfa09a651c883d6d94ea3341b22306775c0955a33401334de3f290b90c5c8aa4a8e752ddc45694030493f4991fed49a5e1f047889608cb7f9583878d31d3a7742d15c466bac182cd2d5644ef4e290ecad6a39e637f8e056581da6efa5b849568e1ae87215f5d7556d81910d27a70a2e81e6d79c505b42f5304514d22fc7860469f5fecaf5957c8f09974521f0a417d0f315c231f1223908ae3df7b739ccd1053a2227fb402ec2ba5eaad91779fcee0b039faf24e29cd91004b9c805c056d356595d7b2e5cabf2605087bbf3f98d432b60f677836434e3d64f0392dedfe9274b5b78850fa03a0ae578c763cd650d3847ef03a3b765835e1dc7afe8088613c4a957875f93ac4931789361847d394c8807f48b764bbd79d39e6c933d2a8bf89f2e61116877aac9d0b025120e0e7bee33e5d819a48ce1e064362556a1fe2e89502af618bab5fb9029a1cd0d47f71808af91acf5ef7767e34f60b89c26a2a287b2634d57979ed4958867e8819127b3d8ee91c4a465ce09e379a82d077fc1f71ec181f74ba9598085843f4faa8527416ddc2b563bc1d4651e3a21842470c86561f113173310dc0a624db2af8a55b6c8b5e2595dfa50ebb9c1f6b05e08aa97c78eb8f47615378ff7760024d9bd2653fb2d3d4d92c73e3081a82b687533e7fd33b636e961c98f5d2556ca04f23b160edafd80fd3f45175db4487685c7a2aefec383ebab1ec689d32b66f388b71e5588519f82592a7cef362e0dd22a37a8291155bbc6f8d5ba30dbc3c543765be9c0f8dd7df08717853fef41288f9c0917ff376211f6572086c48db2521e90c31a08df128882df6d70a3319bdbdc246b417ea7f63ff003b6cefeb35e56100f507094c26dd6cd10bd58f1c926ac716d229920c360239f2f13c2e9cff2629f5e90dbcbeb6f493cd2a9260c1da870523dc262d27b5e570041c60b1ba5a8f898cc476ae5ee9e4404403dcbe7bade2fae224cdef8fc4c4a98389d3c4785abc5294b7ddaa81f0c3fb0bea4e335ef9c5365c638cf4ca325cd08d49aad2dc95027a25d82e60558fe258ae346da184a0cd949119ad32484685c8a69b668f4c9dbd16a8814ea2d947b565647c04dc4fff40482788f5202847c9b0c3ea1e189bc99cc558d1144f88d437001d99f7e699335d13e8d60be98516ebe6778cb16bbcb359e09c1a11865e267a4d6e327d1e3f1461b86850fb532bc89e7461bdb6c74c1f2a8c52d441fe2cf43aa144f6f3f67f4678282a83997e14e06dfbad6c8222d7b72587847f2e37ca2860af7ce902e5f4264cbff4ea469bdda588b9d597961fbd1f9dda8e6964b6800dca2bef49e42f2e3b7d3c456eaf9ed2bad04dc1481682098648bd2f4f5afa8e80add9be5996a70e8d2e1e66123b9d7c48d9c65a48f2a97896210236f1057a5fa85bb88aac36de957b277344f82c9f3e22a99461650e5d2a9d040f7aad188621f113665e0ba1a919252ec663a3b1747709fe6c84e353fd1caed65247b77c08f8c54641bb9024180b355c32cfdbf62dbb9970c3fb25397e2ba2ddef9f57f76f2bccb87a1812e29ab2c3e9d587714517ba3464c5aed57acc74e73eaf09d33ef0f10b6f40509e913cdc884477f0475d102bb46c03cb320bfe3f92c0b81e032ebba507070ebb806fbe51960a2b7ad800ca3c97686e441fa20f06b46d1d9fdfa59d85ab9de3b45f3dd7b74a43de41ec03a13575c2d2bf3bd2d5de60e0baf5e5d7225eacbe3432dda80ec4624c1d2b4f383c069c13d39b7a3411f22a5cd4f9da7d4867771ce538ba144b450b9a7b81ab1d672bea1db16827c9373082e9dcf3980d67dbc6392bade016d4099e3d9e846223885b802dfa93b3f98ee645c797b5100cb454f3d9f8f3c6cad8867617ea6673c0e42dbee4bf666ba258f4a4087352e241383d5372acd6ff42b3d2532ad6cb1058e24365c4828e5ba41c49cfa0ac37fb552f668f82162ebe84d2fa3c7232f9fc073ba1e278aef30fec613575c32d1fe3a4f88f5c6b6c89364d309718acecb92ba08aee1d7762f41e5b63330d7a19f8f18c6b11ffd17a2fec9d6a5c3b92151d41354feb1b43e6744b265cf3c7d2154fbdfe902d8c60bd516028f4300d68932a39ef253688c82be464ae86110d66c5ba86b83d0baf8b3a5c9baf595e5b22ff631303fd9e2a6d4f0fe43be6e4e2b677228f885fd67ca35a0c91d66bed8a1a90aebf48330b9ac2cac2064b3c90e7c402707216d56fdedf3b91ad039906a35dc97702841b46f77e4d6204757c344c7c07bba718fe59d145d53555aae6d3cf4f338f525b449156aa117233af40c4df852fcf3491cbd12fe9979112535c5b254ed4ede3eaac031f1aae34c23532bd531e2d5796c34f3a4de3fac9a0e6a597ebada06e105c498beb8a743a315fafb798d820c99c2f5fff4e2a73e2377198499503aa77a348265dc8006cae9ed6eaddd83f350d09f91ff39ed4123de1161f7b44f9a09b2146e08a1cf1328e54d702a7d73a7a30b6dff3b2a78947a9d2dc1a65a34e84cccb353c7f3f61ea7ff2887f2c0e49ed9a6358eaff24cfb94d231c09886a579d14a95f2045f26e7f4d444851c332f02d937a3271691bf8cc64c2f9a11fbefcfe8eec685da818c611940a0c462d99828cdec2989ad6cb6df2c66a7605d6cb218e87b40ee8f558a2c1598c558c3e36717b7df2e0b6ab9cd17e38ac819403b03cbc54cbe737fe2e194d478f89b8152743cac66e77ad7f100c917d9a0c34e24c9d8cb76cbaf90909b9d83f18cf2081824d78377a03344419f72881bf3b3c74919379987e05c98171fe8ac1941187cfdb3174ba23ab0e70e68bad8cf8a1ecad6b211105cf49661042afa4da1c1814217dab4f989a88a47573931b21c526595dbb10557dfcc820d7bdb9ad1e9d8b4a385e879be23d450bc552d3a70083e871914a6ea106978d75993eb6e0b08c1b0708c080cd06d21c9a8d18862919f50be4294df6d1244dbe59ca9845142655fe5e5acee18415a416b907a81dc78346814ca9a5ad4ac6c5b7b44e62ae1dd4fb86e30952f03623a774b2c9c55240aa345d470efbe9bc6ab5f57faa9e304806d5f88e5a9324cd8b029b8bfacf74650254a4cd32d546660827d1ee47805b4d3be5e01c32f498f5551a183547452e38baa73ca978a91f409a8a2d3378b5471445a230829fe927efc355763b9bf6ace6d0af5b9fda3d646d577a0ba8e818062ba5aa253473292248c9c1c46230f97e2da1f132f7ef85c5287686abede235650067be28066ffc8610b62724d89adeeb171976905565f80676259b4ce42f202552f5b5c660cbae273fab0f5383822ec61bfbf93b70de82daa3458d4ff79293003d1c8a7c7540d71c618ae45bfc0b22397614504f45d28d5937b86f8129381780f0e1cbc0d09bd76403b4f98c9e52e9a0eaf0f0367ec3330b287e0887289dd2a477e40b265383f6c4136b081ffa7d73d3405c7c1f00dae220593dd1f7a9c48d5bba61feaeaaf6de884ce6a742261a664232c4d585f8ff32b6c2a6a196768335edb1b4b1d1f955e941d80d0f74ef31af0d2dc36fde86e37fb09c87bad4fc317f77b5ef1e4625265595e413bc4388bf4560223bde9ebd07d346a5d40e8657b9862793ba98c518102d8501c6c7b595ceaa2274d344ccdc198a59f9ea5848d2485cb07b9398fc08382ad1643f820fd62a15bec5655645c2c2d1fa0ccf92ead4350d91139761fec36c105778b456c1fc52fd823004cdb36dc6cb82209bc5c2771e5e31dbfa33f60ef144d2254282fb63c21a4f1d623061e8af37284180e15383695d3b9c30edf578f6bb4822033ab8bada286a569651f98fe6f758e8bc0440cacd34cb47a366d38bc35a7380e2193eef502d5ed07a291b43257c13c141922a285f1b45003fb9206054578a7dc79ed69971feb4995e6f804b237065b8eb83da936263c395bc9b16ee8cdaf0faf4e9e065497806ef71c690011c6e59b9995b6aa4254dd42e9d7d3b1d14d3badf37b0a677a9e066d77e580c47510b73e3306848f9895ab2d739759ae07626bbc4f60703436901eba57ceb5bc62b3ec1c7892b7bf15161adb7888fcfb9ff90316e4d93ef48b8f004af2f79663791c7315406d7fddc66dcbd706cc4a58581c93cbdd6218f98f642b36ece83386c7f14934663dec6ff25636bd082deeec40a9877ce8ea01ca642ca85454c04f499f33227e2b70e16244a63a716cf40e8625de9f290bc67750ab3315958224d2c2c348bdd9ff55a8b62b9fe1ea052b31fdb95e0c1a7c1600da4f6d89335c0b3f1163cdbbb5ca74b1129989d033967824fd81285d019b5c93ddd8a72be0307d75d06890dc2bbc86e29a80f324c40cdf1ad3fdec6d8ee77f161f89c4725e86da2f71c93b0c851730aaffb362efc3e7f498195f9506edaf1141bd149bae9afafd4bc0aab2389c6fe9710993d28b007dc353c53f5fed8138bedfa7f63972f38f3887e526696e26ef4da1f2c2ea453ba55d6e043578ae6c00b2e71cb09a7b2bb6ed78996e72cdcfd7a2c2d0185a9fbd2c89c2b3696b9bec5480ec78140bed5aab13bbc4806da2147c6cc827544ecdca1a3ed314f381699066f219d82c47ae1ec7069c03f3a425dd21b2587db3bf9d0a0fd941a6e17d8f23b7a95729b7d78eaa4fe8db1f72e29022ba393b2badd52b6757f40eed358cfdf3868cd0308623ab3bff88e1bd84570800f0fdbb073afa01303213002a7f8289824abd94826113d3e37378ee6df464672059fdfc134fa756c673ed591556d047148106280a66bce3fcb213e7b13dfe6e8889950bc3967e148f6a7b7111e923d4387298fb0713a59334a13832a7db0045fbc08e158952079c9ac252d00a41328ae37b7d7ff56570494406c6a1b4a115f75943debcd62275a92ca255f1394d9fe993767f414100f1d1f72d80f001b5e5771945a832c48bd525fe11bfc7225e70029487069c7f1b35dfd30a6975a1f1579fbe02caa126e69d7330ac1af1613a8c0b987c53ddd4a5d3041cc4f7e9b593a1bb593f84c8dc8eaed8ee696006e9f816006a200c1242b3fb0c6ae39a51c713fc2ea019461d47f74224d750ba40a595579e008130e9aae3a1e0ae261de3c80a191fa08a8bb1bb130f37fb0629b61a645566ea15840b9a20bfaee0b14d9864653854f250806bc9d8b08ecf775e08a2b6241198f7e6cce30a59ab30a0cb67d01903621ebcfe6152f1c667e99f61ab924a2d7489a110240c2eb55b02cf9d6b0529117713a2f847c565c37b16489446357e93f2d4c6c22295589c5aa15b283237500dd3da7d03b08f119704a7323ec79f2987bafa7ac199b9c6539ad8c5756ec80be442ca8b1a8d8ce00e1369cd682ac531a496e74f7dabe4e618a87d41859f0d5020fcdf36bb02ec6bb558889937deedc10f41d1977b666854fbdb0669e3c22264bd586f1862624448e89bf6754091a801ba380954ceb9e36c3cb4179f7d55db87b4c21804a091a069c75c53d44223548f554f12ca60c30aed122c4b036ebeff67aa343c42ed2d9d403933b86465e0171e83b70f033bd25616e64ebb6abba816c6cde928af24fd118ea09f267832b9373ac8fec156a79f77df708b6f6510722ad248047386849c07611445f9ebfcc492f04b1887f976ba944f28e009fd920db0e56e0b98b1eaf3c92e2b4ef1862031957e22858b0f458177145ab2746a253b6efe8637a23f65f70aaa0d6a497c8996d8e34be24f3af9b1daadd3d9decbd532cbb3c1e35e4d8bf733ddf7a494cc1220380c5ab45a38c0e0f64f72b5d14497f99e32e6d0c574f93c6fca3983187e8d91c8324e4ea6b40981e77bf7d27c8a2d19df9cda329ce612bddbab95250f2be2d9eb558de9335d470344b3032fd023efc61a0ac0d549cee1eae899f565187af13c9356f0f1c8538e09acbda4cb839f82b52bf8bf46b9d3beb4f51ada6af36a72848a3fb03ef1fb88817cfce2eee836b7d0c5c0f4ddbbd737d1c6ecf1f26b02f15c3e80a16c95a52243384baf74b3bb0511f4cafc9cbd69f3836a437b58bf69f16b0f654edc641027a2c7a862b0b3e8762f3eb7cbfdae8e6d1f83b384f57f1b85c502e10e91f1e3149003cca4fe8064a4419f8e68f859f8a8084c67a2e0cba8283fc6458a193e57a9dc5945687954d83e58800d32ebcf2eee5d3e349092bb265edd2d3dc813a95aee16fb6c4eea0d66f90067629e59c78872b3e867c8dd7882b5b2e91290fbd19894de89e7bc5ec4dcc257cc9abe98f5e29208726bb2f11c682303adc2b7e6d43ca3a0c9229f7e72dd10e01d6505af2b3308f9c5da3c216cff0110119b0ba3290c2ce0febce223bbc97a5e09728cf5f8a2da5ad9de39664a4a1c271fd3b37977280bc7963e360536f4f154c6c0e9b58d8519fdd502a7434c7ae86382cbb7be2d8d01c02621b86b2f89ab732dec1edb714bf611a004400e9aeb368b9d19833a129b23da781be4a46f3e0c84fa7da1b36973a2eb544996aa2ca91094fd6807476d0ffbf10ea88c3450165f056050d4d63ee6d073d99662cce0fd730452eb78735b284b75b6a6c47f67a5c5cb802d941d4988dbdd7de7cf21f03de393269cf1fd4cafa1dc791fdab2071b5a2df30fb577878f587bbe29a4a041efefcbac9541670635779ff624a477d777ac2b8d63db86343e7170b5211f0520312cdad290c27fc851b548e0a8c27026a4c600fb757ec1f3c3d88b5ee614a030fef4d19f09f28ec9169a2c95653c83c026558a468bdaf4b1bf6f6ee7bbd255b90999c4f5c8ce956f2e46b7d6ba4aaec20df36d47425c5428d3efc3a522eee0d3b56962f92ad8c8be924f13ee739b54546b42c7a2f28e266d693f7a31ae1dd9df34b4e542a26d4307950bb285eb45583606ecc58d7570ff2cc755cea4fbdef0f1b0143900145a1d2612abfeda29d30c27d86efe8549e538854669f960eb4f7a8f57201df4ada048aec535b1c5efb854754f6b0f19a86640d6cec065ace088017c9d694d277bab5e5e45eba261cc0b99777d9e1981d8c0a8918ec98faed1a876a86d9c5f7e20abb1793c69935e791e9660f29469ea9c697868551dea3efd345b2a1ab51501002a97cc70d50a32cd83e0c799b710eb220aedf3f6fcec924c620d7469d7d3b70dcdeb15d2fb64c88201557f2f1ed395ec57cb44092bf097c6c9bea81d4c307fffe3b27146e3149568f9f3655b2276167bcd3c07c748a8fa52afb65044afc7f4be83083678103f9632e36077ac99f8afd96ba5875691a7ef9ebfb7bb595ad5c49185924d97cbb4014742c6128fc4828b30f68c8244195bc6776fa3c237d5571522d573f1b40292988aa6b4ff7610be045d726fa1399c9ea7c9e193696750ef5fb55b3951f41646dddf7f3ea5495613c0adf56a018cebc3c7ce160a38d9d49c94448d7df1233a045c6966d2c1b64ce9e21334016e9cb7e7d057fe24e398f7d7ba7958d5005ddbacf09e15b70f07ccc8840d914e74b415e28c332b729ae9626d4dc8be4983f9139fa1d97b96468259c1e00f71c8ba364bdd007309a2d2b27f2f64fb3931d3109b9a5b413b320e311fb4ea29e4eebe0629eae3f3f30a15da240963f593a6acdc7ce836ad5ec2b09a1eb748fefee2b55c27076dc29c9630875ddcc993ba298a977cce456ee1577457636dc3709bdce260be5000bcaaa4645f9d895ab8faa9e5188225d423aeba519d7b588cf6548d421d7211079fd536dda448255b67c33de3d5dc6ab1fada04cede36ee1629749bfec94a90a3d62e2d4247aa38ea7fd07e68f9afd8517e43b3e4a4ca4bc86d15d04f09a75a5a64851313fbb98f763a10b63e43bd78c5460d461709e199e0ca105775e52a0cdb4ffaf70c60fe3d459b7d4b2607665243b49ab8706a6a7cbabbf7671bb1753737d3c0121af22d6675652ba774f1a34b88c9dfcc01667612e07b1d861fcb3c8a24c43f8d017f18ac4b3e0e2dafd73f9db9dc8118a9a014fb281ec380c8d14364bcd5a24fe2334abc3446403fd1b2153621906c01020802a36ab6c428c7f89a25d095e55a69aa56b7f378cdf8ecc751499ba3f13a039e012664451e0d5dae50090ec100c82f1235d9dd314479b0d6e3a56bd3eadb7dbd09b4bed62571fa3422dc040448d27096e6363f69d54fcf828160cc3837570ffb9def4ae9397f7420d4bb70b4d9016fb7f7916e064de51e4804ee58828740fed36c6e2fc1fe4c831161a6eb366e1fe0cc2115e3f57d5dc169dabcc2922ba502a9e6c14eab30064aafadf5a4ea96634a79646cb11d1059f8eb7b2457773139b6dfeacb9df077369d7599231d7ec54d72a1768f7b35d67d8eb792f4ebcfbe0b22e7b3b74993587c941444e84bbedcfaa4b946538952413bf5d0f278508fff87577b020b99941c2fe45848c9626e92938531d127de8253ef6ba2bd6dce09a9076669a98be8aeef2d6d60565bc1b187c0c08f06ddf6f7c636e88edb1cf90875026fd9f541891feeb5984f17179fe205bec5966a6b8bdd53b56a264670cb0ca445c048d5750135d524d58fd11a4bf5d821d6751b5ab1397831251e94ef284ee62e8683d583e738d2691d78dfc01b3374811bb06a0182017b1715b2830601c6fec4b6de4f283147b53902ec559340f65a5181b46f90df06d034867b9971e66f8719a6c1c4a907ba138730fb057b150b695ef278ef02189e615662022bd429c222bc0e490619fcb4cd25e560dd956f7763455775bc2b27d2ea76fdecf3d23a952a48519f736462069a3c300568c54d8c7d455512744d2b8def39ef427b2d9e5cc928e3252054e32432bf50d672fd6e19c3f465dfb36aa1dca42a896494bbdd03908ebebda6288f4e90e7f87541b0caa365a7335b63407cc528a0c963d44a21083bfe8607ce87373b8edd4945efbc08002129a65d11a16b71da229bcf6c89600821acfc13936c9fd856804e5c73359f08033bd0456fc8ed1d1dff16726b3ae129f25aee41d82de76535617d0dbdfea38fb70305b355c41ffb623c8a18d31377309b3870ca03a4ead5ce04b43228706d66cc2e3ad7b2ef45c6e3464d93048a85bb0d51b10b43fe96dc774dba4f7fe9b08ded48d4dd840153ad45b67c341a72ff26670bd08469927d54e9cc17ba70fbffa68b89c964e9b0bc896643bb82ec8a570abb5beb928cd6d449d6b59ba087be0310795bd2d43171975c2bc0a7987820df39413725424916395e1932e6bfbf269d5e8258bb49b2ac98f2fd314060751c249ed11c118ecaade3bf309c34326af7b3858ca301ebabb5e2d6fdf104808a3e8708afecd9b6057fb430923e023de8479ef78e7b1525d3594afd125ad153ce55d5d8c49867c78b18687f6f78a0ca1272a7b630271ac044656493aca04076767ee0a1d4815d17f700efcf12941725c5a4f6b41c8e32265414ad1166610c4f2907926831dc5aa27a0e97156ae7f5faff98378e88316a46d223fde2863dd57623218cf98207ff72e843a547cea57fbd57d9446a61dad5c9a5384c59b613200988e8ab7a3f2f66d19cfcc8d0180fc5531d37166f5ee8de28fe7032a375d5291711301c193fef3e6111e44a108bfa28ac83299cbf3e804d51e8ae495915c7a307398d7d429de595c6f17d7f4ed52251aefb248f943495bc1045dfdd71f27d6c38c110df2dd3ee1410f240973080fcb49e4ed1a98a8534b0dfc9d5b4bc2fce24cfd9bd3527c923a1ef6ad074dda888fd5062f59cff0c69a212d70a924eb773d35f1292ac86482e3869df3f5e24fb12fbbd9f3c2a2cc3000353ec6d4c4fec4eb7366f1e7e49587708c78c3393931529c62486efc1df73c938bac846026fc0d994e44663ad01390144ad7c9c4c69f9050ccffba75fdee94bde353ef9999dfeef2507ee72081576eacbc76e9069704b4f88020b41ba9e1d4a9b3a79a70dfd7bd1d4cb109b4e1e374f529fe6a955b3e4ac09dea10a788844c7665f38cd4cdeebe361c1a5c95777f434bf1f4d9883d9f81957d96fd52dcec80653b284dc8323ab951bd56c3fd4a5bd613c039c32c6f0e1d68b79a3074f1171057212f2c76cba7686d0c91ec0d4116694f4a1e050eb9652da4961b3f3ad210e4c5233c7b70c4edd6c16d32b9cf921bb020270369287fdf89fd7332506b9c71a19ccaf346259c8ff93471bf7dac268e039fedc65f5dc0b4cbcf6678e3aae40db206c73fa5a927dc3e7105db50b94292c483441df48a3839b49e38273568f158152a74f2c406b95d8a000f3491ba2672c1bdd592bb3ac9e5416d2d1fdfa0636da0c0fd76a9fbade63f73bcf4234f627181be6f2a918f7ada3b6e4f6bc0fc6e697c811f67086a25dd3029694999048836ee9d99186e07b723eadc6680f69a77ed3bf0716983c9f9e077ae9fb29e575b7d914864cc9157ab76c4f336c5a7412a0ca8a507b02da96b3a45bf85294c737e97d0f812dc16c8832d78f376762b240394ca7da213dcc74b53a728c0e2d5e9a63decd5b75b9e18409cb70f7b95f496053b52227aacdf58c9dbcdb2ce1410e67c6e12443fe300a673dd9f6aa0314e8553a623896db755af1f8270d7d42bd0743a5a6f9382ef020a9f04465e0edc6a5d9f6260c6808ec083d20092e431990142e1e9fb748959a25a3ac135d7ba2fbe7ad9ee75a9255b80adf0468542d63627f88f786cb286b03fbfc7020f3ad70fe2bf58e38e52c7b863ae72cc4d13cacbb1b199f105a7e65b205c8a2c978b177c587ae25c06f2c8e8535027f3808620482af1b504c044d9944b573012577a1f27ca429068d692a2575946f6f18c873a03a5e74c3c7f00c39e6d8047370e5cdf9ccd8fa7bd3b52bdda04f7b541012bc5d1aa9d3aea2433e01e93395580c00a4af3728e543685850df36d2ca05a28683d0f48f4eb1fc58a73b3d94599fc6a91450e75a278bd87cbe2f2b90fc3bc71b9d9a2e191633c2621f55c8731c19a63db4d1e5b86c4403506e24cabf40d2a4b4b1d0a01b4da55ef8bb535839be9c32901f60b921759accefa57babbf366130660d1974f42627ccc78c298746a26c3e31417674983319a2d0798f31fde629319fba016ad9d454b85f81ef9eb7cea1cfc2750a6fbae3a267119aba9a7c56b8bd76a73a0411d605185a6cf1d8a2942f9b6ee087e4eac575f4f2795d387f6997b70e52165bd4a8901e26603c5050652a094cffa8620fb936e1e978216e0285e25446bd8d1641bf70cb4e72ff5072d456d5143553f1e0e96e74789caaad08bd6d775b195bbd41ebbf7b6181494e99dbd6c21a286cfa1a666d53ffa1a168c4750e89d094f2a9f0b4dbdc9c8d6b2b0f55b7c38818483e7244c83f015e0e118f9359256d211ed48839ed763454073cf9a4bfdbd1d8c2e151641c6b36582ab5566beda744a3f4aefaa798856621196652c4e09bfa0dad52f00e787ccd3497633c7638099291ffc58003a390dbb52eacd405d5abe0668012dea2504ea6bd6d603702957b74752f9d256c26a541bd5499c55ee038e6268a9409aa79654af6136b261b3b1ee4357150c3fbfdbde169279c2f10799552e37a7249459bef78f0c4951ab4cfe68e8272a84a0fb2a420b63d2422d939649737df42d0ca667f47adf423b342b246e8c65e138a0eb3b11ae1294562942187292007dcfe8ec145bc9546a76a38af9d7a580d8dddd0987a075202c4b6994e66d9229f9110201568a950b46dd8afec539a5bbcd260597edc668a59fd0a34ea8f9ba2652bc29bf510a7a5e8c2495ef0fdb2e296ff6494f7f94ef78ecca46400b263e72f38623bf1a73752e0895d0bfa399d9efccf29b0b05d56a50ba66e0e92541793c5fe74e1cdd2d998d74cfce7888bf040c6e406b52413b0cab336069ef2f31d911e7282c47411ad21b8b1e11422782fbc4fdef04f2b46a79d4cbbfd2d2d21d34bb27cdcd5284833968eab3d17eb488027c38bfa8927c74f9101560219befa6594b58aa19cce7944ac7df8f5b5e189eedc783e8898e4b796a38a8e33c4bbb61a5200419749f3c2c649a991faf76286f635cb60e6257b5d39720e860a137038fef3e22db4f95f7fc58d7fe3818353afb715508c7cf1dbf8f6bab9b9a5a7cb7bb3539a0071a206aefed562c653fefe94518ed5541cd0308a160caca7ef1facc9f198979a67fa75a962b04b2927c2b2340d6ad95166ea700efdddf40dd52913684630347b105c80612bda5bb6b8504b31b36b6d7e0983bac704f6153c0c33e73ad8c983820ece8230be70c71b1db30189e0357a5fd2a3709aea9d22f934067ff283707a1252c6f6efb23fa269874ac6c9d8a3a60f87a4a9c000b69d4f4e46548f101759e5b3dfd7c575e2b7e31cb334f2dc2dda641bf963c9791d41b8dc4f0471d1803b0a46ccc2265c07c1e6e7aa5f9acb03d00e2ac8fbe7a099458d277cc4d369cbdbdf06082d9c06bce24470e998e283eb25e5be39431c6568a61eeebcf221092b36eef1c209ece2829876697c9582f5b8cad35c49f3893ea3f66f29447db347c0c3986d35a185539f84b18293873cb41f8871a63b8b8c1a587c9a40f973b00a0efcd5e489220a49d9e278036c8d7772e8f0f62f02f0d61c34411d5e819b4276decded1f118b2a82b35f780940117d49aba65557dc27e2f0b20c86b0319227c712d4d0b8033f50cf7829a0e58cd0c4b6793ee19d05cdaeea9fab81966426d60ae88eb4a78a851cb1da44f78f8fd1e8f4cef858df5c3889a12e831ac7c71bb3ec3e16a72f58b05ff7638864af15540ece46e3c0330b5328c46988a7578d55b2d3b152a43cb43b9a2c8f82731e9660cba18b78ab8cd5651b81e1d6c83d81ba72b083dc0062acff44e30419df2963f6cb02b1c527dbb794c3a6d6f7e3cae85e559e32f9c518095e5ef722cc0dd86b4a8e84174b6899fab7d4a950394076979e39cdd8706d956c6a3b1e15220f1055079eb85206f7467f68dd8c99de9ebd7b44352e91b13e301f722beb59c619ed9ace9010a574a1d827b481473e67b1a65b5d5d53cd16f6e8a8d06a2ae8a870b64bb4e6e57c9744c4e644507ccb34ff114b256e1b0d1ce647f9ba968de994dc5271fa988e822d07423844a0c87fd2f8379d8890aaf40ede9e3dfff5c28d34903ba40abda8995e627af6820937b6496e0eed36c8075191b386de3f961bb2f85e3e01fc661bee0808a83bbddd9e57225af3d4453777f7e9c037a4fa32c9ae01a0db8a8badcef8cda0be78122b52ec77aebe8f2d68ffd71e8f7b5245a84a238eb5fd56725af6d863d31c014b3ccae331f7ab9f7d0a2853a4b49a0e1b36a7c584ea608e45917274100832271ad823bbeedab74ddbbc8d258295d363af1b627b9fb201e0b55fc202dcfd287b5c493580d07073037e27ebbb83c25f5453b1071bf615209e1c7e409efe6cae1567b6da20ef876de928fa2578e3ae4dd443e7c7b79d9f3d8e9bbb12626b36c9941d928fba235ed42f0c8bdb4c30b591fea51fe7276073db59110736b63d9911436927d5b2b63d5f8922c0fd288c9ca22a9f6142d94cecece74137cc72e94992fd4193276ecfef96308f7b8484ef90ab9f5b39f2ca22f14b4b6b3a715802b2253af189ad92c48bfc9a89793c6beb6d96036472b5285ad0b955abd591f2c6f3dc90ad850f22515eb9cfc30cee1195287122ccf9d7a4155862a56c302a80cfdf764c708fb6614cd0093b49370603ef8669ef0b671936dad370a91089d7d8de27f6b10da5aebeda5929a8168e14b52339ed020a09bcd69ac7a1ec8f83088e5bd4e8290bfc0d9261e8f0580650929e734a7af38845a7c2102137598ad513cd7d0705d07369a9f89de87e7cab619c9aeab2046f4c5ee2f3bf806ed93e7663dd0808208a29871e75781a12e34c2881048a1d1cfa738b491ee1987b97666b1d4f284247fcc3159d7dcc81547de15b26531479b7f6f600e0bd7361eaeba55591fbd683aea7056e7797a73b855663e4085b43b0298a18ee25e82f5c3d0a2319cee899dd874e20a2415abb7cbb888b5137e7d870fb8252b88f3f44cda91ad3108c7d31a98e1c1570190b23942ec5a25ff3f410cbeb547e9a586463d2c95c8725e9ae2f03b0feb0cb03429892ed6682c5032e58df8761ed66c27b11c5495ae44652b829608b0fa497c67e6ae9b5fbf7257b65849f65e00b614e8184475cc46d9728939a6ccb5b5da90904697cbfb6fdea33d11aa3da06a7bff766119e4c7000bda1a88a329cff629386a5cf6c45a3e2ff08e7a504f92f07bb00a2b2412fe70c8105e3bc2682b87d8d64c68bd26169a6dec8d79ef1c9c4cfb0e7024a95c04add2ad18894ce0e1db59571da5beafb86ae248c03db0044a4a87a9a4a6d9292cf101b2ed687f4c5390471fffe117884f89591bd4a596290f03b7498e3bece743ad87a6d2f162e5647bc6f231cfe1342fa098733a01f6edb1e6f29782a66211431d15cbf5a5ed56b6f4a5c0622a6c1611259dfb0524bec8c0bc0027e39492413c55ffd215c1ce55aa82b9a943fafb5ffd0363c3a8d1b611065e067fd52a5f9346dfa85971fbb167c3600f3aa3ee1d4cd18ffc6ba9b992162c899d2396c3cedecd429054b765c499024755b985b255a83c8bb94c0abe586f26feff82dc93fbbdf508ac916cc80e26224411c1887788f7a4a4137f7de0405274c1cbace9e9a8bb0eb17d14bc7cae9d9e31318ff27c8891662542cc6c1e7642b392b8f7ad7a4de37a7c5398f0508ce24135189310a243805b441864addc3764ff27def72c942ad80c2d1b0337c4706996a2475a34aaad3293221cadfb44e69dc901d46a0af1b2e0854d8354c561f087418f105ffc4d4354968e4a0ce076d366fed87e1d12109cdb60adb8ff85a53318dc31606df1fd6ad5e9fd356fbf2b45a88ab2db23e0eee44faaacb0a659556db4865baecf309946dd541762406b87fba36bbaa8bd3791d0fc8019fb04643b883e7c4afa554455758cd74cfe17ea233a1fbd13e08ee605544e372a21f747a0858e3833dedb88285be5856c1e0a05e23f53ca66d84732a6ecd98168eac2847a99e5ad8184ffb596a5103e57e233a187876b0094dcf8cabcf8ea2ee3e0c0b2873940ff0a48ab101021712314959f44c4ca9b86654e8a0c1494f11880c2004386ef105e9a7cb28281a6458c1a0c84e9e4f884663746af97049f10dc7c261a1c6349030dabb576c67d98b77671c3c6816f22109cb33446302f4c6da30ed413ceec101420b5185994e8f18d7bca585b9a75a01895d5d596bbbb5d68f884282c070c5524e995cc35b1a9b32b579bb90c15df33f8d3e41135fb8e2bbccb7ec12e99ac1831e48860b0be895ed271338cc713a9d15590770838d6aadc7b600ad1111f919a393428c47684012042c61301dea431112baa5ebb92bdf047affb1d5e109713f8fe27fa820f2bf0bc968214f717cbaa1bc5601459ba13a56532c2ea653c5c815f7adc4d6f3584604204a6c3e6b7452979c7ae81a18aacf70afe5948933f6891e5adc1ae1f49bd081d75084d506113c90c43ff86a6248c580dc175dcd91045b82d8208884a57fd7f78d98d0dec9742d2c71aa464ce3a8be13e28a4da9d9096e17cb42713d6873d7133307927acfcbc8a030f1b59b41c15d44c7412975e45790c884128ce1a61e110ae687967eb8e5e2992923881d93c124e138b4136c60677588f1b346ec71af89c07605188157f41df12374dd56778368a3b273ec1b95a16afac263c7d97e5bd0d79d2f6151b26e0556b599e71547183ddd536b7cb95a98f48d24753c68051acdcc49f83ad5cfab8d71e755fc2153b7531718f7ce3125c10551e96d2a0111c974e4444b5cc65dd2b99bb747d0845103693a06269b943bde4bc086f594ed5bf61f9a58cf79b145c0c9c1bd38ff6823e3367b7d2b5b4e4964e628353a4d5a26db4c6a22471e709633b40aa549bc762e361fb22f3739fc3b6af2056cdca42709995ed39055cf43636b00fddf11554cbd93071e98200c8c1cd6236d9280e98dea39a3b660112b298acc689cabe844933e38a60a8bdd392c19865214fd007e33b52e2ca2f3cd7de3fa28b9e3f6398d7e47f0a9a99ecbed3391a0a734c7a2365c5d4fdb7fd86eb6be4c2537432f2f40411d6f3a4cc6444d4aa93fa57c0c11dbd5b48ff53c4658ea7ca6f57a932a0972e48fe668cee49c48d52c5391f80c6abf132169015a7453f15e426f44b0ae171daf72850ba7b1d799dd02ee77e840ca2f1fcd2cc80d059dec3c074cf5fb9a260c6561bf0b9cb1b2e8dd335732ca0629c1c475d03d3978f86db138130ad406ec2663b7b671a3be1aebe4c39d393705d20e52fc299b9497d5c4f194109142232015c2a17708cdf685639f028ed7a4df3013f99cd3c140442dbc795a85abc667eb4b9d762e8da4da6aba98b1b5ce42f494c4c9a03864b175b2a2595fb96d734420ae23fc51b91567f252030b2177427130fc26b4b9f56f7a763424a6132816023b0934499475e5133b867fe06f345482d00bde15e6ffc4e74f323fdcfd8c5e4fc58ec53272410d161651db6932fcc4b08ae7638b9f12baff3de06cd820e5b44478553095a3a17f2ac9c28a5874bb177e4af27b920da423cf3c62eaa2a2997204ca017819f643fdda41ba19461a84e84efc2b1f1b030cb6236ae7e3cd631c8096feda666991aef1cbf351be23835b9a89cf0bdd7d996ee5386cbf2baa60d543ff0ae5ba09d6a0d46f596cf39698d459b68b6ba9391fb8f0ae95693c78b76df4be18c32fb275e8aff3e115fcfa7a72c604ab6dff3832c818cff3a824dcbf86b82bb694c307a4f5702995cb79fd3d2ad86cc90a3459cd5ad74614c2b4f16c684c0268fb74a2708e718e80f911dccc9c3cebafdba0b73343cfbe3c384b09b45f7bd5f54697f4daeb1f9f3ae93c3c73b73a26eeea54f5facca859046ea1c139056a3584cd7cfde5c90c26d3e7abcfab6461be7801e9fce5c0e2c254fdb824a4e292a37f27a0b655c1267ab2f19b0f0b8ea5a5aa6e1e058589839eb75b1048a6f9b6c0103da8e78117913287fbbc7c91fd04b35d3da6afd28dc715b75f7d4e899a25daa95eb4c79e00db83e48fda77cc870e842a630143632fd7c9b5a339be24abc2a44e4eea886ece9786a06471c339f7b3363b77c1dc53fba0aa081e6fea745a2247b8bfb9842649f6622419281f89b9e6d100f959bb6dd9ac821747fb990bc8912d8fc41ba73353d0b27c57897e0fc599447de0b9040096499326987a7dd58cb05ecb7d99cce6079cc5b3ca6998497c19fe89a8e7e1eb61d64b5af813cfd51567cf2b15857aae64a73ec8d3540b706eebef15f8319c1cbb47e9a51c986ddbf76553a703447551f54811132bf378ffa192b140337dc440032b24a9ab4ce11bf8f8fa6e0347a48b92f260bdbde45a7388ed03bd7e5832445b36b68633307276d623cac365d8665b06e7bfb526f082482ca3f8833a2ca44c5434446ab6ef6ea99ed0da41ad4a853db63b47d83b1c7154e5a65d81ef015c12744f62fc1433dee6ad85acb681a1ea6587a60edb8fb981bb5608c8da5d7fb1726f470b96fac741ef4ec8302045e83f8bc7d7fb24d24763ea717f09897646daa611060f1ba55198f8af916cbb707c87f913a686884dec1c81d972826a97de2cb9c9020aff5f1323726333fb263909cdfae13411c34f81474436de30394e50a20cab2cfad4ca875a829f883279423be85d50dd17a3f342ea1e4f383d391fe3688f15d5667b8b7f12a2fed5a6c2ca2172cce6c36167facd2afaca8e34e7faeae8f426c31cc4397a8bfcabca5dda888b0886f83556bd7cea31ecc6d8ef9f2d9834e7ce3a27e08109c3938dbe738767944e29f9356d43280092931dd17e4696fe6247aade7bd0f90c2871a5cff5bd2912eca8e560a7b39e9be5bbe225197b62c690245939c5e1b31a49098c61d05993b08f27d2697fe6b8ef295bc0ec8eb6c30ff9e75b39e20fc30a01297bceec9542f1d007d687c608b6ad6c0a4a99b5003b0b9108c3f908aec8e14d48abdb8abdc297c296e98fb832a33c2879624db1711cfcf048685fa3678a629cb5e5a687bbe9972d0e099a6045c2f768437f50ca33c88fd664fec6484430f3b8e2785905550e6e04f1d533ee9c73b53b259de18dafdadba7fe6888a18d32aa75d5cd0f97be39d28daa2eca0963989305966b356317dfc1f21ebba1b0c1fb2f8743ca5a13e56d246653112718670ebb67c2ee0518c8bdccf4884b43d017c7fd3a40ac049c4d396ca595a113e8b70dac6172f417af1fab3af1d649c4690fc2fb434cf2186ba3bdc5adcb13128b2575f9f3e14c061c74ec215cb6a351ad305c32e2a2e44d724e2a770231d2f594191af1c74289b3fdbd11a364757299ec9d323cfed95f613592b7582c0b8e6b1c2562b9658f1309f2edecdb800b54e2807c40367461beff4e99cf717487b9d8586233fb832b074c3b426724e45466c5aacb83ee13473b0e177ec9a6a033525801b95e39400ec3b13d705e8f25c481de62649e76498b4dd07def02d76313447d850273cb364876da2ba586e897993e5a51b80f738091026e46ae88cf0ef769f63a4ffa5ecf44efb7b18bc3937ac865cbff892ed5ca364bfe738f83c038eccd224676d66d6a1fc05cf3c05d7c0025d2ea4c57f9cacabe68104e70972fbc40bd3bffb739510b1f0f9485276843a2d3af2e499fd10a498f874ba0747a907fd5618345c17620cd8a1739f1146e028320e5407f9dd7cda251c557390dd04b5113c7b84a0c6a267a267cd14f81f5316d926a6e1a1df49939e49219d020d9461db5fc9be95fc69f2ab5cbef8c3663f0e7b9bce53a680489eda1680ba038d2d206464051f95b2784f29fa9f2cdc039714fbd4dacdcdd7c8234a9e3af2479cb2507859a1dfdf2d8225ab5692154f0a5315e0fac045c7166ba1aae298290f85fdd5a92ff46f338d151a0fcf2afac9afb5236cfda4453721d56cc4951aff545cac09495459b17f74300085f3a209efcedfe917b1d9ed8730cc0f0192a6751600b4aa16fa39938bb44d4ed2553b8ce07078c47787e4ce9bcc1e7958261d439761ae141a838a3044efd995d2c52c8ac2b2d9167356aee482bcd694eeb221d1e96ea83dfc9e9c1550a0fb6b0e3076fe7c91bd59993da5ee3bd140d298f1e36c69c82f55e135dc53c8d5714bf357d831d7ecc2092013ca59e6746585adfa521f176cd0cb3a34dc3ce5c2c2b2e61e15b1a0d85dcd4bc0a214909c7f07ed8c9d3c1adeb2aa528446272125323cfda6d951327e518f1c2db1985ee16646046b9bc9e19a0bf315663fa96a5fbcb86b4ddf108a29fc7a068d0f0c3a74afc338b21d958635ff626c6c0a1b58d1f4810564e08efe83d20e0b4cf81d05bb7ae6657d84550f589012a85322fba8b0d006b3bccbbfb15aa26be08468e637be9dcb81fc666ae213b213989eabb22839f446da3c315d3125bff744c0128c0f2cda481941a16d0db747c3435ebff2c1881ad3a84b6bf9116f18753b94a6a59a833cbe737f5b3b9987ef35c8912049fcb7be98d707ab75c513be3883aec5aeebb15e7b31062838fb2e53f2cfb1aa5a5948c910c8e1e8f4ff7ccccb5f53d18c86fdf24206432dcaf90b7b1443d285bcaab41360c46f23d479882ce21d67a841433df28bc38a2118372c902f0b849921662f6cc260f7cfd514e325eeb5e611e2ed9c2a786c829b953f159fe5bb7ea74312dca6604ea370b261430c18375a70bf0f9edcfa311f11856dbf18e7abbb88daa9668e979417001bbda0e06be79f9513664cd1e22f66b1f4bb1cdd009529c495db76a22f720152d14552efb11f294f041fcbc19ff8af009af4428632864c73b7211bdb1b836f4d31f0dd4fd438fff577d091f768ab93e6ac627e23ece847f4b2e5bddabda6b35b2a57fa46573ea0a62963f8737fbd14a0bbd2885014b441cba2d181ab8e4b54e12e9c5d77cc87d197d30261bfe04ae2c79b3bb60b732322c627e0c6f777b16aa011e4c1109e35b4f4354462fd005ea9cfabba4fd815eefe5d4a66d5803e8f827a5d2bebaddfd3f7f6ca85695e4034c8be652a65799eff974a8e7e28e255880312403f5902b0151c4e75f81db939f9ff83c3139a831bf04e576437b845c900bc0e59adf69c4ae9b7a6920257d6500eecde47cf3e326f218e9ee66698424176dd48c1261069b60252b5cde8e70b837c467ad7087d5ae65066090cf4eb8399178dff23b0b3c744bd0889df80cda5282858f48548a4d79bb81d08cb920c361ba2ae9d24ac62e98ec46fbe07baaaa73e13e030ccc2af6099ac46ee6d669b985c04dbad408ace27cc6a27539d2f5980a8b7d3e4e36034260c627301442be9dffd5a0e655d769b638d02b770b1df328a5c042e9ee62e0464ed869e7a52cf075607c98175d4e908bce6d37fdbfd3c4db235107f1f7658b0231a693125abb039afb5722c3904df19e7d1222d151dca6236ce74c94e3812425ef22ba542c264d146934d9f27fde43c9a15b8298c261c7cc4837b574e1cafe6e24a832f9babcb62b9b5a274142d14db9586e0e1bbc4807adec58788ce9cd42389c4ef14d24f79f30680f3672da99f69fc87bb76288a42f42851770d292413c7a785b03d6d0d27faa3846253bf8ef5a404bb162386ef3d4a440b4173a235e36b349f9041fde4cbd23f97701fc34ddf8e8802fe9787f4aec309c6963b60e13afa40e2d277405c11ce9214daca18da5b1124d841a71cb34e5e512dfdb462c26053cf32f5cbc058c0476e4ecc41dd015bef6c78b4dba01f793972cc5e274de4b18bc08e2c5c2c5a52bfc14ba8d36ef2a73a290041fdf0e15a3129e9dd1c289a3e7a3637c8fdc977a69bad5442bd436318a2fc69293fbe2202cd3139046e722411dd1046ee291dd3570cc4914d5444a58d36e188ce0547cab8a598edfd5cb77bdbc51d78fe8b4c65c9e595c63428f06390bbed931bdc2e972d976dd37dfab1b0038262eb4f431609d387ad78f1cabeed57de7e9c820813094fcc39a65c9f995024b32e82c964b8857d82a40e56904fa3fabbbf4df47ad137ce5c5ea242c66588e03af4a8becb6e46c1595a5c54dc8974b1b7377e3113469a645314f17ce860f83369f903ea07e059922d85d263c1613921436001710490861f49d122f7bc1c2e4b04f82c586e6fade022ab2b1c7b6c32b3f4d19d0f5baa4f30f7d22174e06224483aab9cb84aabf1bf94022463cc822abc0ef7f103f2c6c1388bc4ad0a99f99c4825cbf00da7fe3f14718ad65a6aa163c65a2ba50e8e1be7276c9b393754c389766c41a9532151c68801d2d3144d00dc7a9e9d499e86ccf4c2d2aa80434ae94f18f21ba0118a956e3bbfe3092712fb4ef2392d5e252aa2213526d736131a0aa35016872c1e9453798afbe5734405ad1fed106c8474360fad72af429ea2fe358326f8e79da333d250eab9255a2f723bf9798b84d5eb2caead1b8777ec079e0a4c34da900536b603ba96063618299357504afec965aa4f7691b895f46c6e79449d4ab306a510683303e5bc6237c127aa5b8499d79a0e686bc937cd8599dc66794ad5bc5765bc1e3851b62d0fbe52e7213242214c7c5c90d119de12cc0a8a67ad711c4d5657456c0afddc9fa7af1851006d21bcfa9152dfec9e1362f054bc2d5495b64675e10cef4464d30fbae4071a986da183cf079325bff6e2ba3771c2a52bcbab8f405ccad6883da10c4959c20563b16c9057a0a7583cc44ebffd9f5c2f0f3a081a179b6f23b3ccd2970f6aebfee65ea3bf10789ccf26644dbb25a173fb4226b04805769fba2bbb754098080bf73dabe1b23a2c5613db52df19ded8072c121fcd099bffa617684ae519a77a7c05fc208e3cd562a20f5489d05f2ab6db39927aa5901644e438cf6b62fcc967bd1af941f247899b7274911c9b387375eddf850554e92cdface8beb118df60c24ac44b05ce92b46b0a9563a04e11873cb9dd7ce94ace585e33f0fadaeba8fd14ee3c7dc628c6283def6050d119af986d778b2c7ca0b9eeba51602e28f9676d0be20fce2700b6e93d693226972c7616e8bceaf33abaf826843067c0055f26fe25833d888ed4478e7f7466bae6c207d99e6a4117008113de1ac35c4507ae055357808a90cdd91f25b2a3ae074bbf4a71d3f31f784c6c0fbdcf6c72fe8de89baafac5f1e88775ef530374ebcae8338f752822be829c380a34a09071bb7b0394dca4754e505da8c7ba6ab6f85b5b36c02c978694da83448ff9b9842886e81ed17e465d7b600adf0243fdc5cb734d23b5844b8213a85c33008c4d7297af50a397552073aa9cab33b5cbb8b6a07adcf475b6069acbbd0ec7eebc2f76de7ab9ab600b26445de4982d669981307416595690339e3d9d0e6df722ccb16d0cd266502c17ba70a3174338c455935be51509470f57de6d230494f104f48189e6bb41552a456277253d0389906c5ac3c9ec3db0669fb5d3e30567be9557c75970a48dfaeca7651bfd8288a8300a25cf847b53edc2063586966c64fa7a0498a58ab00bc51b9784bf4123979330f2e083ab3cc08dc514dec28c5ea4891537011ac1c3557036213da4e18195c113b29bfdee0cf5a254b9f7ba975c7fbff27db2780f6e95f0a5b7ef4610e8ccc934781d6227b3683ec4ef86f6ecb0a6ad740bfcfe71cd2588da96fbda700bb81ff6abf67047a30deac19564cfef684bb2e07e35070a7dedcae1b884f58477ccd5ef221bd0110da55f2ce5fd6e120dc9ad22bd13644d107c8d164576889d16b04c6b357d0f7fa9e31ca77f82b01f3736643c5fbbc4c8bb5264bdcbf57e2c5c8c952d2c348768808dd47bc991e9f8f1ad85e6becee6a38776eff6327d52d4d307c7f183e095b5bb076e6daf3aae583be5d933d6f20e7ab8592d3bf4da00689b0bc6a138f7926948c0acb8160e4502a1bcb48b4a2a37333c98bb9f256233c5be2a35b70633b9c9c222d6f61e4cc8a970b89a8917b68ea09474a01cdc8cbc4fb3b1cd64036975e276f5b2e7816b478807124747e6015aac7a9fa768aaa10813165ce10757dd35a80c3a2c55a0ff1ecc6d5edcc36b02a921bc4d5d04c40558998b23d79a4262d5acbfd85234f65b007035c7681ca898efc4ebc4878d79fbb656adb371b0975bd7bacfd54364625ed31aa2ee02e7b57aa2470ed73f514c3e7b59e237765dee9f0bd5b6000b14cce1ec69fd85d53870cd5bf13ee75c7e3d22533611d16710386d03f7683a2b83da97a4e77aa753a0c35effec66d1a3c3519b8374adeade39c12abb417bbbc119ff982c41ba1e952571994235cce5733cae635bc58cdd355248b44e2b5455ecdd4f516d48631b531661c2b69bec21181a65d92cf41d032e7e8fe96372d0f9e6e147c86d780ef7b88f0e2e1f97467dba03832826f9f82475c30dea0e7365068bdfc4964cba5b63a5af7190c3f474cdb9caaeab3cc7f3fb526ef2d5d6b3f38ba575eac3316e4e596e18f8cd6b4211ba8269078eeaefec4ecbfe1b36ec17f5d13365f8b342fe7cda7a1173698fe6ef3d9dbeec6babb2ca3a9185f3548de72d17a549f06ce5964f0be4ea767d4a52a834c9f17545b52251907422b6ec1e497ab5d72a70a1f2f127862c2ac5a864b2053d70cc1de990b52afcfa770845059b8365528cf9f7c953f92831845697e573bfc2be07016f4a163889f0d5b08bd65a6a109cb0afe2f4f2c07d56e4f2a7e9372d81fe78e4d0973dc0a039ad5d72fbab4a6bb1a0f36728a42ce709c488fb8011f85c5b8f5d3365962137408487744eaef9cbe0e1f6206d647db33a2fb5b41af979eafd6255d60dd05aa03fb31437a8be73c223b5004a84fc11b00caf31550462a7be2390ae5bcd069b63adf894d2225a0d165c0c74aa788a14f96813ce1bc39cbff9b7da5189421d07919c3bd28285b682dc485ad8bf0c0444ff7e810378d4573e00a30d12f461fe174c4ff648fd5445059829da92436137c723f407754d7638e6a4ec85ae829e9d9bacc41199a3eb6441f60e3f07e0fcd28e8611fae6d506721d9fb05694397ded99e0d009e532edb673bec2d23c43e155a99e7095c13f70c5eb7eea83b52544242a9a22859a8158abf541c0c9ac2ecfc48199f8ea31f5d6f11458b92e073447522954f905f62adf6009a499b8e7fbc2370fd9b60fa94ad75768ae14941db6a573bacb05be3f58d13157b4ac49f64684cc9d5f8b618a39b786eb3e14de54a624924c2b1a7b65b94c61b9da580dac386003ce36776b69fd9617d31270e95bbf0026faac2538beafd88244d8d520e8f88a251907a771f72069c206a1ed1f158a8737c62bc8bf1116035c34124da25cf925c4ea5fb17ec3581779b6a2b1192c5b4d5cbbf939c9bf43e23a7e37274c8aec72d9380bfb69bfb82ab12c2e44aceaa4bcbaa297b8f2aa1f042e167dcd2cca76c41b7a1905df3139edc7564ef96c45d7e9a769108f15d64b5d270bf41a7d7aa652ae0b6268d6598494f712a81ffc6ff2c1c4a8cad0b00ca173354593523600ab90e883c4170a0c777aecd00e195a0e92302efdfd1809c0cb285136be9b5f901dd2b2b9bf45b24e608d5eb270cec89bafd1135aed47d1dfcb4b3b0359f8573b04b37e5dfa04ac0c3b3d5a3cbc58f73d3f78ad2149647719672d9ad31ce84d18c02798b643009458a6f8345c9ba3f0019c36ef2069d8b4376d33aced6a75fb1aa238c55031251316e5e2456d4ebeac207fd3fb3ba48b6b6e68e5549e074b78ddcf6371dd3a6eb4898197880e226afd12f9a29ec736d7d5723ac2086328830ddded1699ef2407ee1ac675f46c0e96a8b7de144f06013c1c913d3ccec8e2317b6d063e9593b1f392779ad5ad3d5f91eed52b5ba0954887cd5559d51d26d358fdd7262043fd3f6eb7854ed309982a3711b2049c8aab2c7e71871722f8b0243586aabb1aa9dff96ea387bfa809f926fce011dd0691ef2146f20247dc189a5500ffa998be0bf283decf61c8cf4285f2c238a39f66ab364cbd731968a1502902546486c612a4ab88f8528d4bc8a4e65159f96845aeb763f9d8e37e40dcab2c5c9c90249286dfea6e78be371494b97dffc75a6a59f7fb0ca07bacecea78430ff126c1fe434888c50534bec78d9abf88c1b130918931d5ec8eb186b7621573256139a51f07ab774a4f15e8b1dd1a4889e1425075b91c464e2efb5544f473c4698d014b758b32818741c0150568009f27f0420afc683cfd49ac72c96a1496cb390320b2c9c759f1fa58fde36304bb6d535d069060c02693588d106d49611be37aed3c570cc8c95ea12fc35a8f5eb36822999e83ccba745fa6bc9a7427b184cf799537f63a554cc3871034692ff4c1dd660eca7b33046ac8c941e477fa5491001af250cdd7ac2a23fb8099e5b7744905279d2300ec8deb9ad8b369f7aba36e2a459de1ce2ec76330d312f5bbfc24762dbe3c7aad0070e9886dea1e38ab59d24a68ed4459c935acad5cb91d61b0f01738fced5aaa46cf1875465ac2e92ccc573e6e54f0d1528707c8ac64f934f4459c4eca5a1fb6e1836c168d4177044529c7fe86faa623f9ccbb483746ad712ec4f1d138433101c8dfb6d94c064a945a7473acd552e3bb9efb064d81b8336e6e333869d1dc8e5a43047a0826b73189a208f1839ac19d822f339c3e81f98b681a68283aedde7701886c4d2f6432d8aefb1183da05fa756635a8d6101bfa0533e4ff5e2f38efe546334f3f2646e7d3496f0e7e7d333b3a6683b190cec330d8986a8110b940403c6a622a716a3f76e061ee34d45372f8d239c3264b4d44b0e33d18360ac5688296c7d7c3e962dd4988597fd44861efb8148f96da7272135de93455ace09aff33a8811f504df6141ad522199975842e7d67152e99bb7bfa41e2b8aee8aeee3c7fb36b4a4e129d5649e4b315db3f93d407897e4cc8b9ba83ff8d37eaeb3702526022642b4d37e03a7ce3f7eacd66af2c84c329abb2548643cad40b3ea2948824ad25912110deb90ae6f74b9311d7da265a5e572e5498ce31990e6627eb87e5a38844d4e51ac17ec869d76277f2cf6a5ba084867794740e26434bdaa4b32882a716bea011b6f3e8c98fae7ffe54f93a7c3f87750476583dbc5e971df0706ed30b5b4fc65258078edf0fbaf4586d40a8c66d5192678e00d5803e94b17ee1c30b8e2f654374d6d752278cd7635f02895332d934c0eb0245fd4badf336649c385f11edecb01461bbd02d5f97a9f09caf6c8045f273fe143caae9d29492723da3bac8d9aa9879a610a4d6723938169543a49d6213d9f78912a1a5cb6759936e2727fae43b3c57eaaaff63a67a3cdf6bbf79d18ad38bfc1c04d0e88878929e6d1a95fcafd5b75a7bc79e52cba82cffdd44991e5bf32b2607f4f23ffc0966d393489c7e8427102862432e9653920ecb640fb97cd83ad502b46079173f32024d6eee851eb0ea1ede95771e3c23ed4fe7d1cfe02959ed7b80a1b8375a01d5d71fe9492771ca2e36dedbd9f14c264025c20486888eb1558cb1cd2e84f60a6db42a245ca548d6aa4487d6f8e349d29574698c5be323b56231c21c417e9fb13d8f28b88bb0a7b670d1671e509e05b938e70be5025f31d15a435c80d9871092a5cd9496a82a600ad89a0874c3a9182eb070e0c47f5c4d6e20a63755952410ae6e797579b09bd1976378566ebea56fe61bf10bff9418c0dc42fb5166e9b26d63a5919d22ba22638eefa769cd4f0baf87c58ae6bc05d45471384b759315268f6462cd9c419508c09fb3780e80bcc355a7369104055b8160b1ef184ae5dad9372bd34dfcefb3552dcbc8015d1c0b6ac280d40e287d28434d4dccf8a16ccf73ad10e55e21aa460268f049c90a53c0097921e627cc965dd15b88a103acb8f696300a999cbd11489b1844c73418cce46a5cec33c046c5739cbd1efaaca950af766a4c5eb39530acee419f00832b48adc74a005c9e8f740ba97a6021d4ac4ca14d5a760b59ff4a5d31e0b2afd9b7271903c0ba637392d805750d6d8294505e0081d4ad6ab1ef0de66fd15429a0dc880754544bf98bea9ce15a7e79c9fdae87787a31c97d3d6a162f0d95f3f7a4525bab2f13ea544520804bbd2112a57a2102e7d93beb9b7a39099ab6cd4e28154eb37aa8953010713f4124ca8ddcc3207a85d59f116c08d8bec0cea54b8a1fe07da100cbc9537ec9314694f67235d616576fc288906fbce48161a2e2014eb4a1d3dec90c855c9ddf85256ca0ac757fb96a6f70461aec7f0f0050fc7aeea2de8ab3deb55aca9dc7b2ffb061d07bbdd87f61c3dd826ff6e22c51845f20ee49ee3cf97d1dad3d60fc5b9930b8ad6caf1f01663a0fef4621c2715e3e7352827817274c85cd8e91ac76647246e050c91579f1d8058a627cb2dc6c54cea6df6efd68b73cef08ed25fe7ffe7d8c2d9863d197d72d0bf4597a3b5a849b976fab944985144597ce482f352e144d0d33bc31a0eae93cd38f0e29cf73cdfe8ac087c63c5ba5068552e98d2ead4567fe33a1172b9cfd6f502e0f29a233d2ee827bbfbce798113ce923d60b1137d4fbcdaa58ae73d2ff82ead9f570e074fba5c78c4275bc8a20e171e41c4fe956f2a49d21c7ba9f784295dba386ca56cecdc2ba2f8feb74a0df56a32abfd08d2a538d2528386c077161714041be7401b71cf8dc8ca359f059b173c5a56228477104225d616af3e937a47b3709faa0e1c01986257742f8fed0198a5565d2d36948995626f44313ee9c86b2a912370ffded85c12fe3705fd6132ab0a9584886d86c94bfd8c11692b775c50c881c7ed188295d14a4af18075f689f948f06638a889845356efd1aecdcdf517dbcb18ab261ee2b9333b421fa59acba7b25eae1caa0c6a6d1f57ed7bdb613928e0921c8d00c91a7228ccb4010febd21c7bf7ef79b4c89770af68d5ee9e8414b18542e313dfbfbebadda2a4d97577b087540234ef2cf0e5a1bae6bbd06e5860b2f50c408bead45b38a2ebbd1d9fb56256e2199ba204749d5ddc16176fed5f2ceda953fe6e2fb6ef51020570b51f275d4e7d9e1e3b1af9c4a0809c453574ce244cc92f9bf694c508090be8ab0c5b1d5a03c536b7ad5948f617bfc7025d3539260325c9e5e5a4a985919f8390dd32da0fbd73678245dbddec083ba581a286395d8ca8981e8befd309ba2bc64090324b8c01d40517a178dc9038fe2d1a76793b775dc716348f8e288cddd057cdca3f85c14caebe4aa91ead9410ce809025dc59f98910cbeb3b72b86804beb691bb357842ab4517d9a44bb44379f6eac6c44dcce31f3a81bbce0fa5e196f5c679a27531e3f78b9b2b740cba10896eed2d20bdd472f42a1530ee3217239e17876488ac2851c3b353962b4e3487f66e0519cecc8b277964efdd704df2fb3c0ae23d556ab973064961a1ce3f796e3de5e6c31e7947c42fb6fd83b1cb2bdf77b117d2fc9bbdd8f11d0e3e8ae1683ced9c1c5dd66e632a49865328897af7d3cab30d4fce7fc73b64d3c6617f613270c3548f314a6f19152f1a8e7f84d472b8797153ef1f3e2caa077c750297509c1f11947fea1e3ccd3166a81d169e79443d535f5913bc699175710674d6ba4df29bc5714e278556ffcca716aa99c2337554dc0a9e17e670a9c1e026f03b76044a9db97462e98ed8d9b752ebc43ffc2442252710e400b54ec5319f4ac4ff47776f4569183bd7130b04c9d234458cf25ddfecfa5fd3cdf40550762c65f204f57e8b253edccd92e2b77a116ad69846892dc86500934f0f4c306e1b36c9c57f233bdd3294bfeef671d07761c69a54820b1fe485ea9f704623471d2410f0c60be9f413206acae36c18a8b1c44660e3d8a29723c6c77aa92196c5a8c5d04b997a0601920fad5ee9bfc5e81a43bf251cc5bd367968cc1a4b9d1dae503107c941819c5c016edfbbe85bd310c47c1a351f53b28e9f5982d82d824cd866158ceb2dcf0ab3cda409fea799521173e1afd1ad3407bc9d7cc84d1a310763984bc86da12f7de6ad367adcff88e8ce3112b10766377a1e068e7050b85df0dea34e526afa06c3f642eaf1003d724f92b79ec4127dbad6b57d6c4209b489754424c653932c5871baff4b66a0f9f2aa664cfd12bf2e842687c625eb5b025d6c6ea71c93335a757a7307199c2a806b38885aa159edaaab7bbc94785b160027e8dbc74865aedf6349fa52b37b55409563dde4ba1d7a842676b6e6479c7b85608b6726951cb17a9860e1731807f0020f8e8eb2140f74461c56d973592339fdab4dc8ee11b329aba509a8960d417057ed5558944b571bf6bc916be4580a868fa854f971625f169b6bcbeaec06b33ccaec92cd9d91ac724f26e3e617e31dea2387fd71555923e8b3467a5d365c7e366e122af906ca80e78ea290d5b547857c19c5abbb33dba9d90f478e4a4cc5f41fbe4d416e7b21af34f4b4453644f3f1efe66a0343399ac63f3a5dad97f95c5ca266d4d240c2360048cdb7baab6384572a5b6fdc7ff3d1526dd34683911a01a1226b2e8493f84f04f7dd6f519d5108d75ac56a3359fd4884de193ef40849a5ca70138f100bcf6f33c76432bb936ba4755663ca7b430345fe4e6ecd31620a27fee95ecc10fc12fde7020cfb4a34552e292a626473dd96fcf8c30bef80adb459a21170d105a23a30078e119b6fbc28ed616b20c0d3355277faa245a0c93d27f59ad90d045cc73a4610d53afb0124d5db7a777934dcd579d00781452599b62709795eef1023f0b8cbbb4aef7bf49964a6dba5c2db490f5d44599e412a530f6cdd141aacfd273a19fa3091c380537e69e488e122cb22122a2ef2289af71ff9b5f57ffbc9eb4c31ff85c3ee9542aa3b596724f38d3873cad5788eab738e78b66f72fcdd87e21e73c0498da29f90bbd1d053b4287a3961d07f9fbb6428ae940f23dc36ec53770506754f34a56e35dfe08dd61aa2e3de6abb12dfd0faef2bce9ff4b2f076c322975c936c75c6ed9149fdb1ab23b22f61f6e9f86eba3ba4bbdcd45799beacd965f53a66ea520fab4f27e67266c98d50cf7d705f642c99722ab267ac815aa6d797beac84519b7c6c1618413ceb941e1551418d4feff5563f7bd53189baaf995406f87a026ae8137ec06a36ed6670c755c909181eaaa0782ecde51c055f3ca0304602c55b498389d46d34f4a0dca17068423ccfbc771fec6adff382bc4f9d4c8162c83ae9125ae47691838726b6c1082249e05bddb1dbda502fa99b49b0e8d5b5cefc12db34862b58e90a24e69f4b88d9627e8a029d029cf8a89e16ca002a41c0cba21e0a9b41dfefe5d893a21f4548d85f75c9f703ac212cce297eec81e92320da1eefe5d9fe11f7b0ceee93dc0d77450de37f4e74c544628b380208ff57a0744f2d3064c76671650723c1f16e5f3ef3be197f34ea7e548ff5e308c287925e2fdf184d8eea2fdbd15da68a350295401d66e2745067b8e2a7000c6f040c19926d66881e2f21047d301e1e21818cdc60ef9f85d44efe48bcc36454e89e998737ecc4ba347913087846d1c8165f3c6b0c24f3ccc69a25d6706862f6a42e022aed6d9f6f3cb070c0464b25c7f4d2a7148c1a1e5b7c4988fb5545a1ffeb8c0dbb843118abb70d689b698d2eb9319ff4c157ae9abb8f9e6ccbd8982d3f43fb6b3332db7d6c5b77aeed6a06db66596d88823b79a50a3b908004b72adf38e8a1ddf7517182e5326d210e30ffc137aa35ee29ca1c9d0f1578f8681605495e94b843835e7fe1be9ba8b73e01817e8c5dde36137fe53bdef8a434b8f568c446c21ab0fdd1d88dd7e2718453efff51cd5436405969385bce783c7731dd0cbf20032843050a3ec0a8c42e569b8f85dcd42525e56b9b08bc1abee266a7558b8897c08a8277776a609d10b620064d5578e938677f87fea3da53b328bd44bc77713fd72503b29c612b869daa9f2213300c43e0bc6d324fb66c37dc1597c6be92878afcca46658089d22ab5418520e8f79e65425583ea3d0471dd2630ed95175354b527c58ddb5d2239b9e3ba8eea914a24a09de0c60560982d11801c84c3a88113fdc9d5c3c259c70e974084c033558c977ba4ef33e0ef8bfeefa6a914638184e407658480c1f1415e0547f71376285b6ba8882f07c32b1237d84ddfbf41e4441bcf197c1102634ddb9d5be653deff6d7073b2bb6e267111dfd4f6bf21044dca4c4929f328922409ee6ceba1e6432083ab25455cc513e0cbb8505bbba4299b8d5ce129396df8079c9a0d9a40d3cae82e509f77b7dcd69d635852f6192cbde27bf771b719eecfc34c18915f5615318014c2ffe2935a30b491560eb0b23e3d75caf3789ebde9e47e540b05c708e392ed2760ecc7506552acba84c80398ff1b4e13745eb72a32050d9ddbb6f5dd29c82749eb71f50950d250ab7cc57887363891dabb34299f146bf85d4c29d5cb75f92fa5efbb8678c0a7a805b9dd3c88d9a54f06e1c850e04dc573f2937abeab8f63ff2d3f31afbc0ec1d6e9b93d62c97b81720a73f7b851cb5299ff21d1be209941a5502b2728032bff7e3eca1e127b516e577e8ac812565679fd0fd4910bbc44b694029c7ea4a6796698a3701af2e06ea6c751bde96a35b3c6d03587b4351ca922a6cbf036f6eb2ebf5ec0bd805b3bc4a06613fec270f71eb289d7ed8ca88babd93460107000065a10d49ae004a7a53e3ea5db4ab06903ff3929e0f53dccb7afef81b64f32403682b569b8de8a4b06d3f920a65319b0c699571c89f692bcb5526a87b199a257774e6ba38018a6bfbd738d30e83d27cbafa8a9d46ba15f654b18011b834bc44774e9fb826dd0e02fd3704ce2b234643ac2a985c1c3a8f7ba0cd803c2b87992b1a135e73ce528fddf268c6d265eb728ed3f97b71c7286300fc67791cd358638c81c40f5f84fc0b3686b21d784631dee41142ab97b0769878327c4a5eedc042f71820985d6add990591176074a7ba6d767d14bfadc05d472e2bcf944be620b5722cf5118c8ca87b341a6e17363a7826decc60798426296a9f94dc37e64bab4d1f640b6d337d14eeb2b8aa56aac8c8665d83cc524507bd3e7420c7eaec82d3879c757a1d566d135b74bdabf7db644eb5fd0b4550d872477dbf699b5efafd38da9d5ba6724f1fc9e9540118c2fa5b74b04fbe55c79575e586312f7f5b528f2894c0f2486badc2dfa0118f7d93d9a5398710be3e91b78b6c755b0cbab1d687a2e71073b2e1a7c4e271c010c56bf739bac1328cd3aebdf5fdccd50cad4742cb502d8114797eaea622c66683279d52563ba0b330f33e499494c85a7f8ad19047878fbdab01dba17d338b666d03bc22066e6fa035a10aaa9f4a706a3ef3db7658f15d2f77d3fcb9bbb41f77ab6d25d0c7ec0264d34bcfecbcc10cd0f24b8c4c3c8b414a6277eec07b94215b05a42e2f71d718b0b17d57279c5e4eeb7d36a1f8677974e4df044e84133faa53a224862323e9d5be796762053a58c1de9df6d87878da0711d8423dfedd7f7b21c39a96b8881453a30bf2c4994d351ccdb70ff0958d74636d673a9e6728c73f7f89d35578b3713a34593c42d40ff119ff17f85c2f1e6ae64e8cd3e5d7d51cf678505517dfcd521bc67cca5255cebdb9bbc03c502dae8a365ef4d4cbbb9b0b6b162322b38482d07330cbc6ddb0bedc544a11df9911d6f9283e2f99b3a91b2d4f0c7dde5e1af2103bda54d24b8c52d1c1bb4037997e9736ac1634d54c12b3f3b774bdcb4b5672e235d37eda3ecb5bc8b33733e4cd7d32ad5f028ff4e1f248170dca1b94ae0e7988b15fd99ef85f0e362ae52971f55f4932cc0dfe1bda8822b06698c2db0b8e0eb9e5c07a0ca21b0b4c30eefbb137c342b85a4616fef9d9e8e2126976bad80dac1496b1053115edd9c06db421ac18e1573195b2f770c4bc63d78b019201ac958ce88d4b712fef2619f5479b395b195990ebf81ce39f8a31441cfbd589f384cd13bc75dd72a3725705662fe11a2eea43a3261bd19125162ad1716dbd7af5d9d3108121f520ade43d14f41899efc4c8e5ae9e963f504986376472e29de998590db702a25f609f76aba9032dd28be3a257abcdc2dd675e653ed33c47f7dcf7d8b5896bdb2033e2d434742cee030c347db4f978b7883a5fdf3f108d55bf06e4f090b58b654a70cbb72d8d54e4e799e497eaab852bd1cdc8d2568f845bbd8b1673a3ef56939e879e1a6a023ff057663bebc45838579b11835974c77486afda740d53a5be9e368b9ad8e028d5df6792f7fdddea16aef34901200c5fbccbaf5dbc2d370ac26bf0f205b304351e13e1b1bb8e60d1eb668821f40ff003ef60f3887bbb4f2db34620a337d91e64f3c5be44093b71a5ed7b0213d7f3e00364a40558f54314f3dfca79e6cc6a742f4e47d820ac3adf95f753b2f19753816d474be7283858eb44288726cbf9815654944ad8075c012b7919dca4862017aecb587a5d066ef7866c497eda8d9ba1a44d96c2e513a2423d26c227d9729cb3f4b4330ef0f6d9fccdf0fdc91131694f5571bec261a436bcb38d65bd97f32dfc4d14bf4abe696d2187110e14616796969b01efaea88b966c4ec01bfb157162e41f316d8f858209866cf7abd355f5b0031b34e13a66ba0185bb7d2a1dc668d1c392a8900bb88f56f0e4471801c4bc7c3707e043ff0ad4940ede4d069a91b59c75cdf343d23e3e400d5957961785176711523de0aca3bfa77c09a7a1e5973a52eaeffbc1c13ebca3c1fd71045fbb855c4ac39a1fc36587624e5d3e5088bd9c9b53d26b4d7676a68dd941b492116aed504a11387c22e7dcb76807cf330ee73f840e7898c852ef0cd777577bad827fca4d3772dbf85cc62cd9b2305228cdfc5502d7541316eae4f82f3e03cde55a5e6254f5bbfd4a39131a309954b144a8a5faac62dc2c7cec40297a0b8e84dec66598272a78f88200718fe27f1970161101092ea50f6bd759cb4748273c34d367884445bf051f9532d56919e260be6ccb6f74a3364b7ff80b5d32013be70396877e9442d140d42b33764b44f31317f196ab8896fee6082231e3f8942340c8ea4886f2c7f2b7b5da553aba253f5b1abb8abead83e87ac185df4a2c0faa928cf6d1abd3b3d616d1f17db8bebefc42bd969f1f2ac07b91d5922ab5849cc8c529e0a97284f1caaea54e92b55e13ad663894e59321e5e1043b58eef434d15aa6566a46f3143143febe53c72cb36b437eaef9e2793590ae2892dd5b61b49446da15d76dfef410fd3e6ac31e6be465fefbe3c8a8333ef82cb937e5825254c58ba6603464b68d1e68ffed9bc04128da4c18e56f8d47072325b49646cee4260c6846baaa07e637da248bef1ab5da3fa6874762a5617e7dbcecc5e094cb821f3da3d60d9aee9751ad6677ef6aaee94003c5bb6169f643f12ab459eecd092a6b6225a2445a30f9fdd081026b448fea3bb2add345be0857c741923e3e60e4358aa6ae3f153042c7f52534db0a849ca9a650886bd14548576ceadcbd9376900507fbc3a1829f8a66494fc8444e4d0e20030885cb08a7db4809e6dd949a33e7b01fb66a6f9057fcfe6545b3badf5aca5ddf154e0957da5cc05b9c9455fc86012b5166d84de29b00da810c6014aef64db6da6c6c5fa97da9703d5b1f4476e2deae028db1041c1a254f4bedbaa2abda4cdca271725432babb9df2f0c5869f2025105942655ecef4544a70a6859e9102bb1a286ef46c550d41c766768a25b93e918ebc320af1da8570bff5a18cbe36d24a43c97c4a911db0abfc6fc871ab837eb6728b36f1395f9991a367bab61602f67ad99308ebbf4e831d4818f0b0b0ea94db2624c3663087c49862ffd391b0c6e732014a7be5f89ebd6d39d1e998be55db88f44f0270d0eb390f06fde4f7de3381609bac3722f976f73dbe11c97078ab96fa6bd39cdab67175ce4821f48e53a5c8dc29a24fcb156d9e5b2f72566e80fe9e9881a685fa5231d3c8cc699172bcf1f8e8be39617c016bbda9336d38c0f9eaffbbd6a1e2e4b35930598a4e526a3d8b23ee19884c47c65b9ab879de0fe0c19e268ae14e1b64bd5941dcbda6a2b7c5820a4f6ea4ee49ce483e82a78d5aab3cb7ba07b985f454c0441682ab961f0abaf0ec621bf90f0c9c4b4759f116881ec03014ad1146eb0e2fad51972dc0121deffd25fdd105e0d2a6d95874d48e198a95752e338dd37de1f656119c60de56e348810b23d6d92e9eb7e03278cead604ae48ff113c3cea81b985cf32bd213c8883e530a73c5a77ce427acb049d9d004034d374dd60e12b983dec927b7c8b4a39ff6c810945a2e8f7aa961fae2531eaf5b7254db2478fa8807436b4b88c4a921e578b4638ac8a1ae6dc0b14fbcbc9401e1e74a112af8ba7c205f16ba679782bab0a22263d48bb2e97e9862dcdb548cf0705fa10d547d5b7a1c3c7e42e54dbbbe91eca9d1c0a6b81a785b324612ad7f640ca064e3df56fd9711cfad00792585b712b51c734bd383f88e704edee614fc29ae0a8a5ddb16a74e2b2aa85cca73212b867369a181c0ba8a4002b58f97e2da6dbb5ae9c521ad33cc4325abb1db7be2da799f877691abbc771d6be914bb26a2a6ddf76f31794a91de938cf13639c5dfe0b0ba2626b700510dc45688dcdea0eba9574b8acef748f4e8e8bda0865a91dc8144573aff91e2e32c19c3845909c1fb2ce20b09e35215c0c81ece9cbb5dff368b4a676d6f859d0064e010e488dd67d27a587db970cc5a35717e42304cea4722909d81c793753f77c9e5f21ee31559eaa8474cef7dddcacc9cde62a26862db55255caf9f9debdb0e79526a9d37824f1d795d9164bd96f47da8678cd560c6cf0268679d4fcee69ad7af28e02d93fa31f6322940958821d69d698470cdbcc1c2fe0b2d9fb31d1c3a050d3a4e73eab80617a03a87b7da53fd82bf3f8f880ef1f9a3f133dbd6f2b215729d38b614facdf096fa22df43fcf40b6fda5c8ed1d71f5c95d21cae48dbc43e654cb76b95753ab00cdf947263e60634c5b9eb8a4b941e91314b1ed9fe58cde7b72494a87b6be6826273f85da88a89d674170ea41ff3e39997e1c722baead461a7f4d28a91832d6b16eb5c31d3ff94f267d07eac98a77173202ebab0ccf9fc409575d462333c93a4601deec24de0fead4c6c395a2bdbfe09eabf737034a7920e7429db84b83dffe32834f9026ab5a39f5f19cd94190a6eb08bef0f89bcf81ec752471c9106ed06c323a95720137b74d223076500cf58d2c0b794b9b4c26b50a3102a472eb0e3003d4ac949b01fcf5f61ee4eb12a9cf0503a4d04ebba2cd34169bf0b2575b21fc256f39bea6426dc50011082203edf9a8c8cfcb2089c4fa8a80ff388ef26371baf89bdfdff59d63353af7f9630be6f0755ab6d956e566da3551cd65475ade26034ee6ef8d04ff0629c54cd0d95d0b5fa84f022ea4dcadd1dcc90b406cf2eb41e3dac1ce6d903489dd90ea80583714134030c5a6e4df4ee5b88ff762b0adc550460ae71b4be484aeac103603f674ee3195bbc8094406c6ff71926b58b0e192a1729ef550acbe1ef57e8d1e192403977b09799031edcec271d9196b6afd4c9d97fcf56fa5094a9308e9be0c60339b24c372d20b9aa77c825a75835dca34ada959c8a2ccee03c390401e663200039df0cf198cd7f9deb98b6b40b72ab1e3fa843449d0dd907691f2d0f3f8312d37abe719d0a6aace291ca0d45a5c730297a66ce4498139623022020a5b21d7e8a25b1ff726a5c5c67c2753c4598d5326b5360bb36a135cb119fd8dc236823855b5d80fdef0c8fe44d0f17ce0c86412329f02a61bf5d59506c765d5979a3a5b34304abf657094bf1bb85e4ada755eb6e0a8124b8146a5023f1219193bd002ae23433380b7d18556380ada5b8c0187a3afaf528a13fd49cd375458eb5d99ed2d58cf3ff928dc645e728cbb68ef765553ffa6d7628847da36e8a7c1a72843f423e5d672def67a4b76d248356d02f7e2ed365ac2289d8033f85ebfa7cfc056ad24e6350ad14b9ed415fe077c9b018e1fbd691ae8a1aa0b3f3ab4c7b7ec6d0bc8b0f10cde136a8416d85dc25e123c415d8bb5818638986d924e0d973ab29bd08ae8b757836296e00ec35d891cea6d648dbf2712867bdc94dab65f5c68b28654ff0cd3e917c745ab940f2a1e08dcf0ec74da08843fdcc13944e2671bf73a721319a3ef89fc183e0ba3b189dc97c700e468ff41a84aa7c4e55337a8dde8a7afaa3708ab01a0d4406bc376e53cee7170e481ec41e27d82094b65f2bf790f1c289560e577f18c4c81f0c15dd035b7dfae1fe0646c3a157f6655e94b2367008e6a4700fd29c08dd518e2b9c705bdb013e203629253ac6abfb240a06d6973f8300636d346379fb262d5e34c063ddd16dc903c00e72df02f24e4edde47b9b403ed86894a7351ebb04b2b901b7ce586bae864031f8f1ece5164676e3e1ebf74ea1d18fe8c50016f5c1a842f1e213b36e2de3094f8635746ec76f1fb7571517da7df0b9a1deea1a844924dec05271f0c5351a562f81798bd72ac2b5743fb16de44cc817b2072cff63df1f27891790a7c572d8ab36c2a8c702e304de30a78188059c82b258eb4faf903c15d385489ceb336790ba9b608e03727827dbb9e9dfc0c58de3c917c42a365f3d57decd0015220781fddb73cd95b123ff1f45c3bb8894b242543cc82d8b10dc78aab4711157e1e786d218f466c96683654d48257635236c8bf3df9c732e01bc6845a13e35c7a0a7628e3e36baff0fa164f89daaba5947ff71fed8aad48623da768d21315ba69d8f665c7a5cf67ccf92eb1b9860629615579f7d5353ef45fa5ee43845aab291a0d52fcfc78f6eeba12a88c22144006b7172697f34d54a0ad3f5abb635a884766073e7fd7e7d1f901896f90753685cc70d3b5ca5c9ed6558610490a96815617a68a8747d979c05527ac851f23d15f00013b531d814342accada802b09eba7f1a1bd1fa517bda89b925a6fbcb6f0de573bc34c4414fa049cfa8cad0ad9ade3b9dbb0d1ebf55cdd1b72e693ca78efd0ef131b07e6f8c106d5bf7e4aaad2fa2492eedf975922f051f2794e5a468a79f1a720d6b3d6d7175c03a9db6974514d00b5e7a2a7d7f9090a90f2cdb668177c55782a8774f0d960f13af73a78e8d746ee45e88115b4dd16922c24c647744643d8843f1160715943768f64e14fe53ac759ae5c5ac70bacdf7b9ee4856804998e694126092e1ae17066aca07d2da94da1d32f1e48b94b42b1403c24cdca32c2b87aea0bd344b88a6f9adf96283b3c88f7d72c2b789468c074f1b8819f9cfff7c1e3373e8c7be3167c5cebf7f821a8da58ba677b3ce84d34c7e870712af8093c0002594ab4e845d9852c27f7ae881c1187a6cdd6142826904d317af0b0971fdb5758050bcb10939cf11a6780faead2187d61952511c6f2a4fffeebbd9b1a76fcb5e671147b9522ecfaf9f3eb594f4487a7fc00405740673c8b86324af7b2280f1d0d46203ef06ed80b0dd3d453c514b0f4f9c6e06446ab8d1389139a0160d4c3defff2444bfebc0503d9664f38a723810e5edbf7239a08580f4ad54ceb7b04aa0d470b8faadd3342aa74e6ce21648a7dfcf87e46df3809531f2045fddfed36fab8ea5084377efe35985eb3c9a14f6390c41f7799a7fc9a58cea4e7a8c0a83c6e22a62ff1560d729a323795c16636b6d82e031ad3723fb2b43a0fa0e8bf4df72e20e3c2d454f1d18c47c81f163f97fc9e7abf8ef6eea15ecd4efc1df2f559d554f4f1fb57c15a5fc7c86a8859565bbdd99d485ba50c4d019e9f7fe712ff4313740db9726e6de241d7fe8be6fdfb06c55eac451b17e18c0d2528c7e3be868c2df632e3b4ab791b39419b70ab08940305314128d681f9871413cb1302c20e89f3acf9a384359748e6f86478e891c882d8dabb3d9258eed74f81a30d10f02dfbaa59c4379921c1c96d4f46376ca0dc253a80d18849f1e795b03d49306de814a5453b45705cd1a010c03196c50d087a90768ddf3c4fd97c6432f58137b3fe517261938bde99fb69995936fa75747cc37fb8dd6ad62a9d9c2802d45ea98245f3ca3e000011b9367de1c845a741689b3843554a1b7f59722280ca41f5674276da77ad4fc7af4d635677789f8ba013c1261c10bb7edcb23cfe2a520dc54c30033ed998ede4ef63a6f58143fa19aa23de6f6b837098c145bbe948b77be131a2522fb229189bcf4a488e25a43d18b86356902b9ec07991679aac11ba5146a90061fe776157df2733ede554665c6bbdf45896a224c108ce38c5b3bbb5ff978fff841f9dbe36fbdf47c733b243d4d2a7b8eb731c1e71ca353c24848d8314ac23d1b4257c7d1b2aa6087f8c2d5507ea69cd94027780978fc53f04b0ae8c63b084133ea6590dddeacfd55777e1bf1aca625dc8464f9d17229325ab2f3078d4a6f8274a3cf4961607e93ec3eb75361287b2ae5d2ef4c07557bf4dc35494988bcec7047e2bf1cdfc9e56b3fb90e04e27f7a4da2e2dadd12f21064438a5e9e26e5dd98a6ef12070bf81921e4ff8891860a3ac90418460bdb5ba6130f1767c34c8ada7d1be944aace3964f5d17975ce17ebacea64cad721d4362b448045cab54211ca9972b549d5f06d95f39fec7313482408f3d2663cf943b6f856e08fb4c598b6f1e21bb1e261e4500b17521dbb44aa769b6fc344568202ccda2dcbbced2c217ddb1541baf077b0017156dea92975eb1e24bda8279a7e023cb343160faa0f3382d0d2a67b6e0d9644c56cd77d8f73b9d579b0d97668fc81ed06c1ddf42cf5550de257c0684a3428222e255fedd8f51eda09bdc6461e88c1d7beb7b7b1fcb194a040aaddd06c8da3d6b2f383c47405038f23bf56351538c9b17b2dddf40dcd5cf38d42b38ff582b7c92870580ea5d1fab0dd6441a4fc2bc9ba9d4ed8694f0bd89b79b9a14bcdd28319ceea24cc2ee324a40501ebba724f7e1ddbdef2ae8badc343e991a8ffd18c26cc63aa487cc653bccc7a17626db01aff45ac400e90a926a2dc365ba17d829124876a14e497ab2de48ea838c5a63b7bf16b4e0c8fd28ea99d709312755ae158e039bcb2588f96eee7a69294243bfc29c918df00f9b3a3154b5bf2a06f441dd3e7567a5c69656403c63c2c26a728a70e2c673220c238beef1471bee6a2f13841687b20124d642f9756492ebebd3dbdb7a25802d50f539dce83b9e9ffbeddd6f9100ea10734cfa22128225b83f1a3add59ae1f0809b4ea0c0416e75700fd8600f64993cc4324de0012d248824ac706d86516d0685c9222462b2c9a63a9c0aaf7f6c2aa67b7c8115071d24100efaf0f63175a406f833c6096999cd7a97eda26ed51bd948da284b06a286580eb14e3d71d9aea950ee3df88d456168799511eca40ae77252d6f93135da2cdb2868dd106ef58a9487b5161c94bce389237d33cc84f9d76023b57392470b8a8ade9cd4bf7d5c0276afb810d1a84ac3f5959381322920959a091c1303cd7317a77f1c3a7f2c637dd0105008f8177676163e50a4ddf3872864944da3c5d7d017caf93911b9e5f1a6128109d7f8170fffc5a33c4f69fe85031fbe081efa7471014c270acdec5687d90a966d582523cb4043afde47c28cfd10f2e398e1dc910a11d8f0ab513511e40cd4d2e118b275e5a8c1277354ecd26136ffd6d271d8fcbf5a6d810f36e71f67ab29ee644f5d78c28a39d2bc89acc575a6d1a3149785054208125506d8f176f68f5ee2e86177020e99a73534ccee260a8e9086be8c55885a9a67bc038633d14fb82ce5305386e1aba4f7b2d72e0741d88d93e8d253515fc50a39097a51b5b6d60745348f6ca83b273cda5db2fd79c24a7a55de1f73949123bd917b90cc3ebd3b22185826345c0a5c5f27640e47919ddeb4baff4cc2f2f2befcfc84f0ba0b2a33c6ed9a21dadd35cd013afe0b96203e1a57cd2ef99f9da2d4b2d23189bf4c890cfbafd1341689a5df85273219ccce6d1eeeb7fb5218baf47d4094c57640541c0ff57c645d6681a7104dad73a0839a8d859165d79165c174be81ceab29e31d699ba72c6e5915b651375c1a9133b22bb494f4aba24840a4e3f568b04229c44710796ebc1e49ec6a83adc90b101b403d7ab41cc164bea020a2bc11bab621109504b27d700cdb7c50a3cda93318d8995243a3b2ca648a5026ae4c0459dc427ccaaf908815e748753ecd21241eecb5449fbca03f2a8800c9dfef009954a6f3f8cb35989c904ac10f3a286f65f06345d3a2c756b25b6ca0ef53673d147353d0ecb8d98d25ad11c249afb7085194f3b77b54bdb</script>\n  <div class=\"hbe hbe-content\">\n    <div class=\"hbe hbe-input hbe-input-default\">\n      <input class=\"hbe hbe-input-field hbe-input-field-default\" type=\"password\" id=\"hbePass\">\n      <label class=\"hbe hbe-input-label hbe-input-label-default\" for=\"hbePass\">\n        <span class=\"hbe hbe-input-label-content hbe-input-label-content-default\">您好，这里需要输入密码查看。</span>\n      </label>\n    </div>\n  </div>\n</div>\n<script data-pjax src=\"/lib/hbe.js\"></script><link href=\"/css/hbe.style.css\" rel=\"stylesheet\" type=\"text/css\">",
            "tags": [
                "工作日志",
                "job"
            ]
        },
        {
            "id": "http://example.com/2024/10/16/post/job/05-%E6%B7%B1%E8%83%BD%E5%BC%80%E5%8F%91%E4%BB%BB%E5%8A%A1%E5%B0%8F%E8%AE%B0/",
            "url": "http://example.com/2024/10/16/post/job/05-%E6%B7%B1%E8%83%BD%E5%BC%80%E5%8F%91%E4%BB%BB%E5%8A%A1%E5%B0%8F%E8%AE%B0/",
            "title": "05-深能开发任务小记",
            "date_published": "2024-10-16T11:37:02.125Z",
            "content_html": "<div class=\"hbe hbe-container\" id=\"hexo-blog-encrypt\" data-wpm=\"抱歉，这个密码看着不太对，请再试试。\" data-whm=\"抱歉，这个文章不能被校验，不过您还是能看看解密后的内容。\">\n  <script id=\"hbeData\" type=\"hbeData\" data-hmacdigest=\"050c09c0c3b433c611ae89a8287f632bdeff2f7188deced23ad0b0c5f1b6b095\">2c43a34c906e7926d65a40b8b08e3a789ece16853979b723871f651d33396ff5979284aa7717fcab2a07eb67f21eb78f7e09ed5e3f04de492ecd4e3cb48e1dd4159b300da3f29f5e6ea56b651963dddefa996898d7cabc0b23bd0fe0887420442eca1109b35ded24f87822e6eca74880b7dae1709e40e3a234571e1457105b9b2d7aa726263e32b4049d41c25fc348c5f86c529f4eb82240a442c118ae80f6e41d74ec63874751168a6d43dbb30844a9c153669e03c1a874b99ba7abe53ae582d03c04688008fc694f235de8e54e26e2ef30fd6c8c2fd9e88192991e1c99a12a0123d1ed0c5ec26825b97b28cecb9d7f3b936101b282e2f17df587e3ec2ce713384ce711cb2d991575b39385835a2b36f7351e11606e5f6e8f1c68c3a5bd9bb9bbeb8b1aba6980e6dc57911265610f69bc602c610628276c37f5244ae3d8a9fda101e178a618713250a6e955d522d8bdfeab0b16496341ba597d24d12ded0c36e91e788b7ad4d9daaee7f301b4c46383cb1d5654a66f579d6cbd4e4b26eeda3297316c2641918d45733366b94d915c4101e4057fd2833d3876902bdf577f71db30eb2e51a1864d22fedae1d092821e171b801c35de572c95c9f172c6e6fde51203421c8dd413295c68068f25ac4cf6b570d00710101105eaf6013ee4b2cde99947856f48f94bdbc9606e31f2ba95db7ed3502951326bb32cbefee00b53d85340397795fd11303a9efceaf45073eaaf7a0b8fef90b812aac94a77817ff7b74f405bc6a8947c4e82b2b62331af13c404e6bca2969dd6f47406584166426b2e5472a7d8d0b4f4786121314852b3e3aa6f63e45448772f003e5030be37ab7c0b6c1a6edc638a0e261b04f66c2aa439131a1a937ba7723dadb358c72944c92308a0deb858b8bf57e72dc7205b27a67da6a35741d4b044f5c549cb2cc3399a70dd66e7cc8d252e5d28a3cc9f538e99e3dc863ea2905a547e97d19aa3798d3c4cefedbebd4cb916b40a5da793dfc09525ebe464f091d87fb77ff7112f74aee168d39edf198101b34e5c8e63c9705c7dc1fd76c99367a2398a2cfd749fbe528a79dc3b8c5493499c5f91aa0e33cd1999e8ddc1e3115d3bf69ef1848732a973563a8b30739d47d7100da3a02ade6a31e5ca6f463cdbcf77a0486fcd8da0dccedbb647a17768beb7efa07b8350355bb52616a72e5cc6d706cb1fe88424bbb3f71d8bf9580b5966c49c48512697440a97a3038e1f21b34d8a590aece55a8513cbd37899767001553b60a367c4da125d5d39c4b81d60e71961e709fc3a2ae3ee061b0aa2bfd652f19989c88b66b47ee6673fabd6753d07ca677a4e6e4f1f4b3544df2887882462daee8c5bae46ba84fdeefd346948fd275edfb112092b3149267e8f9ff0aa1fd364af2bea742309ee5ef226270aa30d8175113e42fd9e831321954ea06b681dfbdbacb05b513e9a2b537f5657eda9a230aee7cfbf747f709f63ab1e693c3c3b6dcdd5b3d1501d7a2bf647d307dad0af6b778c84dd9673bc7a3e417ae9dcaa642e7ba3dac58c37764c07bf637b22cdcad10f59845c221914f53a6b9bc126cc643e73d81a78d8ec85f74169a0802b3268d57135082c80d28be5c5b9233748044d75df512fa5f0be181ef284d250cfbb70ddb5cb467bebf657f773b7835101c8cf1785b0ecac165c37277032137ed17be163e5a4b32bd81bb1de7646b471e938fb4fdbf8414aef520bad3ba398b83af99002775a7f7cdb2e12e1fe061c095938199254353785957bcc6bf8aff521eab9ab0e74d1cd66caabe9d6b1d990b47a68b7a12a909195fdb502403e325b872f904f7d8c642f71c1afd11db45b8a8d85e7d70e8fd8bd2b65732bfe3b885a06276adb0db9f7e46575390bb8061a41456ba136f1eef56f101b7f31de418b30cf9070a6dad1b6ca0f2cbd93fa255673966dbc5ef3e0a7e8e7c08a682418f0e36c9f0efa2fb1b92e1a8e651642d21dc98a414ab6e5f04777434ff5f1fec5edf8a2d4c6b96c80c92483b92fa5b5d14a4e2ae24f24a516cf436cc1e40ef5a95f8c31be7813c9cbad3a4e7249754099452d4dcc6b018b55e2b9280bc0bb34ec4272bd2d0d9eec68c2f9e84f96bba51ecfd9b354801c5127489d05b0e995582bcc251d3266c164e30b787010488e732c859d7c132e85c1e4b3a9da0f2a1f49c6737b6b9c0dc1413bf066155db4a0ed5db28eaa0bf25c84ec5dfe405dc508fb4f9a6fc13775a6f439904ae62ba26ad0c6a6784792135cd5b0ff865b099041e76c5a5dfbe07ecd5eb832634b0e1647f13c5ecb37ebb1403c566a22bf5523611aa86f28c58a31d32609a493b3e46b817cd84ab27400a3d3ae4c04d43b6ce2a9bad4ca81c7aa0899334d311a666956a736a85a0aacc0afc326bc8c995401cc318b445c9dad6e3a214def736574e6634a6cc7a227cd29a3a9ff03309bbaadc6b4a1d2b93861e7c57808f5bb9e20d9897d63cf0cc9a658f92062d6cfb256485a806546ec56717f8333518bf3d46ed0a3211be4a59b4f08182f11f2db27219d803307b8b22991bc9ac103d3d1ce7e0e03d8b67a8904ff59dc10a5390260afc46670419cb7139282eeff4b75956f560cea40493377cf3742627ea2050711f6ad7d0232b5c4ab5a162418dacb7745730b6490f148fd55ccf1f8aa9be8bb0f4d6e330e69cf30e8b2e9b6caa5d4ea7dd1d980a3121bf0511b0312dc9382d999f6303d673ca4eba911ddec8448f502c838f3ab102486d8fd249eff6cb7aa6f668c7929eede76560fcb646691eb0b490992dbed517f5dbd0d5f520b432b15b91a9707dc699a20caad3df6c6e49edd220b8ef011185226c06470f8271a1b2bf0540d41df2f126a8351ab17b8cad19e61aeee3ca876f65ee1fcc50970f6990311b590261cbefd65ae92849063a9eb15e4ef65463bd1f074bf15f49e012cf6559e3817718e25bd0a9790a0cdf639b444885af1f1d55f8de429a4978212cea0d5fb9234c6cbb966e05607c8da5fbce7f254742f98a75b70eb713d1062544cd24cc3cf54de902d87a0ae2489506c29fcaeb3d70eb14b91f62fd28399a7a222490350e27573815adaa5f35867ae24d1f43c2d3c52652016b395c2a1f3202dd269a729640cbca64af3e06cb886c355a2346209545fb6ba88abf5ee6faa53ffbe8a0f0289e1d82448b2049a7c028a782b57dea28e0fe83c90a433628a7ef2ec8d94171958576043226bcd34fe02599a420ad0e121a8299171ca6cbfcd41e2100807dda222b1c213de532e83bba13c341b5be4f60619ed943f1366efb923e40390b7ba099cbdad02857331b66c37227eeb075bbdb57471514d971354d2b14a6370176ca903f3c36d6bfb521447ef644d722fdd480d9eef67c5fe2a3ec955723b6c9bfe20baeb2fcc60e47c65f97b45d5c61827d86daa149a86f598d0d57dfa2f9b2a4642efe91450c40d6e1c822daed15b219680acd770552f527895f153400efcef78d286655670da21cfc70fbe23c55ae1b0c89b9a896406f8f60e065438ed3f7613d38c3dcb3d6b162807ba0eefcc09b78bd83ff52759cd5fdeacaab6b3b581088a288559a50f76307c5bf2a93d769dc8e377e761bbbedc86e7a608af1a726cd1e6bfa390986c4b16dd1301c64d5af701d645d8d4f343d3661bb1e68356c630373fe4ad20e277cfaafa1ef527a82d13b3f353c51c689f8fad4ae9068b5a3efd3db39c9cac9fcf327679638cb6a4f42b121faa38fdaaffa6964fa38025d61642142dd5f3224855476fb9dbf7ce2e14783fbb2ab59c40b711d1568a0f0e4f6463000f390d079e224436f5b9df4386c2ac426acdcac4c89ab0696d0a1db1b7e8fd65230aace92ee8cf9a7c7640134b5082192f4c8b60d207e9b936ade6fab62957cf3486ef8fd0b6492d9880f7f5311310c4a37ed940f1d7b6b325972175c2e77d1bdbf311a75ff48df8b6d7e129ef4795f4c2cde18679623aab4b2535b5ebbf7a474985525fe252153320bf64f0128b71969cee0e9980a1acd0a3d39e76b8555c374fb66ba2f8480dd6fc241b0b31755a6712c4255109ae9236269b6fdd34103a61ed8cfc7fd4596eb2136a8e029ffb77912244fe17e12b68e332a93685f17b1f7f90bf77002ec0ae96aba40fa34e8f820a8795961db8ed383d8b76721c77a1e74f202d05c7dba09fca6dd751e1633ff08c98cbede3b624254827432077dbcc2c68d597bc5007aeb788b0baa8349855272cd01a147ae4e7783a74c048af044ee84674e1b9efd900ae948408241a733f57f58f3af8290ac7634d69e89acd1ce2a6d564dc84625c88e946f4180e9214c3cda829b636c07fd80b4f992b80453f60966331a7b6868ae83335b6806208489b0457bb8b7d7c6ae3357af7da6e32751ac656c47ba7b7c29c16c3daf83910966bda0db4a7236c8774e0999a647ef06206d3b365dfd19224316af6117f5863d6c9a855b3dbe59413823148e323385a19de14dd97afecbb50bfb886d214d80527a866df83a2feca945155bc557733a51a9bad7b75912b17a684826a67974a071f71e28fd2da723ad7128ec18401ccc40e89517afad3556408d6a368c693bde0b72075c798f9bf2ce98d9d9d568b64a190f86c1483014a35f5078443c67d6f27b648e93081aca1aa211916687ff2eb4500b51fc8c93d927c03f741a851b01ad6a2609cb5087ce25526e2305e8f967f8927e5c9a354b7d820ea7e63732a886f8dfbb988c9b281c71d8fbbf837ff32dc76a5211a767c0364533999f53bb82ce3b3540a6820452cfd62a3aaa283c3cd136a56edc1a884f35f6231197832771c7a64e58481fb3010651ed1ebe3b1ed0d374fbbc347e053bf51a35bb3501a6d5dd6fa425524775d0fea087e8bc2b50bfd82dc77b85a50164ae0f59091b9dbc286ccee6605cc716af5e08ea5273fd5fe077e0191726390a7f6c1798abfb4e2bc6f677625e7922f5832cc8c2e53a2a0ce0daab9c11fab831756107311866b7b2735a5c16bb0c1f49308b4d34bd72865f3360c71186116bd48ee3189ec74cd64867ec9a83e5404deac7581cbe68518f6e112ed9f4a12fff97ff55a3363eb6acb1a3c2dd3fcff873ee6eeef304edd75ed6a9ead2f174641298fd3bf18194fa25aac98742fcb208767eddb7f1abc1f8aaf8f4f055dfdc9837315cf86e2a75d4b5e60a9a00ffe855643cca8a36caeb20716ecadf62a43ad8184177cd92e0781269cdfcf20769392bb4df3c59df6264ffdbaf78eed70aa394cbef9b93d68e5ea7ea693fb8a40683677906c462072e0a8f2e697325178c88dfe70d7a8c94d335832aa0a1a96bef24f37367e35ec84f17e73ef0d29b52c79c4b782d7c55fbb8068f86713e2e32766be6f615e115569226b7a4c46a26cf6366cd730114f418c21ac4cbc8ef703fdfbd473ffe7271326daba3629b73da6fcf3a809cc477f42f323897534c1f2b7373d37402e16fcc068af0db65e28c89cead6cc970c9a2000467edd244733e9c1ee324b3373994cf4e2f8c74fbe97ad06748387d728743dbbf59d489ed49fb82c7eda62660f5438521703405392f04526230c40df26db85b0cb2bc0756d51f7d15e5717162b010381cbb70a548f21c8563e8d206ad2436f5f7f4aa46fbd5cbf3e8752e6ce863bf32caae230db976105496d6bd981febbc6b68e761dbd6aca5c1b5716200320cc4b70e6fff6b3c3e3c4359fc2c3cdc72f1ce8836063256f70534177da1788ef1618b09d1ed6942408d1632ec68a5772e2d8539e55f1d86656882201b19e8e6fd8045c9254807c02d986ec0a056c9c8556ae7e62a77cf9ee63630767d32797836d7f8eb3fd5eae92b14617f5319eea55971ce7b2a4448d95257676ad52c1b556c8c484c43bdb816046adf1c880b072065ee199645d4b9578b5ce9361c50de2f786d9a1940ac785ef66b0ec04183df49b16096be0597914ab7ac6ae5c5792e05b6d5c409e3cc2c1e342fc52d53841cf72173fbb1221760395f0c03f443687a6e400c6c66013d693c61173ff029b0080cab3858c7d822ec51839609ff57c65e334a152d89c2928cce753b8a5c94b35ebc3daaf4de7d81b483f49db0d73e7c251aced991c3f8728b2c95d800465d91d7052660b9f8e367b0fa2b019cfb7db9b088a67467d7e27e691f46659d74074da4b29de23900e5c77e234fa1c62f2e58b265c7fbcd17785a02f7417884008e5c51ca9954dad371e5301a7107b7c8ad65c525790a448b03b2af4d6935d5d4bb1d10e2bd53382329ca8bd343716f742e02cf49e945569f9227c0b177c55be5f1259353ec93bd7a2cedc4690d9f00beb507a244c0c17d602f97550e29342f9d9cf8e62e6a2baa09f01b125ff81a3826a364b9f0f78ff4a12cd03fa5a05360b50b2e9d448904e0a81928f0c73723eef10aae1ca0512de88c9f32085d0f02eb5b57144e10bc606272b02f19b44121903537cca24f06544f028a7b3f48e315d3fe26bfa46cab68e0708202b963ceca10155666f1fe0b7833dea951fa685d1e138c25f475ba62c04cd0a8dafbc38396d2950dc789f5284406d555ba4cc834a4e622ecc679f088bf1c9eff2bf24bd6f0f37e46434b2e0281f2a4bb045ad610ea8c8a41777a23d80c19c6ace046bbfa4fd3513a59c6ed5d18fadd133465c1b34f56bda078c136cb5d682e288bf3b62ed2a1f9de8e1c31c9db72699c3d774a3c93e77a580062fcb644d5a080bb496907668acb338af0426a22edb3fbd8db1558cce1cb30cc1ea0afd73a84555d5cec537fa79a618e098b312953b100e415c9fd34dfb78def49e6bd22933a143a7245eff86e5c3c2e9c897f58b9cda8cae75f47f4201ec88dca51954fe09af1d8daf9f6c601ba6453cc38dea20fa467762c112cb89653cfbe585a17320453f62e4d4bb3846575b24c4896380943d6ffb9638bfa094b80d745ca8777739eeb933d94434d700cc380d22831c90884a1b1863f7c67b38f89d0e225586f0f553b31b44c3147d327236a7be6d69eca373485780925f54fc9aa747ff7b4f5a1c1dc06aa509c1fcba1d0944b28952202e2b89c9c7383bbe8afa596a5b45733be66532f044aed545fe4e3256e07578a2a5941da08767c10f4bbe27e237bbc276dbc294a8bb4b93fdb0f166b80e9f769c99812dcb7436257d1e11da8e92cc26880921bb1c72f12544246512e4aed433be5096e35782528296e0eb5082f106ca454bfae31cb3f8fce23d054f9c18f7afd0c59f30a5bb4e80c47182044e52479d045a2f7bbce1ea201ea1a4dc62cb608c9641450af09f2949e7c974c1e1906e2aa175c647ae493d7cfff64dd9468bee238ac4cae19c5224ed7df67037a147c4e94b72944a2164fb1e55130ab147bab4b196d851b3e487666a8228f01506c241cf6ae1d892a720894a78dfaa7df2b6fd0b120a93cc24f654fba4c18fd2bece8ca2641f511f5e6ff33095faefafad67fb0b5056dab72c392547f736c2d9476146c6ce46586aa2ec49cdd99502feb4fa8dd4cb4bf6e526d4d11d843cfe0f85bf6bcb200614a692675dcdd9904cb57c22db1e6f4e527795212c5e93ca6556789776eeb078acd2be9d290c5d6ee8e8423567a301253f16812032f441aded99db233bcc39d322a1452fc72883b13976074e2d79f7a88df5a60ba3c0e7af2f13cecc041d2db0e83c531d5d3481e348f808deabe78f803eac0c28516f3b021c4e0ca6c80a0503e95cb26eff8b2187f78adbfe0fe970e59888d6120c4a56eae64fa15bf1acba27c7cee95c0e707247f98b4e3a2898dc9ad8c0be5feb280415d0b01631ceb25082e927326cdcf7e5bb1cc7b47a9621be5c4c2bc3880d2fd70a7f1a960a0c4371b8f7481bcf621eb22358e729008c40434bb456c6b468dd01317a13ffd56aff22bdca6f6b49c44eef7d3dc64841276cc82fa6ea60af99817e26144c0f8ab94216a18a11098b9fd4d1298b2e57234c5dade6adfe8c5ec41727c43973227d745ccbfdbc54cba8c93f247c4ee1202533067f65ffe1cd78410573608ccd9186c6f87ffcf07a81bd1ac58a7e9dc0fca98b7026991e99c0b8ef1111e28cf7a8df277bc449026e37a90c19433f0a7fc98b3d3d2cd4ba15055fccd1f7e68c8e7ab83c6dd9ceebb6e979f814236f312172c04cfaa6f5fb3717d001574fb783eaff228eaacbc184e1c4ff35d8c29844864f5c36a7912bd4ad7f56caa356419bdc4e0c22a52590edc9b10b78440694c9bf5c574fd38b6f5d2c63c1361a4eb7ee3343eab477ac11c5fab6d54df462a9f74f00bd2954650469b34a8d5130d242004bb8907b678d0a079b3a7a1c7fb0df2a360e0c555a6f97e9e3309547a93e20d92f63f74b3aceb8f89b64409a1dc669ee490e045303b8dfe3b92cd54bbd0cb6d4dbf272f860415ab2d65915e9259f9ad2ba9244c98c09218c62e9f10876dfd4fb34901d339ae7e8ed7248e172c5864883837f4b467a594a89daa0c7f9a98a85e22ae7fd56ac74b9d2d741bc2d257f62c71e6d953b77e0810c7b6b8aa514e25ee145b1943dabd59ac3bb74e5c83330665a5a4a82e2157742e1769c25bd1d965e2c8de1094ca0d8408f38dd02d3aac0ae1765c77f36cbcda8304de60667d5999aa5729a8ab433a74c591f376f3b69d8945aa62408a37dac5b06d620e3e70defee61a7f29f7f87ed0ce9ec770285e8a1ea0c1d51b87141434dd470a585d02ae5e3082df70d448d4c3bb1ba6b99ad083bd867083cd094de14bb4afa48a599a6cde8bbfa78f95ae7de4fc87f22984cd985d6f3adcc1742b573c0d3038d044a947708659764dad964c04de94c7d1b3feb10b4dfce61df6b52e0010bdb2cdaeb4ce12ab181280b7b32b00a0c4ee5a44e24a77b83830e27580aa91972828f4db8d927c20f70c62d3b4b61444e7c9d3fe75dbbb272f853763ec7adb10e43460bedd52e0ff7e84a51ffa6fd58f564458084a3d59f6bbb4d30a006103a46d9109c30b2c251d493056e686c8ecc2c532afd40b3bc6787626205ba544769b9db7d8bd3051757f23cea08f9ad77ee5316aab4ad37b8ef8bce15cbc5d4922df89fd30a110e694d5f267f809c12f4fd30448f48f58ad26115fb00e0547da9e9e4783f0338d4977abca390b8ac71b47f8c00dfd67cb16032b20bc560d597ec5d8f471a411a58d740f7a76f0a72161893bf0c902537dcc31dde00ef9ac8d382c2cf7727e896e955c710ea3bfb1ea3a20fc9c55cca0a3846ca302d448cd4a10ae3db81ed4836967c74fc5882790dc1885d711a65679d16279c7249e092cb47dff28ddf222a86f0016cdcfc9f32c60856f2eb8f7c9d9f0284fee2d59e158e797b5a0fc1dd2b688312f938d5b8cab4ab1b86ddc59b1e2772530002744397a00590d238c230826bae28a380cefe67eca5ba6e7101021c1365992eb5e6b1b0d47a07a9abfb32291d3dcde9486bf7cdb1b285cbef6413023e08e09c3999f837bc3d97a25a35190214707d11c46b84c2b931c34cf35ffa140346824749460770e90adc71b735496b368b26f5d78dbc9fa6480e0fae8e38e051470df22bf4ded71d88bf3b62dec38c6de8d5f7a20c447b7fe58e108aace892c977d4335b8203a1eedcfb362a23ba9cf65f105cac7f3a405e897f25cf638c02cc669233aefdbbec6422f7e26f2cb173d7bb3b4425a1e06fc983cfd834fd4c922534abf53c9fdee6e3e0a3fdfb9864d127c81c2da1bf3116a69986c9280f394928fd24b4ab179b3963db4588dbd7f86cf7c1abd477889801227d3a0701480b264e5109986c4498da8992d17b27d24277b30d9f8c382989341f6543d592bd8b6c7914c5e31bd129c44c5a785c599e031667e8c6cc4716157cae7084800a9eb13d5bf8b39d6554b2004bf361728408bfb9eedc7f3c7a1d530017568d599a0f5cdd926f4f3a07f837fe84820c33cb2d1e09701c79b734cc72c47506c9f9a3324b47437629381861419e206d4d5ec1f10da6f80a20bde8251e18fdafee42f7c35c0787403d135f48413102f4f3ca04149995dbc3ee8172c2199e3cafc747e2bfe4082cb89036cd33f3e0e2d9b9f21136af12a296292ac15fce987aabe5bc5c6f1fe057099a2ef7c8aaca7a2810370518f3459c3e97ea9702764eefdb6cc91863aae49c4149e52065c3c5bb31d777ebc1dd98d3c8781a012e4827a652ab49cc9414afe8a0a3f8906a58704476ee871ae2b6b75def11b13e8378f46b83dfbd4fae99cf7c5e78eb272cfe6a9dc706834b5e7c16e0ace0f2130d4a39f1d491f90c41a7515ab672f5a0cc523623a184a798c04e9c48788f1ccbadffbc81eb665b2ae57df5ec6e826daad0fb05b66f0a4f48d4106b200b3b93348b4c5dd05459ed009ef818a3f2384ee183ca6d49fcd62ac24c32c144bd1a3c3d00f2086007fa864b74de0c60b0b76dfdf31c8fa6dbaa88bcf496fce0980af21a31cc301a22c8cfd8222faa0406227daa432fde1022fb1f1864ebb262fef19469d62c26e36e5b700ce5038697bae6a42c4f4f298776c6bae8be1b4a25a7affd421cccc751cbcdc525c4606a6d6263c293e6628b5f9067d9f855929463412b1967cecf457600b1955ef98acc23a9abce39d0ac72d83d37891fb99e3a3d3a097dac2179704366e7f23b68a808b44e7732855ff3aa859acc888e72a145139559549e2356818b18286c49c6664ea4c7058e96c95381b6dabd4b99725f9126b50a341076255c9dead5a3863f044fd5162f2162d4eecf72e449f1b09a8c7aa56368729604eb3077a9cbe7c77b39c7d3840fc68a47e127ab7f41b975041ae578ee8496a81d238d91c53a60b2bbcb1218deae16b1b84f5e14046f8dbd937357d667e87539c1317ec4f11883f5a8ca11c9a2307d931103f53af31045ad9b4875da414a2dc4f7dbcd3fba021fd6b72403dae8e710927a506c73f0f3524ecb4d305e86ad1c18741afdc72f9acb1353384700c1daa380c575e5ba4c096c1893a9806775d26bc71ae5bc84d4a6bda047f191e7a95520f680ded5078d68013b959bfe70de80188f216440884d7ec23fd4dd02d31aa5004009350f4a793ca59c7eb68999497ed83830345311f8eefe8ffb4a0f8631e865d4d023a800d89edb6561fb67ba3cee8128a7329c6acb949bd74759cf566a75051bdee5260b8b965c55a1fd70a0a51a6ff80f813570079888fb27d8e96960d6a52081f6137e7da55f72a2da10da89af2bcc0a70afd09968acb255121e1f84b713af9cf49b0a9a41c19f2164929164ab04f110e2159fa2f52ca9fc96cac39c381b8a84dbcb56a78b889523aab040dd6457185ff2144029d86a8c5e62b0ed701e83af62d00bd3eb5a09b1e0cc3ce627a8dc11bb7daa41155812227f7eb6603ff9652d7838b2361df50ace058084cd9f408b326cc2e5109b174fe6c1264a8cabaf65a4d3f906dda6fc80070d22562db7afbe6e23cc73af5b6771f5962fa8bf3b2eabc04024973d7453731b2fc4901e97864e600198f59babcb15fdb19eeb99907789505a3b3d5b693ece900556b1347b0cb0160f761bf9491fc58c300b9bbc64072fc24ef09f7547b53d9a906b2874858dc7b18a8102f0f6ec8efc315bb42e2ef03b41cbfb9505c873d8ea90d7a3c9061068bb20abdea52ca735e969bb55bf199c83d2439d18854981a184315db76477678a19822b6ca729d241fb18b483792ba5cf95200c246f29edbf9dcec197b933db81e98c3511cebd68d358abff1f85acd3f12c82d81d89d6a44ef9d4685aa8a0e5c5f6841b671613a32f4efe3a97cfbad6ac1e6b75ff9bb8817f43fff30958d782802dbf3b363a7db8479e2f2f3539ddcd0dbbebb5e043f353ad0ce00ad1285a17c8232d922b50a2571366e02bb52a2034ef4d817ba8ad38b4ce953cf5d2033f40ed9ca8add6177fb7244278f66035a12f6931f3343a016894f2a4f6dbb56ec9fda304e1a62d6bf40916bb414c8eb4b6dd575c4df4bc2287c9a5c0a98d6160d067c509c80488b60b4fd652a21e42f254e5abd7074c89e488081a696534a9bee2defdf7a48081424470400caf8f2672e4ea0ae9868bc6d91f3fff9292d9487cacade1da7da99cfe0ced10901f2534b22942cc643905b49edfa2cb4b9eb872d063d37e42ec8254ad9ad710ac0bc12625db2dc93a00be8382d869c20cf917f62693eb6470f6464543074f969b3c0abadf4a04128ebc62c75f840bff94520b71d4074b13e54e47d6a60eb6e8f0cb84d976d5a6e7341929f9f00d5bd35d51ce05a798a3a960cb8449cb1179cdd8e0d27c01977402b9da8197e33e5064ed3c0406b9fe252f344a1b25d69626ddea205745aa176726c2ea2a828785b5a7378a509aacfa957d6a5b8d67e2aa831bd4bbd8c5741cddde7ab6b0cd2817b585635a74b9a8eadf0bb44aac0bc4f2d137dd09aba47b3003b3e118574c59ca875edeaae7e273313588f4d06ed647cd76908c5717c1a4fc0ff2447a608e267553e46c3ab7008e5db4b74dbc58c40809e865991f5a571590a48481b16f4b4b084fd7b145522307512917a646e4491dd4be7b120cefe56a7b691b9e19828a96b249021f9ad9e98d864ef6c95f2662851a62e7447b4daba8faf0752462e36720e6ab3edf68df9e4af257db084f4455a7306048aaca2703ec86e231f63690b728de98e9b4f3feb09788f2b58e833e5e6a3a3773c744e845c31a56f6e9d11cbd9968568867eb37ecd3c7e557108c48267c21cd91da6432a37bdcb9835bec35cdf3aa173bcf4ab6b65f60bb3c3d8cf48143605d3cfd23526912f9f0e0cc63b01c1c9651eb2bbced4ac101c13d0b7c15a06cb09a2af66a4e8b0e2d222908228d3644300ec1623dbec8cc32fd7fb6720a4cda2ab063b7146709d3db5c219e6c1c46e77c750191233d6d8cbbcd5eb5c3d686344e717b06a6888e10cbc2bc4c47978a510197748c0ccf564dcb2683a597a1a422c8280b9a0f465db24f0305f4fd99e9f518c3ec08ca505b61eac45d3a221d700690a48faead1430729f605d9496898abbb07480879a76a53ec56b0126ca7ab864b5b776e90cc6d00d11fb4caaf3e0ea7f25d98e6965d0f7f9f5c75e16f7ad436d3aff7e86bb6a71ae04efb5299cfa2183028c528c5693387cc252cbb11130fce27d47ce9e642899ef2c5f32f2c780b30063cbed909a4f26904ba2b9613aa39f9c180ea5e806636106c9584457de0e4255d115bc0a20cd2434287856d3b6f052a631f80d5ed2175cb43e32e15c1ac66680412631ff4a2396bcabe2cb41cdf96c34088ca3219ef559867d92f91869b702e6dcc74ea7e6b06059cb7b7b6f594afa239a9f4fa843f985e50333340fcd7b698e7c846b23e70f84d14de0c6e48538eae3d36cc7c51d20b403f19ea7b4eae5aeeaa520d2b4c9ab10248f1725af7dacad0ec8a8c5485ad4d691028c71df9a21c19a50d63ef7b73cd77107cc683bb1b8931791ae09f5d627545c03af3d90300726df17c25b7e745b089911af3d8a3fd70f2172561c107c6c0e26c03256143ff1e9d9d95bdb0cfdd8f0941dfbceae69ba9c6ecb5db9149953160f70a10a24b0352fcd9b476a8b43ef615eeb00a021879412eb9aba277696b843551246bf96ddafc37477e7f8f77cac1494449619f65b1dc8c4438b7bc886fcefdc149c04576baddadaac3e2b51e39ecdc2bef46000bdd56b0ea74c21d36d727916a415fa69830c2bf6b604dda0313d06576acd99bfa51e904ebbdef70bfc62117629529d79102bf1389a1802cd1c0e32a1562dd4a95aa1e715f3fb6436fe062b0f259c3c862719919f761205cd014e78f6b0df0d865aa0d6fbbe814ddfa8ad95ed3580dd157bcf9b9bb942dab4d79bf1866f9037b94e2f953cd6e356de00f0f50f5107a9fff8555a6f5004b60c20fbaec91db87358965d62911cc47da1dff1d3f9181fe7b239c1c5d24082e42d13b821e31b881db9eb95d06f786d9413febb32bb3807b053c1ba1ea1af6daa68b5ca8ad135afa248ccdc23ecdc9792b45c64ddb27ba1658d80cf254a1f24e90ecdae7d955772645ea27efec371c90c46cb1c349120457cda3b4519902ed584b342fe143cf35c9369f04bb0fe4e348696bfd33590f4a3688b1b0de982fafc4d1f86c9541fb2b76be62c8b43bdbcbdbdeb97707a5e83e3da1dc091a6d4021f963cfd83265e8ba2060ba5966f0ce12f81ca009f959bc0ccfafc31fdfd5f4d708bb71cc2bcc5660ac6bc26d939e00811c8039e2be48d534f86af328f93d4923b234e0bdce7aa3cd9186b7ff75c46e25e22cf03128752a64240c8b31d16c0510f8a3c2ae5fc280f6ef67a405f39a31d509963402360de4af3cc4fbad3d78a6ef2c94ee993de7a34e01d83bc5abbe998f0c6627e16e1088d68e044be572fa1ae66de1812a39e4c4a3d6cd159d8c8004bc8d689cab10b9a127b38300a329406960519adffb41fca25238a0b1134ea992dbf465ec038b8c440e4f6d15ca50200d30197074345ee1919d864a1747703d3d83451ffca3406f7ddd9448109db5708ca8d95ff8d2bcdbe6b72eb77bd474e8ccceae8996e2378fdabe4b61a8a23e773b95b72927cf06b6e21b2bfa06875945a2af817d0f58f58ad181467262c03c82c6fd2cc6c4f22802780ae7ceba3a76c3fd7935a1dfb20646f47c37272266ad6df0d30d44f203c96d3e208e3404dd7aeff0f26150a0b146f51f069f482c45d7b93dcb22c6ff8af7494683820aa35867272</script>\n  <div class=\"hbe hbe-content\">\n    <div class=\"hbe hbe-input hbe-input-default\">\n      <input class=\"hbe hbe-input-field hbe-input-field-default\" type=\"password\" id=\"hbePass\">\n      <label class=\"hbe hbe-input-label hbe-input-label-default\" for=\"hbePass\">\n        <span class=\"hbe hbe-input-label-content hbe-input-label-content-default\">您好，这里需要输入密码查看。</span>\n      </label>\n    </div>\n  </div>\n</div>\n<script data-pjax src=\"/lib/hbe.js\"></script><link href=\"/css/hbe.style.css\" rel=\"stylesheet\" type=\"text/css\">",
            "tags": [
                "工作日志",
                "job"
            ]
        },
        {
            "id": "http://example.com/2024/10/16/post/job/04-%E5%9B%BD%E9%99%85%E5%8C%96%E6%93%8D%E4%BD%9Ci18n/",
            "url": "http://example.com/2024/10/16/post/job/04-%E5%9B%BD%E9%99%85%E5%8C%96%E6%93%8D%E4%BD%9Ci18n/",
            "title": "04-国际化操作i18n",
            "date_published": "2024-10-16T11:37:02.123Z",
            "content_html": "<h1 id=\"vue-i18n-国际化教程\"><a class=\"anchor\" href=\"#vue-i18n-国际化教程\">#</a> vue i18n 国际化教程</h1>\n<h2 id=\"1-国际化介绍\"><a class=\"anchor\" href=\"#1-国际化介绍\">#</a> 1、国际化介绍</h2>\n<p>对于一些跨国项目来说，国际化是尤为重要的，那么什么要国际化呢？国际化的意思就是将我们写的项目，能够根据不同国家的语言，进行翻译，进行切换，方便不同国家的客户使用</p>\n<p>基本思路如下</p>\n<p>① 定义语言包：需要几种语言展示，就定义几个语言包</p>\n<p>② 创建对象，对语言包进行整合，对象的 key 为语言包的引用，值为语言包对象</p>\n<p>③ 创建 vue-i18n 类的对象，同时为其 messages 属性为第②步创建的对象，为其 locale 属性赋值为第②步中语言对象对应的 key</p>\n<p>④ 在创建 Vue 实例对象时，挂载 vue-i18n 类的对象</p>\n<p>下面具体讲解</p>\n<h2 id=\"2-简单使用\"><a class=\"anchor\" href=\"#2-简单使用\">#</a> 2、简单使用</h2>\n<p><strong>1、安装插件 vue-i18n</strong></p>\n<p><code>i18n</code>  是 <code>internationalization</code>  这个单词的缩写，取了首字母 <code>i</code>  和结尾字母 <code>n</code> ，中间一用有 18 个字母，所以组合起来就所写成 <code>i18n</code> ，这是一个用于给 vue 国际化的插件， 它可以轻松地将一些本地化功能集成到你的 Vue.js 应用程序中</p>\n<p><figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">css</span><br><span class=\"line\"></span><br><span class=\"line\">复制代码npm <span class=\"selector-tag\">i</span> vue-i18n</span><br></pre></td></tr></table></figure></p>\n<p>在 main.js 中导入并作为插件使用</p>\n<p><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">javascript复制代码<span class=\"keyword\">import</span> <span class=\"title class_\">VueI18</span>n <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vue-i18n&#x27;</span></span><br><span class=\"line\"><span class=\"title class_\">Vue</span>.<span class=\"title function_\">use</span>(<span class=\"title class_\">VueI18</span>n)</span><br></pre></td></tr></table></figure></p>\n<p><strong>2、创建语言包对象</strong></p>\n<p><figure class=\"highlight arduino\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">arduino复制代码<span class=\"comment\">// 1、创建中文语言包对象</span></span><br><span class=\"line\"><span class=\"type\">const</span> zh = &#123;</span><br><span class=\"line\">  username: <span class=\"string\">&#x27;用户名&#x27;</span>,</span><br><span class=\"line\">  email: <span class=\"string\">&#x27;邮箱&#x27;</span>,</span><br><span class=\"line\">  mobile: <span class=\"string\">&#x27;手机&#x27;</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// 2、创建英文语言包对象</span></span><br><span class=\"line\"><span class=\"type\">const</span> en = &#123;</span><br><span class=\"line\">  username: <span class=\"string\">&#x27;Username&#x27;</span>,</span><br><span class=\"line\">  email: <span class=\"string\">&#x27;Email&#x27;</span>,</span><br><span class=\"line\">  mobile: <span class=\"string\">&#x27;Mobile&#x27;</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>两个第项中的键是一样的，后面在组件中要使用</p>\n<p><strong>3、组合对象</strong></p>\n<p><figure class=\"highlight arduino\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">arduino复制代码<span class=\"comment\">// 3、组合语言包对象</span></span><br><span class=\"line\"><span class=\"type\">const</span> messages = &#123;</span><br><span class=\"line\">  zh,</span><br><span class=\"line\">  en</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p><strong>4、创建 i18n 实例</strong></p>\n<p><figure class=\"highlight arduino\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">arduino复制代码<span class=\"comment\">// 4、创建 VueI18n 实例，并为 messages 和 locale 属性赋值</span></span><br><span class=\"line\"><span class=\"type\">const</span> i18n = <span class=\"keyword\">new</span> <span class=\"built_in\">VueI18n</span>(&#123;</span><br><span class=\"line\">  messages,</span><br><span class=\"line\">  locale: <span class=\"string\">&#x27;en&#x27;</span></span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure></p>\n<ul>\n<li>messages 属性要设置为第 3 步中组合的修啊 ing</li>\n<li>locale：的值为 messages 对象中的某个 key 的值，如果设置为 en，则组件中使用 第 1 步中创建的 英文语言中包中的对应属性的值，如果设置为 zh，则使用 中文语言包中的属性的只</li>\n</ul>\n<p><strong>5、挂载对象</strong></p>\n<p><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">javascript复制代码<span class=\"comment\">// 5、挂载 i18n</span></span><br><span class=\"line\"><span class=\"keyword\">new</span> <span class=\"title class_\">Vue</span>(&#123;</span><br><span class=\"line\">  i18n,</span><br><span class=\"line\">  <span class=\"attr\">render</span>: <span class=\"function\"><span class=\"params\">h</span> =&gt;</span> <span class=\"title function_\">h</span>(<span class=\"title class_\">App</span>)</span><br><span class=\"line\">&#125;).$mount(<span class=\"string\">&#x27;#app&#x27;</span>)</span><br></pre></td></tr></table></figure></p>\n<p><strong>6、完整代码</strong></p>\n<p><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">javascript复制代码<span class=\"keyword\">import</span> <span class=\"title class_\">Vue</span> <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vue&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"title class_\">App</span> <span class=\"keyword\">from</span> <span class=\"string\">&#x27;./App.vue&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"title class_\">VueI18</span>n <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vue-i18n&#x27;</span></span><br><span class=\"line\"><span class=\"title class_\">Vue</span>.<span class=\"title function_\">use</span>(<span class=\"title class_\">VueI18</span>n)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 1、创建中文语言包对象</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> zh = &#123;</span><br><span class=\"line\">  <span class=\"attr\">username</span>: <span class=\"string\">&#x27;用户名&#x27;</span>,</span><br><span class=\"line\">  <span class=\"attr\">email</span>: <span class=\"string\">&#x27;邮箱&#x27;</span>,</span><br><span class=\"line\">  <span class=\"attr\">mobile</span>: <span class=\"string\">&#x27;手机&#x27;</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// 2、创建英文语言包对象</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> en = &#123;</span><br><span class=\"line\">  <span class=\"attr\">username</span>: <span class=\"string\">&#x27;Username&#x27;</span>,</span><br><span class=\"line\">  <span class=\"attr\">email</span>: <span class=\"string\">&#x27;Email&#x27;</span>,</span><br><span class=\"line\">  <span class=\"attr\">mobile</span>: <span class=\"string\">&#x27;Mobile&#x27;</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// 3、组合语言包对象</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> messages = &#123;</span><br><span class=\"line\">  zh,</span><br><span class=\"line\">  en</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 4、创建 VueI18n 实例，并为 messages 和 locale 属性赋值</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> i18n = <span class=\"keyword\">new</span> <span class=\"title class_\">VueI18</span>n(&#123;</span><br><span class=\"line\">  messages,</span><br><span class=\"line\">  <span class=\"attr\">locale</span>: <span class=\"string\">&#x27;en&#x27;</span></span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"title class_\">Vue</span>.<span class=\"property\">config</span>.<span class=\"property\">productionTip</span> = <span class=\"literal\">false</span></span><br><span class=\"line\"><span class=\"comment\">// 5、挂载 i18n</span></span><br><span class=\"line\"><span class=\"keyword\">new</span> <span class=\"title class_\">Vue</span>(&#123;</span><br><span class=\"line\">  i18n,</span><br><span class=\"line\">  <span class=\"attr\">render</span>: <span class=\"function\"><span class=\"params\">h</span> =&gt;</span> <span class=\"title function_\">h</span>(<span class=\"title class_\">App</span>)</span><br><span class=\"line\">&#125;).$mount(<span class=\"string\">&#x27;#app&#x27;</span>)</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure></p>\n<p><strong>7、组件中使用</strong></p>\n<p><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">bash复制代码&lt;template&gt;</span><br><span class=\"line\">  &lt;div <span class=\"built_in\">id</span>=<span class=\"string\">&quot;app&quot;</span>&gt;</span><br><span class=\"line\">    &lt;p&gt;&#123;&#123; <span class=\"variable\">$t</span>(<span class=\"string\">&#x27;username&#x27;</span>) &#125;&#125;&lt;/p&gt;</span><br><span class=\"line\">    &lt;p&gt;&#123;&#123; <span class=\"variable\">$t</span>(<span class=\"string\">&#x27;email&#x27;</span>) &#125;&#125;&lt;/p&gt;</span><br><span class=\"line\">    &lt;p&gt;&#123;&#123; <span class=\"variable\">$t</span>(<span class=\"string\">&#x27;mobile&#x27;</span>) &#125;&#125;&lt;/p&gt;</span><br><span class=\"line\">  &lt;/div&gt;</span><br><span class=\"line\">&lt;/template&gt;</span><br></pre></td></tr></table></figure></p>\n<h2 id=\"3-扩展语言包对象\"><a class=\"anchor\" href=\"#3-扩展语言包对象\">#</a> 3、扩展语言包对象</h2>\n<p>真实的项目中，可能很多地方都需要国际化，比如表格的表头、tab 栏、导航菜单等，我们可以在语言包中创建多个键，分别存储这些模块的语言</p>\n<p><figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">css复制代码// <span class=\"number\">1</span>、创建中文语言包对象</span><br><span class=\"line\">const zh = &#123;</span><br><span class=\"line\">  <span class=\"selector-tag\">table</span>: &#123;</span><br><span class=\"line\">    username: <span class=\"string\">&#x27;用户名&#x27;</span>,</span><br><span class=\"line\">    email: <span class=\"string\">&#x27;邮箱&#x27;</span>,</span><br><span class=\"line\">    mobile: <span class=\"string\">&#x27;手机&#x27;</span></span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  menus: &#123;</span><br><span class=\"line\">    home: <span class=\"string\">&#x27;首页&#x27;</span>,</span><br><span class=\"line\">    download: <span class=\"string\">&#x27;下载&#x27;</span></span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  tabs: &#123;</span><br><span class=\"line\">    info: <span class=\"string\">&#x27;商品描述&#x27;</span>,</span><br><span class=\"line\">    comment: <span class=\"string\">&#x27;评价&#x27;</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">// <span class=\"number\">2</span>、创建英文语言包对象</span><br><span class=\"line\">const en = &#123;</span><br><span class=\"line\">  <span class=\"selector-tag\">table</span>: &#123;</span><br><span class=\"line\">    username: <span class=\"string\">&#x27;Username&#x27;</span>,</span><br><span class=\"line\">    email: <span class=\"string\">&#x27;Email&#x27;</span>,</span><br><span class=\"line\">    mobile: <span class=\"string\">&#x27;Mobile&#x27;</span></span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  menus: &#123;</span><br><span class=\"line\">    home: <span class=\"string\">&#x27;Home&#x27;</span>,</span><br><span class=\"line\">    download: <span class=\"string\">&#x27;DownLoad&#x27;</span></span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  tabs: &#123;</span><br><span class=\"line\">    info: <span class=\"string\">&#x27;Describe&#x27;</span>,</span><br><span class=\"line\">    comment: <span class=\"string\">&#x27;Comment On&#x27;</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>组件中使用</p>\n<p><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">xml复制代码<span class=\"tag\">&lt;<span class=\"name\">template</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;app&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!-- 模拟表格中使用 --&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>&#123;&#123; $t(&#x27;table.username&#x27;) &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>&#123;&#123; $t(&#x27;table.email&#x27;) &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>&#123;&#123; $t(&#x27;table.mobile&#x27;) &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!-- 模拟导航菜单中使用 --&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>&#123;&#123; $t(&#x27;menus.home&#x27;) &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>&#123;&#123; $t(&#x27;menus.download&#x27;) &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!-- 模拟tabs 选项卡中使用 --&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>&#123;&#123; $t(&#x27;tabs.info&#x27;) &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>&#123;&#123; $t(&#x27;tabs.comment&#x27;) &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">template</span>&gt;</span></span><br></pre></td></tr></table></figure></p>\n<p>此时，如果将 locale 的值切换为 zh</p>\n<p><figure class=\"highlight arduino\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">arduino复制代码<span class=\"comment\">// 4、创建 VueI18n 实例，并为 messages 和 locale 属性赋值</span></span><br><span class=\"line\"><span class=\"type\">const</span> i18n = <span class=\"keyword\">new</span> <span class=\"built_in\">VueI18n</span>(&#123;</span><br><span class=\"line\">  messages,</span><br><span class=\"line\">  locale: <span class=\"string\">&#x27;zh&#x27;</span></span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure></p>\n<blockquote>\n<p>实际开发中，多个组件中可能存在多个表格、导航菜单等，每个表格的表头、菜单的描述信息可能都不尽相同</p>\n<p>该如何处理呢？</p>\n<p>以表格的表头为例</p>\n<p>我们可以在语言包对象中，定义多个 table，如 userTable、roleTable 等，每个当中存储自己的字段和对应的语言，也可以在一个 table 对象中，定义多个字段，把所有表格用到的表头信息全都定义在一个 table 对象中</p>\n</blockquote>\n<h2 id=\"4-单独的语言包文件\"><a class=\"anchor\" href=\"#4-单独的语言包文件\">#</a> 4、单独的语言包文件</h2>\n<p>语言包对象 最后可能会比较大，属性比较多，所以最好的办法是将其定义成单独的 js 文件，然后再进行整合</p>\n<p><strong>1、创建语言包文件</strong></p>\n<p>src 目录下新建 langurage 目录，在其中新建 zh.js 和 en.js 文件，然后将上面的语言包代码拷贝进来，因为一会要使用语言包对象，所以要导出</p>\n<p>zh.js</p>\n<p><figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">css复制代码// <span class=\"number\">1</span>、创建中文语言包对象</span><br><span class=\"line\">export default&#123;</span><br><span class=\"line\">    <span class=\"selector-tag\">table</span>: &#123;</span><br><span class=\"line\">      username: <span class=\"string\">&#x27;用户名&#x27;</span>,</span><br><span class=\"line\">      email: <span class=\"string\">&#x27;邮箱&#x27;</span>,</span><br><span class=\"line\">      mobile: <span class=\"string\">&#x27;手机&#x27;</span></span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    menus: &#123;</span><br><span class=\"line\">      home: <span class=\"string\">&#x27;首页&#x27;</span>,</span><br><span class=\"line\">      download: <span class=\"string\">&#x27;下载&#x27;</span></span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    tabs: &#123;</span><br><span class=\"line\">      info: <span class=\"string\">&#x27;商品描述&#x27;</span>,</span><br><span class=\"line\">      comment: <span class=\"string\">&#x27;评价&#x27;</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br></pre></td></tr></table></figure></p>\n<p>en.js</p>\n<p><figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">css复制代码// <span class=\"number\">2</span>、创建英文语言包对象</span><br><span class=\"line\">export default &#123;</span><br><span class=\"line\">    <span class=\"selector-tag\">table</span>: &#123;</span><br><span class=\"line\">        username: <span class=\"string\">&#x27;Username&#x27;</span>,</span><br><span class=\"line\">        email: <span class=\"string\">&#x27;Email&#x27;</span>,</span><br><span class=\"line\">        mobile: <span class=\"string\">&#x27;Mobile&#x27;</span></span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    menus: &#123;</span><br><span class=\"line\">        home: <span class=\"string\">&#x27;Home&#x27;</span>,</span><br><span class=\"line\">        download: <span class=\"string\">&#x27;DownLoad&#x27;</span></span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    tabs: &#123;</span><br><span class=\"line\">        info: <span class=\"string\">&#x27;Describe&#x27;</span>,</span><br><span class=\"line\">        comment: <span class=\"string\">&#x27;Comment On&#x27;</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p><strong>2、整合语言包文件</strong></p>\n<p>我们将整合语言包对象和创建 VueI18n 实例并配置的过程写到一个 js 文件中，然后在 main.js 中导入</p>\n<p>这样 main.js 中代码就会简练很多，毕竟 main.js 中只是最后需要一个 VueI18n 的实例即可！[]</p>\n<p>langurage 目录中新建 index.js，代码如下</p>\n<p><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">javascript复制代码<span class=\"keyword\">import</span> <span class=\"title class_\">Vue</span> <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vue&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"title class_\">VueI18</span>n <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vue-i18n&#x27;</span></span><br><span class=\"line\"><span class=\"comment\">// 从语言包文件中导入语言包对象</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> zh <span class=\"keyword\">from</span> <span class=\"string\">&#x27;./zh&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> en <span class=\"keyword\">from</span> <span class=\"string\">&#x27;./en&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"title class_\">Vue</span>.<span class=\"title function_\">use</span>(<span class=\"title class_\">VueI18</span>n)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> messages = &#123;</span><br><span class=\"line\">  zh,</span><br><span class=\"line\">  en</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">const</span> i18n = <span class=\"keyword\">new</span> <span class=\"title class_\">VueI18</span>n(&#123;</span><br><span class=\"line\">  messages,</span><br><span class=\"line\">  <span class=\"attr\">locale</span>: <span class=\"string\">&#x27;en&#x27;</span></span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> i18n</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure></p>\n<p><strong>3、main.js 中引入</strong></p>\n<p><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">javascript复制代码<span class=\"keyword\">import</span> <span class=\"title class_\">Vue</span> <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vue&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"title class_\">App</span> <span class=\"keyword\">from</span> <span class=\"string\">&#x27;./App.vue&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> i18n <span class=\"keyword\">from</span> <span class=\"string\">&#x27;./langurage&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"title class_\">Vue</span>.<span class=\"property\">config</span>.<span class=\"property\">productionTip</span> = <span class=\"literal\">false</span></span><br><span class=\"line\"><span class=\"comment\">// 5、挂载 i18n</span></span><br><span class=\"line\"><span class=\"keyword\">new</span> <span class=\"title class_\">Vue</span>(&#123;</span><br><span class=\"line\">  i18n,</span><br><span class=\"line\">  <span class=\"attr\">render</span>: <span class=\"function\"><span class=\"params\">h</span> =&gt;</span> <span class=\"title function_\">h</span>(<span class=\"title class_\">App</span>)</span><br><span class=\"line\">&#125;).$mount(<span class=\"string\">&#x27;#app&#x27;</span>)</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure></p>\n<h2 id=\"5-切换语言\"><a class=\"anchor\" href=\"#5-切换语言\">#</a> 5、切换语言</h2>\n<p>当前切换语言，需要修改如下代码中的 locale 的值</p>\n<p><figure class=\"highlight arduino\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">arduino复制代码<span class=\"type\">const</span> i18n = <span class=\"keyword\">new</span> <span class=\"built_in\">VueI18n</span>(&#123;</span><br><span class=\"line\">  messages,</span><br><span class=\"line\">  locale: <span class=\"string\">&#x27;en&#x27;</span></span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure></p>\n<p>手动切换当然不行了，页面中可以提供一个按钮，点击时，动态改变这里的值</p>\n<p>通过 navigator.language 方法可以获取浏览器当前使用的语言，基本就代表了用户所使用的语言</p>\n<p><figure class=\"highlight arduino\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">arduino复制代码<span class=\"comment\">// 获取浏览器当前使用的语言，并进行处理</span></span><br><span class=\"line\"><span class=\"type\">const</span> i18n = <span class=\"keyword\">new</span> <span class=\"built_in\">VueI18n</span>(&#123;</span><br><span class=\"line\">  messages,</span><br><span class=\"line\">  locale: navigator.language <span class=\"comment\">// 获取浏览器的语言</span></span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure></p>\n<p>组件中加入语言切换按钮</p>\n<p><figure class=\"highlight ini\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ini复制代码    &lt;button @<span class=\"attr\">click</span>=<span class=\"string\">&quot;translate(&#x27;zh&#x27;)&quot;</span>&gt;切换为中文&lt;/button&gt;</span><br><span class=\"line\">    &lt;button @<span class=\"attr\">click</span>=<span class=\"string\">&quot;translate(&#x27;en&#x27;)&quot;</span>&gt;切换为英文&lt;/button&gt;</span><br><span class=\"line\">javascript复制代码  methods: &#123;</span><br><span class=\"line\">    translate(lang) &#123;</span><br><span class=\"line\">      this.$<span class=\"attr\">i18n.locale</span> = lang</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">  &#125;,</span><br></pre></td></tr></table></figure></p>\n<p>这样，我们就实现了语言的切换了</p>\n<h2 id=\"6-动态菜单如何处理\"><a class=\"anchor\" href=\"#6-动态菜单如何处理\">#</a> 6、动态菜单如何处理</h2>\n<p>如下面的导航菜单是请求后台数据，然后借用 element-ui 中的 menu 组件动态渲染的</p>\n<p>返回的菜单名称字段（authName）的值都是中文，此时该如何处理呢？</p>\n<p>很简单，语言包中定义相关数据</p>\n<p>zh.js</p>\n<p><figure class=\"highlight arduino\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">arduino复制代码<span class=\"keyword\">export</span> <span class=\"keyword\">default</span> &#123;</span><br><span class=\"line\">  menus: &#123;</span><br><span class=\"line\">    用户管理: <span class=\"string\">&#x27;用户管理&#x27;</span>,</span><br><span class=\"line\">    用户列表: <span class=\"string\">&#x27;用户列表&#x27;</span>,</span><br><span class=\"line\">    角色列表: <span class=\"string\">&#x27;角色列表&#x27;</span>,</span><br><span class=\"line\">    权限管理: <span class=\"string\">&#x27;权限管理&#x27;</span>,</span><br><span class=\"line\">    权限列表: <span class=\"string\">&#x27;权限列表&#x27;</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>en.js</p>\n<p><figure class=\"highlight arduino\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">arduino复制代码<span class=\"keyword\">export</span> <span class=\"keyword\">default</span> &#123;</span><br><span class=\"line\">  menus: &#123;</span><br><span class=\"line\">    用户管理: <span class=\"string\">&#x27;User Manager&#x27;</span>,</span><br><span class=\"line\">    用户列表: <span class=\"string\">&#x27;User List&#x27;</span>,</span><br><span class=\"line\">    角色列表: <span class=\"string\">&#x27;Role List&#x27;</span>,</span><br><span class=\"line\">    权限管理: <span class=\"string\">&#x27;Rights Manager&#x27;</span>,</span><br><span class=\"line\">    权限列表: <span class=\"string\">&#x27;Rights List&#x27;</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>menu 组件渲染时，加入如下代码</p>\n<p>在 methods 中定义方法 menusTitle</p>\n<p><figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">kotlin复制代码  menusTitle(item) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.$te(<span class=\"string\">&#x27;menus.&#x27;</span> + item)) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.$t(<span class=\"string\">&#x27;menus.&#x27;</span> + item)</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">      <span class=\"keyword\">return</span> item</span><br><span class=\"line\">    &#125;,</span><br></pre></td></tr></table></figure></p>\n<p>现在我们实现翻译功能</p>\n<p>头部加上一个 switch 进行语言切换</p>\n<p><figure class=\"highlight ini\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ini复制代码&lt;el-switch</span><br><span class=\"line\">    <span class=\"attr\">v-model</span>=<span class=\"string\">&quot;langValue&quot;</span></span><br><span class=\"line\">    :<span class=\"attr\">active-text</span>=<span class=\"string\">&quot;active_text&quot;</span></span><br><span class=\"line\">    :<span class=\"attr\">inactive-text</span>=<span class=\"string\">&quot;inactive_text&quot;</span></span><br><span class=\"line\">    @<span class=\"attr\">change</span>=<span class=\"string\">&quot;translate&quot;</span></span><br><span class=\"line\">&gt;</span><br></pre></td></tr></table></figure></p>\n<p>data 中的数据</p>\n<p><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">yaml复制代码</span> <span class=\"attr\">langValue:</span> <span class=\"literal\">false</span><span class=\"string\">,</span></span><br><span class=\"line\"> <span class=\"attr\">lang:</span> <span class=\"string\">&#x27;&#x27;</span><span class=\"string\">,</span></span><br><span class=\"line\"> <span class=\"attr\">active_text:</span> <span class=\"string\">&#x27;&#x27;</span><span class=\"string\">,</span></span><br><span class=\"line\"> <span class=\"attr\">inactive_text:</span> <span class=\"string\">&#x27;&#x27;</span><span class=\"string\">,</span></span><br></pre></td></tr></table></figure></p>\n<p>组件初始化时对上面的值进行初始化设置</p>\n<p>methods 中定义此方法，并在 created 钩子函数中调用</p>\n<p><figure class=\"highlight ini\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ini复制代码 setSwitch() &#123;</span><br><span class=\"line\">     <span class=\"attr\">this.active_text</span> = navigator.language === <span class=\"string\">&#x27;zh&#x27;</span> ? <span class=\"string\">&#x27;英文&#x27;</span> : <span class=\"string\">&#x27;中文&#x27;</span></span><br><span class=\"line\">     <span class=\"attr\">this.inactive_text</span> = navigator.language === <span class=\"string\">&#x27;zh&#x27;</span> ? <span class=\"string\">&#x27;中文&#x27;</span> : <span class=\"string\">&#x27;英文&#x27;</span></span><br><span class=\"line\">     <span class=\"attr\">this.lang</span> = navigator.language</span><br><span class=\"line\"> &#125;,</span><br></pre></td></tr></table></figure></p>\n<p>switch 的 change 事件处理程序</p>\n<p><figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">kotlin复制代码translate() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.lang = <span class=\"keyword\">this</span>.lang === <span class=\"string\">&#x27;zh&#x27;</span> ? <span class=\"string\">&#x27;en&#x27;</span> : <span class=\"string\">&#x27;zh&#x27;</span></span><br><span class=\"line\">    <span class=\"keyword\">this</span>.$i18n.locale = <span class=\"keyword\">this</span>.lang</span><br><span class=\"line\">&#125;,</span><br></pre></td></tr></table></figure></p>\n<h2 id=\"7-如何调整语言设置\"><a class=\"anchor\" href=\"#7-如何调整语言设置\">#</a> 7、如何调整语言设置</h2>\n<p>在浏览器的语言设置中，可以调整语言，然后刷新页面，浏览器就会采用最新的语言设置</p>\n<p>VoerkaI18n：<span class=\"exturl\" data-url=\"aHR0cHM6Ly96aGFuZ2Zpc2hlci5naXRodWIuaW8vdm9lcmthLWkxOG4vIy8=\">https://zhangfisher.github.io/voerka-i18n/#/</span></p>\n",
            "tags": [
                "工作日志",
                "job",
                "vue.js",
                "国际化"
            ]
        },
        {
            "id": "http://example.com/2024/10/16/post/job/03-%E5%AE%9E%E7%8E%B0%E5%9B%BE%E7%89%87%E5%8E%8B%E7%BC%A9/",
            "url": "http://example.com/2024/10/16/post/job/03-%E5%AE%9E%E7%8E%B0%E5%9B%BE%E7%89%87%E5%8E%8B%E7%BC%A9/",
            "title": "03-实现图片压缩",
            "date_published": "2024-10-16T11:37:02.122Z",
            "content_html": "<h1 id=\"一-java实现图片压缩\"><a class=\"anchor\" href=\"#一-java实现图片压缩\">#</a> 一、Java 实现图片压缩</h1>\n<h3 id=\"1-简介\"><a class=\"anchor\" href=\"#1-简介\">#</a> 1、简介</h3>\n<p>我们在项目中经常会遇到图片上传的需求，如商品图片，但图片太大的话，在客户端加载太慢影响用户体验，所有一般会将图片进行压缩。</p>\n<h3 id=\"2-实现\"><a class=\"anchor\" href=\"#2-实现\">#</a> 2、实现</h3>\n<h5 id=\"添加依赖\"><a class=\"anchor\" href=\"#添加依赖\">#</a> 添加依赖</h5>\n<p><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>net.coobird<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>thumbnailator<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>0.4.8<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></p>\n<h5 id=\"21按质量压缩\"><a class=\"anchor\" href=\"#21按质量压缩\">#</a> 2.1 按质量压缩</h5>\n<p><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> java.io.File;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.FileOutputStream;</span><br><span class=\"line\"><span class=\"keyword\">import</span> net.coobird.thumbnailator.Thumbnails;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Client</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> Exception &#123;</span><br><span class=\"line\">    Thumbnails.of(<span class=\"keyword\">new</span> <span class=\"title class_\">File</span>(<span class=\"string\">&quot;D:/showqrcode.jpg&quot;</span>))</span><br><span class=\"line\">        .scale(<span class=\"number\">1f</span>) <span class=\"comment\">//图片大小（长宽）压缩比例 从0-1，1表示原图</span></span><br><span class=\"line\">        .outputQuality(<span class=\"number\">0.5f</span>) <span class=\"comment\">//图片质量压缩比例 从0-1，越接近1质量越好</span></span><br><span class=\"line\">        .toOutputStream(<span class=\"keyword\">new</span> <span class=\"title class_\">FileOutputStream</span>(<span class=\"string\">&quot;D:/showqrcode_50.jpg&quot;</span>));</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<h5 id=\"22按比例压缩\"><a class=\"anchor\" href=\"#22按比例压缩\">#</a> 2.2 按比例压缩</h5>\n<p><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> java.io.File;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.FileOutputStream;</span><br><span class=\"line\"><span class=\"keyword\">import</span> net.coobird.thumbnailator.Thumbnails;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Client2</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> Exception &#123;</span><br><span class=\"line\">    Thumbnails.of(<span class=\"keyword\">new</span> <span class=\"title class_\">File</span>(<span class=\"string\">&quot;D:/showqrcode.jpg&quot;</span>))</span><br><span class=\"line\">        .scale(<span class=\"number\">0.5f</span>) <span class=\"comment\">//图片大小（长宽）压缩 从0按照</span></span><br><span class=\"line\">        .outputQuality(<span class=\"number\">0.5f</span>) <span class=\"comment\">//图片质量压缩比例 从0-1，越接近1质量越好</span></span><br><span class=\"line\">        .toOutputStream(<span class=\"keyword\">new</span> <span class=\"title class_\">FileOutputStream</span>(<span class=\"string\">&quot;D:/showqrcode_50%.jpg&quot;</span>));</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<h5 id=\"23按大小和比例缩放\"><a class=\"anchor\" href=\"#23按大小和比例缩放\">#</a> 2.3 按大小和比例缩放</h5>\n<p><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> java.io.File;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.FileOutputStream;</span><br><span class=\"line\"><span class=\"keyword\">import</span> net.coobird.thumbnailator.Thumbnails;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Client21</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> Exception &#123;</span><br><span class=\"line\">    Thumbnails.of(<span class=\"keyword\">new</span> <span class=\"title class_\">File</span>(<span class=\"string\">&quot;D:/showqrcode.jpg&quot;</span>))</span><br><span class=\"line\">        .size(<span class=\"number\">500</span>, <span class=\"number\">300</span>) <span class=\"comment\">// 图片比例不变</span></span><br><span class=\"line\">        .toOutputStream(<span class=\"keyword\">new</span> <span class=\"title class_\">FileOutputStream</span>(<span class=\"string\">&quot;D:/showqrcode_500_300.jpg&quot;</span>));</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<h5 id=\"24按大小缩放\"><a class=\"anchor\" href=\"#24按大小缩放\">#</a> 2.4 按大小缩放</h5>\n<p><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> java.io.File;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.FileOutputStream;</span><br><span class=\"line\"><span class=\"keyword\">import</span> net.coobird.thumbnailator.Thumbnails;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Client22</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> Exception &#123;</span><br><span class=\"line\">    Thumbnails.of(<span class=\"keyword\">new</span> <span class=\"title class_\">File</span>(<span class=\"string\">&quot;D:/showqrcode.jpg&quot;</span>))</span><br><span class=\"line\">        .forceSize(<span class=\"number\">500</span>, <span class=\"number\">300</span>) <span class=\"comment\">//不保持图片比例</span></span><br><span class=\"line\">        .toOutputStream(<span class=\"keyword\">new</span> <span class=\"title class_\">FileOutputStream</span>(<span class=\"string\">&quot;D:/showqrcode_500_300.jpg&quot;</span>));</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<h5 id=\"25旋转\"><a class=\"anchor\" href=\"#25旋转\">#</a> 2.5 旋转</h5>\n<p><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> java.io.File;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.FileOutputStream;</span><br><span class=\"line\"><span class=\"keyword\">import</span> net.coobird.thumbnailator.Thumbnails;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Client3</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> Exception &#123;</span><br><span class=\"line\">    Thumbnails.of(<span class=\"keyword\">new</span> <span class=\"title class_\">File</span>(<span class=\"string\">&quot;D:/showqrcode.jpg&quot;</span>))</span><br><span class=\"line\">        .forceSize(<span class=\"number\">500</span>, <span class=\"number\">300</span>)</span><br><span class=\"line\">        .rotate(<span class=\"number\">90f</span>) <span class=\"comment\">//向右旋转</span></span><br><span class=\"line\">        .toOutputStream(<span class=\"keyword\">new</span> <span class=\"title class_\">FileOutputStream</span>(<span class=\"string\">&quot;D:/showqrcode+90.jpg&quot;</span>));</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<h5 id=\"26加水印\"><a class=\"anchor\" href=\"#26加水印\">#</a> 2.6 加水印</h5>\n<p><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> java.io.File;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.IOException;</span><br><span class=\"line\"><span class=\"keyword\">import</span> javax.imageio.ImageIO;</span><br><span class=\"line\"><span class=\"keyword\">import</span> net.coobird.thumbnailator.Thumbnails;</span><br><span class=\"line\"><span class=\"keyword\">import</span> net.coobird.thumbnailator.geometry.Positions;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Client4</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> IOException &#123;</span><br><span class=\"line\">    Thumbnails.of(<span class=\"string\">&quot;D:/showqrcode.jpg&quot;</span>)</span><br><span class=\"line\">        .size(<span class=\"number\">1280</span>, <span class=\"number\">1024</span>)</span><br><span class=\"line\">        .watermark(Positions.BOTTOM_RIGHT, ImageIO.read(<span class=\"keyword\">new</span> <span class=\"title class_\">File</span>(<span class=\"string\">&quot;D:/watermark.jpg&quot;</span>)),</span><br><span class=\"line\">            <span class=\"number\">0.5f</span>) <span class=\"comment\">//位置，水印来源，透明度</span></span><br><span class=\"line\">        .outputQuality(<span class=\"number\">0.8f</span>)</span><br><span class=\"line\">        .toFile(<span class=\"string\">&quot;D:/showqrcode_watermark_bottom_right.jpg&quot;</span>);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<h5 id=\"27裁剪\"><a class=\"anchor\" href=\"#27裁剪\">#</a> 2.7 裁剪</h5>\n<p><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> java.io.IOException;</span><br><span class=\"line\"><span class=\"keyword\">import</span> net.coobird.thumbnailator.Thumbnails;</span><br><span class=\"line\"><span class=\"keyword\">import</span> net.coobird.thumbnailator.geometry.Positions;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Client5</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> IOException &#123;</span><br><span class=\"line\">    Thumbnails.of(<span class=\"string\">&quot;D:/showqrcode.jpg&quot;</span>)</span><br><span class=\"line\">        .sourceRegion(Positions.CENTER, <span class=\"number\">800</span>, <span class=\"number\">600</span>) <span class=\"comment\">//位置，宽，高</span></span><br><span class=\"line\">        .size(<span class=\"number\">800</span>, <span class=\"number\">600</span>)</span><br><span class=\"line\">        .keepAspectRatio(<span class=\"literal\">false</span>)</span><br><span class=\"line\">        .toFile(<span class=\"string\">&quot;D:/showqrcode_region_center.jpg&quot;</span>);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<h5 id=\"28拼接\"><a class=\"anchor\" href=\"#28拼接\">#</a> 2.8 拼接</h5>\n<p><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> java.awt.Graphics;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.awt.image.BufferedImage;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.ByteArrayInputStream;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.ByteArrayOutputStream;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.File;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.FileOutputStream;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.IOException;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.ArrayList;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.List;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Objects;</span><br><span class=\"line\"><span class=\"keyword\">import</span> javax.imageio.ImageIO;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Client6</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> Exception &#123;</span><br><span class=\"line\">    <span class=\"type\">byte</span>[] bytes = joinImages(<span class=\"literal\">false</span>, <span class=\"keyword\">new</span> <span class=\"title class_\">File</span>(<span class=\"string\">&quot;D:/showqrcode.jpg&quot;</span>), <span class=\"keyword\">new</span> <span class=\"title class_\">File</span>(<span class=\"string\">&quot;D:/showqrcode.jpg&quot;</span>));</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (Objects.nonNull(bytes)) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">new</span> <span class=\"title class_\">ByteArrayInputStream</span>(bytes).transferTo(<span class=\"keyword\">new</span> <span class=\"title class_\">FileOutputStream</span>(<span class=\"string\">&quot;D:/showqrcode_join.jpg&quot;</span>));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">   * 将多张图片拼接成一张</span></span><br><span class=\"line\"><span class=\"comment\">   *</span></span><br><span class=\"line\"><span class=\"comment\">   * <span class=\"doctag\">@param</span> horizontal 是否为水平拼接</span></span><br><span class=\"line\"><span class=\"comment\">   * <span class=\"doctag\">@param</span> files 文件列表</span></span><br><span class=\"line\"><span class=\"comment\">   * <span class=\"doctag\">@return</span> 拼接后的文件字节数组</span></span><br><span class=\"line\"><span class=\"comment\">   */</span></span><br><span class=\"line\">  <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"type\">byte</span>[] joinImages(<span class=\"type\">boolean</span> horizontal, File... files) <span class=\"keyword\">throws</span> IOException &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (Objects.isNull(files) || files.length == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">return</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    List&lt;BufferedImage&gt; imageList = <span class=\"keyword\">new</span> <span class=\"title class_\">ArrayList</span>&lt;&gt;();</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (File file : files) &#123;</span><br><span class=\"line\">      <span class=\"type\">BufferedImage</span> <span class=\"variable\">image</span> <span class=\"operator\">=</span> ImageIO.read(file);</span><br><span class=\"line\">      imageList.add(image);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">height</span> <span class=\"operator\">=</span> imageList.get(<span class=\"number\">0</span>).getHeight();</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">width</span> <span class=\"operator\">=</span> imageList.get(<span class=\"number\">0</span>).getWidth();</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (horizontal) &#123;</span><br><span class=\"line\">      width = imageList.stream().mapToInt(BufferedImage::getWidth).sum();</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">      height = imageList.stream().mapToInt(BufferedImage::getHeight).sum();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">//创建拼接后的图片画布，参数分别为宽，高，类型，这里我们使用RGB3元色类型</span></span><br><span class=\"line\">    <span class=\"type\">BufferedImage</span> <span class=\"variable\">resultImage</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">BufferedImage</span>(width, height, BufferedImage.TYPE_INT_RGB);</span><br><span class=\"line\">    <span class=\"type\">Graphics</span> <span class=\"variable\">graphics</span> <span class=\"operator\">=</span> resultImage.getGraphics();</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">previousWidth</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">previousHeight</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (BufferedImage image : imageList) &#123;</span><br><span class=\"line\">      <span class=\"comment\">//向画布上画图片</span></span><br><span class=\"line\">      graphics.drawImage(image, previousWidth, previousHeight, <span class=\"literal\">null</span>);</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (horizontal) &#123;</span><br><span class=\"line\">        previousWidth += image.getWidth();</span><br><span class=\"line\">      &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        previousHeight += image.getHeight();</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"type\">ByteArrayOutputStream</span> <span class=\"variable\">output</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">ByteArrayOutputStream</span>();</span><br><span class=\"line\">    ImageIO.write(resultImage, <span class=\"string\">&quot;jpg&quot;</span>, output);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> output.toByteArray();</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<h3 id=\"总结\"><a class=\"anchor\" href=\"#总结\">#</a> 总结</h3>\n<p>图片经过以上处理之后都会去除 EXIF 信息，关于 EXIF 详情，请查看<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vc3Ryb25nbW9yZS9wLzE0MTQ2Nzk5Lmh0bWw=\"> java 获取图片的 GPS 信息</span></p>\n<h3 id=\"参考\"><a class=\"anchor\" href=\"#参考\">#</a> 参考</h3>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vbGlua3N0YXIvcC83NDEyMDEyLmh0bWw=\">java 使用 google 开源工具实现图片压缩</span></p>\n",
            "tags": [
                "工作日志",
                "job"
            ]
        },
        {
            "id": "http://example.com/2024/10/16/post/job/02-quartz%E5%AE%9A%E6%97%B6%E8%B0%83%E5%BA%A6%E4%BB%BB%E5%8A%A1/",
            "url": "http://example.com/2024/10/16/post/job/02-quartz%E5%AE%9A%E6%97%B6%E8%B0%83%E5%BA%A6%E4%BB%BB%E5%8A%A1/",
            "title": "02-quartz定时调度任务",
            "date_published": "2024-10-16T11:37:02.098Z",
            "content_html": "<h2 id=\"1-quartz概念\"><a class=\"anchor\" href=\"#1-quartz概念\">#</a> 1、Quartz 概念</h2>\n<p>Quartz 就是一个基于 Java 实现的任务调度框架，用于执行你想要执行的任何任务。<br />\nQuartz 是 OpenSymphony 开源组织在 Job scheduling（定时调度）领域的开源项目，它可以与 J2EE 和 J2SE 应用程序相结合也可以单独使用。</p>\n<p>Quartz 是开源且具有丰富特性的任务调度库，能够集成任何的 Java 应用。它能创建简单的或者复杂的调度任务，以执行上十，上百，上千，上万的任务。任务 job 被定义为标准的 Java 组件。能工执行任何你想要实现的功能。Quartz 调度框架包含许多企业级的特性，如 JTA 事务，集群的支持。</p>\n<p>官网：<span class=\"exturl\" data-url=\"aHR0cDovL3d3dy5xdWFydHotc2NoZWR1bGVyLm9yZy8=\">http://www.quartz-scheduler.org/</span></p>\n<h2 id=\"2-quartz运行环境\"><a class=\"anchor\" href=\"#2-quartz运行环境\">#</a> 2、Quartz 运行环境</h2>\n<ul>\n<li>Quartz 可以运行嵌入在另一个独立的应用程序中</li>\n<li>Quartz 可以在应用程序服务器（或 servlet 容器）内被实例化，bin 参与事务</li>\n<li>Quartz 可以作为一个独立的程序运行（其自己的 java 虚拟机内），可以通过 RMI 使用</li>\n<li>Quartz 可以被实例化，作为独立的项目集群（负载平衡和故障转移功能），用于作业执行</li>\n</ul>\n<h2 id=\"3-quartz使用的设计模式\"><a class=\"anchor\" href=\"#3-quartz使用的设计模式\">#</a> 3、Quartz 使用的设计模式</h2>\n<ul>\n<li>Builder 模式</li>\n<li>Factory 模式</li>\n<li>组件模式</li>\n<li>链式编程</li>\n</ul>\n<h3 id=\"4-quartz学习的核心概念\"><a class=\"anchor\" href=\"#4-quartz学习的核心概念\">#</a> 4、Quartz 学习的核心概念</h3>\n<p>1、任务 job</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">job就是你想实现的任务类，每一个job必须实现org.quartz.job接口，且只需实现接口定义的execute()方法</span><br></pre></td></tr></table></figure></p>\n<p>2、触发器 trigger</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Trigger为你执行任务的触发器（定时）</span><br><span class=\"line\">Trigger主要包含两个SimpleTrigger和CronTrigger两种</span><br></pre></td></tr></table></figure></p>\n<p>3、调度器 Scheduler</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Scheduler为定时任务调度，它会将任务Job及触发器Trigger整合起来，负责基于Trigger设定的时间来执行Job</span><br></pre></td></tr></table></figure></p>\n<h3 id=\"5-体系结构\"><a class=\"anchor\" href=\"#5-体系结构\">#</a> 5、体系结构</h3>\n<p><img data-src=\"https://dlink.host/wx4.sinaimg.cn/large/006V2BDqly8hqta4ht60fj30nt0gotag.jpg\" alt=\"这里是 alt\" title=\"这是体系结构照片\" /></p>\n<h3 id=\"6-quartz的几个常用api\"><a class=\"anchor\" href=\"#6-quartz的几个常用api\">#</a> 6、Quartz 的几个常用 API</h3>\n<ul>\n<li>Scheduler：用于定时调度程序交互的主程序接口。Scheduler 调度程序：任务执行计划表，只有安排进执行计划的任务 Job【通过 scheduler.scheduleJob 方法安排进执行任务】，当它预先定义的执行时间到了的时候（任务出发 trigger）该任务才会被执行</li>\n<li>Job：预先定义的，希望在未来某个使劲能被调度程序执行的任务类，可自定义</li>\n<li>JobDetail：使用 JobDetail 来定义定时任务的实例，JobDetail 实例是通过 JobBuilder 类创建的</li>\n<li>JobDataMap：可以包含不限量（序列化的）的数对象，在 Job 实例执行的时候，可以使用其中的数据；JobDataMap 是 Java Map 接口的一个实现，额外增加了一些便于存取基本类型数据的方法</li>\n<li>Trigger：触发器，Trigger 对象是用来触发执行 Job 的。当调度一个 Job 时，我们实例一个触发器然后调整他的属性来满足 Job 执行的条件。表明任务在什么时候会执行。【定义了一个已经被安排的任务将会在什么时候执行的时间条件】</li>\n<li>JobBuilder：用于声明一个任务实例，也可以定义关于该任务的详情比如任务名，组名等。通过 JobBuilder 声明的实例将会作为一个实际执行的任务。</li>\n<li>TriggerBuilder：触发器创建器，用于创建触发器 trigger 实例</li>\n<li>JobListener、TriggerListener、SchedulerListener 监听器，用于对组件的监听</li>\n</ul>\n<h3 id=\"7-入门案例\"><a class=\"anchor\" href=\"#7-入门案例\">#</a> 7、入门案例</h3>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">构建一个任务类实现Job接口，重写execute（执行方法）方法，在执行方法中编写定时调度需要实现的逻辑。</span><br><span class=\"line\">创建一个main方法，在main方法中构建任务实例和处方实例有调度器实例进行绑定并开启任务。</span><br></pre></td></tr></table></figure></p>\n<h5 id=\"1-pomxml\"><a class=\"anchor\" href=\"#1-pomxml\">#</a> 1、pom.xml</h5>\n<p><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.quartz-scheduler<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>quartz<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>2.3.0<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.quartz-scheduler<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>quartz-jobs<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>2.3.0<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.projectlombok<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>lombok<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></p>\n<h5 id=\"2-任务类\"><a class=\"anchor\" href=\"#2-任务类\">#</a> 2、任务类</h5>\n<p><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@Desc</span> 任务类</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">HelloJob</span> <span class=\"keyword\">implements</span> <span class=\"title class_\">Job</span> &#123;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">execute</span><span class=\"params\">(JobExecutionContext jobExecutionContext)</span> <span class=\"keyword\">throws</span> JobExecutionException &#123;</span><br><span class=\"line\">        log.info(<span class=\"keyword\">new</span> <span class=\"title class_\">SimpleDateFormat</span>(<span class=\"string\">&quot;yyyy-MM-dd hh:mm:ss&quot;</span>).format(<span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>()) + <span class=\"string\">&quot; | 任务被执行了&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<h5 id=\"3-调度器\"><a class=\"anchor\" href=\"#3-调度器\">#</a> 3、调度器</h5>\n<p><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@Desc</span> 调度器</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">HelloSchedulerDemo</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> SchedulerException &#123;</span><br><span class=\"line\">        <span class=\"comment\">//从调度工厂中获取调度器实例</span></span><br><span class=\"line\">        <span class=\"type\">Scheduler</span> <span class=\"variable\">scheduler</span> <span class=\"operator\">=</span> StdSchedulerFactory.getDefaultScheduler();</span><br><span class=\"line\">        <span class=\"comment\">//通过JobBuilder构建一个任务实例</span></span><br><span class=\"line\">        <span class=\"type\">JobDetail</span> <span class=\"variable\">jobDetail</span> <span class=\"operator\">=</span> JobBuilder.newJob(HelloJob.class)</span><br><span class=\"line\">                <span class=\"comment\">//设置任务的唯一实例名称和任务组名称组名</span></span><br><span class=\"line\">                .withIdentity(<span class=\"string\">&quot;job1&quot;</span>, <span class=\"string\">&quot;group1&quot;</span>)</span><br><span class=\"line\">                <span class=\"comment\">//构建实例</span></span><br><span class=\"line\">                .build();</span><br><span class=\"line\">        <span class=\"comment\">//通过TriggerBuilder构建触发器实例</span></span><br><span class=\"line\">        <span class=\"type\">SimpleTrigger</span> <span class=\"variable\">trigger</span> <span class=\"operator\">=</span> TriggerBuilder.newTrigger()</span><br><span class=\"line\">                <span class=\"comment\">//设置触发器唯一实例名称和触发器的组名</span></span><br><span class=\"line\">                .withIdentity(<span class=\"string\">&quot;trigger1&quot;</span>, <span class=\"string\">&quot;group1&quot;</span>)</span><br><span class=\"line\">                <span class=\"comment\">//执行计划，每五秒执行一次</span></span><br><span class=\"line\">                .withSchedule(SimpleScheduleBuilder.repeatSecondlyForever(<span class=\"number\">5</span>))</span><br><span class=\"line\">                <span class=\"comment\">//立即执行</span></span><br><span class=\"line\">                .startNow()</span><br><span class=\"line\">                <span class=\"comment\">//构建实例</span></span><br><span class=\"line\">                .build();</span><br><span class=\"line\">        <span class=\"comment\">//调度器绑定任务实例和触发器</span></span><br><span class=\"line\">        scheduler.scheduleJob(jobDetail,trigger);</span><br><span class=\"line\">        <span class=\"comment\">//开启定时任务</span></span><br><span class=\"line\">        scheduler.start();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>启动程序观察控制台输出内容</p>\n<h3 id=\"8-job和jobdetail的关系介绍\"><a class=\"anchor\" href=\"#8-job和jobdetail的关系介绍\">#</a> 8、Job 和 JobDetail 的关系介绍</h3>\n<ul>\n<li>Job：工作任务调度接口，任务类需要实现的接口。该接口中定义了 execute 方法，类似 JDK 提供的 TimeTask 类的 run 方法。在这里面编写任务执行的业务逻辑</li>\n<li>Job 实例在 Quartz 中的生命周期：每次调度器执行 Job 时，它在调用 execute 方法前会创建一个新的 Job 实例，当调度完成后，管理的 Job 对象实例将会被释放，释放的实例会被垃圾回收机制回收</li>\n</ul>\n<p><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">HelloJob</span> <span class=\"keyword\">implements</span> <span class=\"title class_\">Job</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"title function_\">HelloJob</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        log.info(<span class=\"string\">&quot;实例被创建了&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">execute</span><span class=\"params\">(JobExecutionContext jobExecutionContext)</span> <span class=\"keyword\">throws</span> JobExecutionException &#123;</span><br><span class=\"line\">        log.info(<span class=\"keyword\">new</span> <span class=\"title class_\">SimpleDateFormat</span>(<span class=\"string\">&quot;yyyy-MM-dd hh:mm:ss&quot;</span>).format(<span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>()) + <span class=\"string\">&quot; | 任务被执行了&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p><img data-src=\"D:%5CPictures%5Ctypore%5C006V2BDqly8hqtasabnb0j31a1094jx4.jpg\" alt=\"\" /></p>\n<ul>\n<li>JobDetail：JobDetail 为 Job 实例提供了许多设置属性，已经 JobDetaMap 成员变量属性，它用来存储特定 Job 实例的状态信息，调度器需要借助于 JobDetail 对象来添加 Job 实例【JobDetail 中重要的属性：name [任务实例的唯一标识名称]、group [任务调度实例的组名]、jobClass [任务类信息]、jobDataMap】</li>\n</ul>\n<p><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">HelloSchedulerDemo</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> SchedulerException &#123;</span><br><span class=\"line\">        <span class=\"comment\">//从调度工厂中获取调度器实例</span></span><br><span class=\"line\">        <span class=\"type\">Scheduler</span> <span class=\"variable\">scheduler</span> <span class=\"operator\">=</span> StdSchedulerFactory.getDefaultScheduler();</span><br><span class=\"line\">        <span class=\"comment\">//通过JobBuilder构建一个任务实例</span></span><br><span class=\"line\">        <span class=\"type\">JobDetail</span> <span class=\"variable\">jobDetail</span> <span class=\"operator\">=</span> JobBuilder.newJob(HelloJob.class)</span><br><span class=\"line\">                <span class=\"comment\">//设置任务的唯一实例名称和任务组名称组名</span></span><br><span class=\"line\">                .withIdentity(<span class=\"string\">&quot;job1&quot;</span>, <span class=\"string\">&quot;group1&quot;</span>)</span><br><span class=\"line\">                <span class=\"comment\">//构建实例</span></span><br><span class=\"line\">                .build();</span><br><span class=\"line\">        <span class=\"comment\">//jobDataMap</span></span><br><span class=\"line\">        <span class=\"type\">JobDataMap</span> <span class=\"variable\">jobDataMap</span> <span class=\"operator\">=</span> jobDetail.getJobDataMap();</span><br><span class=\"line\">        <span class=\"comment\">//任务实例的唯一标识名称</span></span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">name</span> <span class=\"operator\">=</span> jobDetail.getKey().getName();</span><br><span class=\"line\">        <span class=\"comment\">//任务调度实例的组名</span></span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">group</span> <span class=\"operator\">=</span> jobDetail.getKey().getGroup();</span><br><span class=\"line\">        <span class=\"comment\">//任务类信息</span></span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">clazzName</span> <span class=\"operator\">=</span> jobDetail.getKey().getClass().getName();</span><br><span class=\"line\">        log.info(<span class=\"string\">&quot;jobDataMap:&#123;&#125;&quot;</span>, jobDataMap);</span><br><span class=\"line\">        log.info(<span class=\"string\">&quot;任务实例的唯一标识名称：&quot;</span>+name);</span><br><span class=\"line\">        log.info(<span class=\"string\">&quot;任务调度实例的组名：&quot;</span>+group);</span><br><span class=\"line\">        log.info(<span class=\"string\">&quot;任务类信息：&quot;</span>+clazzName);</span><br><span class=\"line\">        <span class=\"comment\">//通过TriggerBuilder构建触发器实例</span></span><br><span class=\"line\">        <span class=\"type\">SimpleTrigger</span> <span class=\"variable\">trigger</span> <span class=\"operator\">=</span> TriggerBuilder.newTrigger()</span><br><span class=\"line\">                <span class=\"comment\">//设置触发器唯一实例名称和触发器的组名</span></span><br><span class=\"line\">                .withIdentity(<span class=\"string\">&quot;trigger1&quot;</span>, <span class=\"string\">&quot;group1&quot;</span>)</span><br><span class=\"line\">                <span class=\"comment\">//执行计划，每五秒执行一次</span></span><br><span class=\"line\">                .withSchedule(SimpleScheduleBuilder.repeatSecondlyForever(<span class=\"number\">5</span>))</span><br><span class=\"line\">                <span class=\"comment\">//立即执行</span></span><br><span class=\"line\">                .startNow()</span><br><span class=\"line\">                <span class=\"comment\">//构建实例</span></span><br><span class=\"line\">                .build();</span><br><span class=\"line\">        <span class=\"comment\">//调度器绑定任务实例和触发器</span></span><br><span class=\"line\">        scheduler.scheduleJob(jobDetail,trigger);</span><br><span class=\"line\">        <span class=\"comment\">//开启定时任务</span></span><br><span class=\"line\">        scheduler.start();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p><img data-src=\"D:%5CPictures%5Ctypore%5C006V2BDqly8hqtatu9hkoj30yi07dq5n.jpg\" alt=\"\" /></p>\n<h3 id=\"9-jobexecutioncontext的介绍\"><a class=\"anchor\" href=\"#9-jobexecutioncontext的介绍\">#</a> 9、JobExecutionContext 的介绍</h3>\n<ul>\n<li>\n<p>当 Scheduler 调用一个 Job，就会将 JobExecutionContext 传递给 Job 的 execute () 方法</p>\n</li>\n<li>\n<p>Job 能通过 JobExecuteContext 对象访问到 Quartz <code>运行时的环境</code> 以及 <code>Job本身的明细数据</code></p>\n<ul>\n<li>\n<p>获取 JobDetail 相关信息、获取 Trigger 相关信息、获取 Job 类本身的信息</p>\n<p><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@Desc</span> 任务类</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">HelloJob</span> <span class=\"keyword\">implements</span> <span class=\"title class_\">Job</span> &#123;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">execute</span><span class=\"params\">(JobExecutionContext jobExecutionContext)</span> <span class=\"keyword\">throws</span> JobExecutionException &#123;</span><br><span class=\"line\">        <span class=\"comment\">//通过JobExecutionContext获取JobDetail</span></span><br><span class=\"line\">        <span class=\"type\">JobDetail</span> <span class=\"variable\">jobDetail</span> <span class=\"operator\">=</span> jobExecutionContext.getJobDetail();</span><br><span class=\"line\">        <span class=\"type\">JobKey</span> <span class=\"variable\">jobKey</span> <span class=\"operator\">=</span> jobDetail.getKey();</span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">jobDetailName</span> <span class=\"operator\">=</span> jobKey.getName();</span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">jobDetailGroup</span> <span class=\"operator\">=</span> jobKey.getGroup();</span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">jobClazzNameJobDetail</span> <span class=\"operator\">=</span> jobKey.getClass().getName();</span><br><span class=\"line\">        log.info(<span class=\"string\">&quot;任务实例的唯一标识名称：&quot;</span> + jobDetailName);</span><br><span class=\"line\">        log.info(<span class=\"string\">&quot;任务实例的组名：&quot;</span> + jobDetailGroup);</span><br><span class=\"line\">        log.info(<span class=\"string\">&quot;任务实例绑定的任务类信息：&quot;</span> + jobClazzNameJobDetail);</span><br><span class=\"line\">        log.info(<span class=\"string\">&quot;-----------------------------------------&quot;</span>);</span><br><span class=\"line\">        <span class=\"comment\">//通过JobExecutionContext获取Trigger</span></span><br><span class=\"line\">        <span class=\"type\">Trigger</span> <span class=\"variable\">trigger</span> <span class=\"operator\">=</span> jobExecutionContext.getTrigger();</span><br><span class=\"line\">        <span class=\"type\">TriggerKey</span> <span class=\"variable\">triggerKey</span> <span class=\"operator\">=</span> trigger.getKey();</span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">triggerKeyName</span> <span class=\"operator\">=</span> triggerKey.getName();</span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">triggerKeyGroup</span> <span class=\"operator\">=</span> triggerKey.getGroup();</span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">triggerClazzName</span> <span class=\"operator\">=</span> triggerKey.getClass().getName();</span><br><span class=\"line\">        log.info(<span class=\"string\">&quot;触发器的唯一标识名称：&quot;</span> + triggerKeyName);</span><br><span class=\"line\">        log.info(<span class=\"string\">&quot;触发器的组名：&quot;</span> + triggerKeyGroup);</span><br><span class=\"line\">        log.info(<span class=\"string\">&quot;触发器绑定的任务类信息：&quot;</span> + triggerClazzName);</span><br><span class=\"line\">        log.info(<span class=\"string\">&quot;-----------------------------------------&quot;</span>);</span><br><span class=\"line\">        <span class=\"comment\">//通过JobExecutionContext</span></span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">jobClazzName</span> <span class=\"operator\">=</span> jobExecutionContext.getClass().getName();</span><br><span class=\"line\">        log.info(<span class=\"string\">&quot;job类相关的信息：&quot;</span>+jobClazzName);</span><br><span class=\"line\">        log.info(<span class=\"string\">&quot;-----------------------------------------&quot;</span>);</span><br><span class=\"line\">        log.info(<span class=\"keyword\">new</span> <span class=\"title class_\">SimpleDateFormat</span>(<span class=\"string\">&quot;yyyy-MM-dd hh:mm:ss&quot;</span>).format(<span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>()) + <span class=\"string\">&quot; | 任务被执行了&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"10-jobdatamap介绍\"><a class=\"anchor\" href=\"#10-jobdatamap介绍\">#</a> 10、JobDataMap 介绍</h3>\n<h5 id=\"1-使用map获取\"><a class=\"anchor\" href=\"#1-使用map获取\">#</a> 1、使用 Map 获取</h5>\n<ul>\n<li>在进行任务调度时，JobDataMap 存储在 JobExecutionContent 中，非常方便获取</li>\n<li>JobDataMap 可以用来存储任何可序列化的数据对象，当 Job 实例对象被执行时这些参数都会传递给它</li>\n<li>JobDataMap 实现了 JDK 的 Map 接口，并且添加了非常方便的方法来存储基本数据类型</li>\n</ul>\n<p><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@Desc</span> 调度器</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">HelloSchedulerDemo</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> SchedulerException &#123;</span><br><span class=\"line\">        <span class=\"comment\">//从调度工厂中获取调度器实例</span></span><br><span class=\"line\">        <span class=\"type\">Scheduler</span> <span class=\"variable\">scheduler</span> <span class=\"operator\">=</span> StdSchedulerFactory.getDefaultScheduler();</span><br><span class=\"line\">        <span class=\"comment\">//通过JobBuilder构建一个任务实例</span></span><br><span class=\"line\">        <span class=\"type\">JobDetail</span> <span class=\"variable\">jobDetail</span> <span class=\"operator\">=</span> JobBuilder.newJob(HelloJob.class)</span><br><span class=\"line\">                <span class=\"comment\">//设置任务的唯一实例名称和任务组名称组名</span></span><br><span class=\"line\">                .withIdentity(<span class=\"string\">&quot;job1&quot;</span>, <span class=\"string\">&quot;group1&quot;</span>)</span><br><span class=\"line\">                <span class=\"comment\">//设置jobDataMap数据  &lt;&lt;===============</span></span><br><span class=\"line\">                .usingJobData(<span class=\"string\">&quot;message&quot;</span>,<span class=\"string\">&quot;勇敢牛牛、不怕困难&quot;</span>)</span><br><span class=\"line\">                <span class=\"comment\">//构建实例</span></span><br><span class=\"line\">                .build();</span><br><span class=\"line\">        <span class=\"comment\">//通过TriggerBuilder构建触发器实例</span></span><br><span class=\"line\">        <span class=\"type\">SimpleTrigger</span> <span class=\"variable\">trigger</span> <span class=\"operator\">=</span> TriggerBuilder.newTrigger()</span><br><span class=\"line\">                <span class=\"comment\">//设置触发器唯一实例名称和触发器的组名</span></span><br><span class=\"line\">                .withIdentity(<span class=\"string\">&quot;trigger1&quot;</span>, <span class=\"string\">&quot;group1&quot;</span>)</span><br><span class=\"line\">                <span class=\"comment\">//设置jobDataMap数据   &lt;&lt;===============</span></span><br><span class=\"line\">                .usingJobData(<span class=\"string\">&quot;username&quot;</span>,<span class=\"string\">&quot;张三&quot;</span>)</span><br><span class=\"line\">                <span class=\"comment\">//执行计划，每五秒执行一次</span></span><br><span class=\"line\">                .withSchedule(SimpleScheduleBuilder.repeatSecondlyForever(<span class=\"number\">5</span>))</span><br><span class=\"line\">                <span class=\"comment\">//立即执行</span></span><br><span class=\"line\">                .startNow()</span><br><span class=\"line\">                <span class=\"comment\">//构建实例</span></span><br><span class=\"line\">                .build();</span><br><span class=\"line\">        <span class=\"comment\">//调度器绑定任务实例和触发器</span></span><br><span class=\"line\">        scheduler.scheduleJob(jobDetail,trigger);</span><br><span class=\"line\">        <span class=\"comment\">//开启定时任务</span></span><br><span class=\"line\">        scheduler.start();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@Desc</span> 任务类</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">HelloJob</span> <span class=\"keyword\">implements</span> <span class=\"title class_\">Job</span> &#123;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">execute</span><span class=\"params\">(JobExecutionContext jobExecutionContext)</span> <span class=\"keyword\">throws</span> JobExecutionException &#123;</span><br><span class=\"line\">        <span class=\"comment\">//通过JobExecutionContext获取JobDetail</span></span><br><span class=\"line\">        <span class=\"type\">JobDetail</span> <span class=\"variable\">jobDetail</span> <span class=\"operator\">=</span> jobExecutionContext.getJobDetail();</span><br><span class=\"line\">        <span class=\"type\">JobKey</span> <span class=\"variable\">jobKey</span> <span class=\"operator\">=</span> jobDetail.getKey();</span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">jobDetailName</span> <span class=\"operator\">=</span> jobKey.getName();</span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">jobDetailGroup</span> <span class=\"operator\">=</span> jobKey.getGroup();</span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">jobClazzNameJobDetail</span> <span class=\"operator\">=</span> jobKey.getClass().getName();</span><br><span class=\"line\">        log.info(<span class=\"string\">&quot;任务实例的唯一标识名称：&quot;</span> + jobDetailName);</span><br><span class=\"line\">        log.info(<span class=\"string\">&quot;任务实例的组名：&quot;</span> + jobDetailGroup);</span><br><span class=\"line\">        log.info(<span class=\"string\">&quot;任务实例绑定的任务类信息：&quot;</span> + jobClazzNameJobDetail);</span><br><span class=\"line\">        log.info(<span class=\"string\">&quot;-----------------------------------------&quot;</span>);</span><br><span class=\"line\">        <span class=\"comment\">//通过JobExecutionContext获取Trigger</span></span><br><span class=\"line\">        <span class=\"type\">Trigger</span> <span class=\"variable\">trigger</span> <span class=\"operator\">=</span> jobExecutionContext.getTrigger();</span><br><span class=\"line\">        <span class=\"type\">TriggerKey</span> <span class=\"variable\">triggerKey</span> <span class=\"operator\">=</span> trigger.getKey();</span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">triggerKeyName</span> <span class=\"operator\">=</span> triggerKey.getName();</span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">triggerKeyGroup</span> <span class=\"operator\">=</span> triggerKey.getGroup();</span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">triggerClazzName</span> <span class=\"operator\">=</span> triggerKey.getClass().getName();</span><br><span class=\"line\">        log.info(<span class=\"string\">&quot;触发器的唯一标识名称：&quot;</span> + triggerKeyName);</span><br><span class=\"line\">        log.info(<span class=\"string\">&quot;触发器的组名：&quot;</span> + triggerKeyGroup);</span><br><span class=\"line\">        log.info(<span class=\"string\">&quot;触发器绑定的任务类信息：&quot;</span> + triggerClazzName);</span><br><span class=\"line\">        log.info(<span class=\"string\">&quot;-----------------------------------------&quot;</span>);</span><br><span class=\"line\">        <span class=\"comment\">//通过JobExecutionContext</span></span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">jobClazzName</span> <span class=\"operator\">=</span> jobExecutionContext.getClass().getName();</span><br><span class=\"line\">        log.info(<span class=\"string\">&quot;job类相关的信息：&quot;</span>+jobClazzName);</span><br><span class=\"line\">        log.info(<span class=\"string\">&quot;-----------------------------------------&quot;</span>);</span><br><span class=\"line\">        <span class=\"comment\">//获取JobDetail中JobDataMap中的message内容  &lt;&lt;===============</span></span><br><span class=\"line\">        <span class=\"type\">JobDataMap</span> <span class=\"variable\">jobDataMap</span> <span class=\"operator\">=</span> jobDetail.getJobDataMap();</span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">message</span> <span class=\"operator\">=</span> jobDataMap.getString(<span class=\"string\">&quot;message&quot;</span>);</span><br><span class=\"line\">        log.info(<span class=\"string\">&quot;从JobDetail-JobDataMap中或到的message内容为：&quot;</span> + message);</span><br><span class=\"line\">        <span class=\"comment\">//获取Trigger中JobDataMap中的username内容   &lt;&lt;===============</span></span><br><span class=\"line\">        <span class=\"type\">JobDataMap</span> <span class=\"variable\">triggerJobDataMap</span> <span class=\"operator\">=</span> trigger.getJobDataMap();</span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">username</span> <span class=\"operator\">=</span> triggerJobDataMap.getString(<span class=\"string\">&quot;username&quot;</span>);</span><br><span class=\"line\">        log.info(<span class=\"string\">&quot;从Trigger-JobDataMap中获取到的username内容为：&quot;</span> + username);</span><br><span class=\"line\">        log.info(<span class=\"string\">&quot;-----------------------------------------&quot;</span>);</span><br><span class=\"line\">        log.info(<span class=\"keyword\">new</span> <span class=\"title class_\">SimpleDateFormat</span>(<span class=\"string\">&quot;yyyy-MM-dd hh:mm:ss&quot;</span>).format(<span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>()) + <span class=\"string\">&quot; | 任务被执行了&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p><img data-src=\"D:%5CPictures%5Ctypore%5C006V2BDqly8hqtay96pxjj310u07l77f.jpg\" alt=\"\" /></p>\n<h5 id=\"2-job实现类中添加setter方法对应jobdatamap的键值quartz框架默认的jobfactory实现类在初始化job实例对象时会自动的调用这些setter方法\"><a class=\"anchor\" href=\"#2-job实现类中添加setter方法对应jobdatamap的键值quartz框架默认的jobfactory实现类在初始化job实例对象时会自动的调用这些setter方法\">#</a> 2、Job 实现类中添加 setter 方法对应 JobDataMap 的键值，Quartz 框架默认的 JobFactory 实现类在初始化 Job 实例对象时会自动的调用这些 setter 方法</h5>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">调度器的内容是不变的。</span><br><span class=\"line\">注意：如果任务实例和触发器的JobDataMap中使用的是同一个key那么触发器的JobDataMap值会覆盖掉任务实例的值</span><br></pre></td></tr></table></figure></p>\n<p><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@Desc</span> 任务类</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">HelloJob</span> <span class=\"keyword\">implements</span> <span class=\"title class_\">Job</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String message;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String username;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">setMessage</span><span class=\"params\">(String message)</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.message = message;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">setUsername</span><span class=\"params\">(String username)</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.username = username;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">execute</span><span class=\"params\">(JobExecutionContext jobExecutionContext)</span> <span class=\"keyword\">throws</span> JobExecutionException &#123;</span><br><span class=\"line\">        <span class=\"comment\">//通过JobExecutionContext获取JobDetail</span></span><br><span class=\"line\">        <span class=\"type\">JobDetail</span> <span class=\"variable\">jobDetail</span> <span class=\"operator\">=</span> jobExecutionContext.getJobDetail();</span><br><span class=\"line\">        <span class=\"type\">JobKey</span> <span class=\"variable\">jobKey</span> <span class=\"operator\">=</span> jobDetail.getKey();</span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">jobDetailName</span> <span class=\"operator\">=</span> jobKey.getName();</span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">jobDetailGroup</span> <span class=\"operator\">=</span> jobKey.getGroup();</span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">jobClazzNameJobDetail</span> <span class=\"operator\">=</span> jobKey.getClass().getName();</span><br><span class=\"line\">        log.info(<span class=\"string\">&quot;任务实例的唯一标识名称：&quot;</span> + jobDetailName);</span><br><span class=\"line\">        log.info(<span class=\"string\">&quot;任务实例的组名：&quot;</span> + jobDetailGroup);</span><br><span class=\"line\">        log.info(<span class=\"string\">&quot;任务实例绑定的任务类信息：&quot;</span> + jobClazzNameJobDetail);</span><br><span class=\"line\">        log.info(<span class=\"string\">&quot;-----------------------------------------&quot;</span>);</span><br><span class=\"line\">        <span class=\"comment\">//通过JobExecutionContext获取Trigger</span></span><br><span class=\"line\">        <span class=\"type\">Trigger</span> <span class=\"variable\">trigger</span> <span class=\"operator\">=</span> jobExecutionContext.getTrigger();</span><br><span class=\"line\">        <span class=\"type\">TriggerKey</span> <span class=\"variable\">triggerKey</span> <span class=\"operator\">=</span> trigger.getKey();</span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">triggerKeyName</span> <span class=\"operator\">=</span> triggerKey.getName();</span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">triggerKeyGroup</span> <span class=\"operator\">=</span> triggerKey.getGroup();</span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">triggerClazzName</span> <span class=\"operator\">=</span> triggerKey.getClass().getName();</span><br><span class=\"line\">        log.info(<span class=\"string\">&quot;触发器的唯一标识名称：&quot;</span> + triggerKeyName);</span><br><span class=\"line\">        log.info(<span class=\"string\">&quot;触发器的组名：&quot;</span> + triggerKeyGroup);</span><br><span class=\"line\">        log.info(<span class=\"string\">&quot;触发器绑定的任务类信息：&quot;</span> + triggerClazzName);</span><br><span class=\"line\">        log.info(<span class=\"string\">&quot;-----------------------------------------&quot;</span>);</span><br><span class=\"line\">        <span class=\"comment\">//通过JobExecutionContext</span></span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">jobClazzName</span> <span class=\"operator\">=</span> jobExecutionContext.getClass().getName();</span><br><span class=\"line\">        log.info(<span class=\"string\">&quot;job类相关的信息：&quot;</span>+jobClazzName);</span><br><span class=\"line\">        log.info(<span class=\"string\">&quot;-----------------------------------------&quot;</span>);</span><br><span class=\"line\">        <span class=\"comment\">//获取JobDetail中JobDataMap中的message内容</span></span><br><span class=\"line\">        <span class=\"comment\">//JobDataMap jobDataMap = jobDetail.getJobDataMap();</span></span><br><span class=\"line\">        <span class=\"comment\">//String message = jobDataMap.getString(&quot;message&quot;);</span></span><br><span class=\"line\">        log.info(<span class=\"string\">&quot;从JobDetail-JobDataMap中或到的message内容为：&quot;</span> + message);</span><br><span class=\"line\">        <span class=\"comment\">//获取Trigger中JobDataMap中的username内容</span></span><br><span class=\"line\">        <span class=\"comment\">//JobDataMap triggerJobDataMap = trigger.getJobDataMap();</span></span><br><span class=\"line\">        <span class=\"comment\">//String username = triggerJobDataMap.getString(&quot;username&quot;);</span></span><br><span class=\"line\">        log.info(<span class=\"string\">&quot;从Trigger-JobDataMap中获取到的username内容为：&quot;</span> + username);</span><br><span class=\"line\">        log.info(<span class=\"string\">&quot;-----------------------------------------&quot;</span>);</span><br><span class=\"line\">        log.info(<span class=\"keyword\">new</span> <span class=\"title class_\">SimpleDateFormat</span>(<span class=\"string\">&quot;yyyy-MM-dd hh:mm:ss&quot;</span>).format(<span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>()) + <span class=\"string\">&quot; | 任务被执行了&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p><img data-src=\"D:%5CPictures%5Ctypore%5C006V2BDqly8hqtazsfjwpj310y08cwi2.jpg\" alt=\"\" /></p>\n<h5 id=\"3-获取其他\"><a class=\"anchor\" href=\"#3-获取其他\">#</a> 3、获取其他</h5>\n<p><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//获取任务的本次执行时间</span></span><br><span class=\"line\"><span class=\"type\">Date</span> <span class=\"variable\">fireTime</span> <span class=\"operator\">=</span> jobExecutionContext.getFireTime();</span><br><span class=\"line\"><span class=\"comment\">//获取任务的下次执行时间</span></span><br><span class=\"line\"><span class=\"type\">Date</span> <span class=\"variable\">nextFireTime</span> <span class=\"operator\">=</span> jobExecutionContext.getNextFireTime();</span><br><span class=\"line\"></span><br><span class=\"line\">log.info(<span class=\"string\">&quot;任务的本次执行时间：&quot;</span> + <span class=\"keyword\">new</span> <span class=\"title class_\">SimpleDateFormat</span>(<span class=\"string\">&quot;yyyy-MM-dd hh:mm:ss&quot;</span>).format(fireTime));</span><br><span class=\"line\">log.info(<span class=\"string\">&quot;任务的下次执行时间：&quot;</span> + <span class=\"keyword\">new</span> <span class=\"title class_\">SimpleDateFormat</span>(<span class=\"string\">&quot;yyyy-MM-dd hh:mm:ss&quot;</span>).format(nextFireTime));</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure></p>\n<h3 id=\"11-有状态的job和无状态的job\"><a class=\"anchor\" href=\"#11-有状态的job和无状态的job\">#</a> 11、有状态的 Job 和无状态的 Job</h3>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">有状态的Job可以理解为多次Job调用期间可以持有一些状态信息，这些状态信息存储在JobDataMap中，而默认的无状态Job每次调用时都会创建一个新的JobDataMap</span><br></pre></td></tr></table></figure></p>\n<h5 id=\"1-job默认是无状态的通过如下示例查看\"><a class=\"anchor\" href=\"#1-job默认是无状态的通过如下示例查看\">#</a> 1、Job 默认是无状态的，通过如下示例查看</h5>\n<p><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.scholartang.quartz.main;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> com.scholartang.quartz.job.HelloJob;</span><br><span class=\"line\"><span class=\"keyword\">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.quartz.*;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.quartz.impl.StdSchedulerFactory;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.quartz.impl.triggers.CoreTrigger;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@Desc</span> 调度器</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">HelloSchedulerDemo</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> SchedulerException &#123;</span><br><span class=\"line\">        <span class=\"comment\">//从调度工厂中获取调度器实例</span></span><br><span class=\"line\">        <span class=\"type\">Scheduler</span> <span class=\"variable\">scheduler</span> <span class=\"operator\">=</span> StdSchedulerFactory.getDefaultScheduler();</span><br><span class=\"line\">        <span class=\"comment\">//通过JobBuilder构建一个任务实例</span></span><br><span class=\"line\">        <span class=\"type\">JobDetail</span> <span class=\"variable\">jobDetail</span> <span class=\"operator\">=</span> JobBuilder.newJob(HelloJob.class)</span><br><span class=\"line\">                <span class=\"comment\">//设置任务的唯一实例名称和任务组名称组名</span></span><br><span class=\"line\">                .withIdentity(<span class=\"string\">&quot;job1&quot;</span>, <span class=\"string\">&quot;group1&quot;</span>)</span><br><span class=\"line\">                <span class=\"comment\">//设置jobDataMap数据   &lt;&lt;===============</span></span><br><span class=\"line\">                .usingJobData(<span class=\"string\">&quot;count&quot;</span>,<span class=\"number\">0</span>)</span><br><span class=\"line\">                <span class=\"comment\">//构建实例</span></span><br><span class=\"line\">                .build();</span><br><span class=\"line\">        <span class=\"comment\">//通过TriggerBuilder构建触发器实例</span></span><br><span class=\"line\">        <span class=\"type\">SimpleTrigger</span> <span class=\"variable\">trigger</span> <span class=\"operator\">=</span> TriggerBuilder.newTrigger()</span><br><span class=\"line\">                <span class=\"comment\">//设置触发器唯一实例名称和触发器的组名</span></span><br><span class=\"line\">                .withIdentity(<span class=\"string\">&quot;trigger1&quot;</span>, <span class=\"string\">&quot;group1&quot;</span>)</span><br><span class=\"line\">                <span class=\"comment\">//执行计划，每五秒执行一次</span></span><br><span class=\"line\">                .withSchedule(SimpleScheduleBuilder.repeatSecondlyForever(<span class=\"number\">5</span>))</span><br><span class=\"line\">                <span class=\"comment\">//立即执行</span></span><br><span class=\"line\">                .startNow()</span><br><span class=\"line\">                <span class=\"comment\">//构建实例</span></span><br><span class=\"line\">                .build();</span><br><span class=\"line\">        <span class=\"comment\">//调度器绑定任务实例和触发器</span></span><br><span class=\"line\">        scheduler.scheduleJob(jobDetail,trigger);</span><br><span class=\"line\">        <span class=\"comment\">//开启定时任务</span></span><br><span class=\"line\">        scheduler.start();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure></p>\n<p><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@Desc</span> 任务类</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">HelloJob</span> <span class=\"keyword\">implements</span> <span class=\"title class_\">Job</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> Integer count;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">setCount</span><span class=\"params\">(Integer count)</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.count = count;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">execute</span><span class=\"params\">(JobExecutionContext jobExecutionContext)</span> <span class=\"keyword\">throws</span> JobExecutionException &#123;</span><br><span class=\"line\">        <span class=\"comment\">//通过JobExecutionContext获取JobDetail</span></span><br><span class=\"line\">        <span class=\"type\">JobDetail</span> <span class=\"variable\">jobDetail</span> <span class=\"operator\">=</span> jobExecutionContext.getJobDetail();</span><br><span class=\"line\">        count++;</span><br><span class=\"line\">        jobDetail.getJobDataMap().put(<span class=\"string\">&quot;count&quot;</span>,count);</span><br><span class=\"line\">        log.info(<span class=\"keyword\">new</span> <span class=\"title class_\">SimpleDateFormat</span>(<span class=\"string\">&quot;yyyy-MM-dd hh:mm:ss&quot;</span>).format(<span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>()) + <span class=\"string\">&quot; | 任务被执行了&quot;</span>);</span><br><span class=\"line\">        log.info(<span class=\"string\">&quot;当前count的值为：&quot;</span> + count);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p><img data-src=\"D:%5CPictures%5Ctypore%5C006V2BDqly8hqtb29vk90j30va0dste1.jpg\" alt=\"\" /></p>\n<h5 id=\"2-通过persistjobdataafterexecution注解将job设置为由状态的\"><a class=\"anchor\" href=\"#2-通过persistjobdataafterexecution注解将job设置为由状态的\">#</a> 2、通过 @PersistJobDataAfterExecution 注解将 Job 设置为由状态的</h5>\n<p><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@Desc</span> 任务类</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"meta\">@PersistJobDataAfterExecution</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">HelloJob</span> <span class=\"keyword\">implements</span> <span class=\"title class_\">Job</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> Integer count;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">setCount</span><span class=\"params\">(Integer count)</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.count = count;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">execute</span><span class=\"params\">(JobExecutionContext jobExecutionContext)</span> <span class=\"keyword\">throws</span> JobExecutionException &#123;</span><br><span class=\"line\">        <span class=\"comment\">//通过JobExecutionContext获取JobDetail</span></span><br><span class=\"line\">        <span class=\"type\">JobDetail</span> <span class=\"variable\">jobDetail</span> <span class=\"operator\">=</span> jobExecutionContext.getJobDetail();</span><br><span class=\"line\">        count++;</span><br><span class=\"line\">        jobDetail.getJobDataMap().put(<span class=\"string\">&quot;count&quot;</span>,count);</span><br><span class=\"line\">        log.info(<span class=\"keyword\">new</span> <span class=\"title class_\">SimpleDateFormat</span>(<span class=\"string\">&quot;yyyy-MM-dd hh:mm:ss&quot;</span>).format(<span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>()) + <span class=\"string\">&quot; | 任务被执行了&quot;</span>);</span><br><span class=\"line\">        log.info(<span class=\"string\">&quot;当前count的值为：&quot;</span> + count);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p><img data-src=\"D:%5CPictures%5Ctypore%5C006V2BDqly8hqtb51a8ltj30rp0ivwlr.jpg\" alt=\"\" /></p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">如果Job类没有添加@PersistJobDataAfterExecution注解，每次调用时都会创建一个新的JobDataMap。不会累加count的值</span><br><span class=\"line\">如果Job类添加了@PersistJobDataAfterExecution注解，每次调用期间都会持有一些状态信息，。会累加count的值</span><br></pre></td></tr></table></figure></p>\n<h3 id=\"12-trigger触发器的介绍\"><a class=\"anchor\" href=\"#12-trigger触发器的介绍\">#</a> 12、Trigger 触发器的介绍</h3>\n<p><img data-src=\"D:%5CPictures%5Ctypore%5C006V2BDqly8hqtb60xbe2j30v40e075w.jpg\" alt=\"\" /></p>\n<p>上图即是 Quartz 的触发器类型，常用的为 SimpleTriggerImpl，CronTriggerImpl</p>\n<h5 id=\"1-simpletriggerimpl的使用\"><a class=\"anchor\" href=\"#1-simpletriggerimpl的使用\">#</a> 1、SimpleTriggerImpl 的使用</h5>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">设置触发的开始时间和结束时间及执行计划</span><br></pre></td></tr></table></figure></p>\n<p><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@Desc</span> 任务类</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"meta\">@PersistJobDataAfterExecution</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">HelloJobTrigger</span> <span class=\"keyword\">implements</span> <span class=\"title class_\">Job</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">execute</span><span class=\"params\">(JobExecutionContext jobExecutionContext)</span> <span class=\"keyword\">throws</span> JobExecutionException &#123;</span><br><span class=\"line\">        <span class=\"type\">Trigger</span> <span class=\"variable\">trigger</span> <span class=\"operator\">=</span> jobExecutionContext.getTrigger();</span><br><span class=\"line\">        <span class=\"type\">JobKey</span> <span class=\"variable\">jobKey</span> <span class=\"operator\">=</span> trigger.getJobKey();</span><br><span class=\"line\">        log.info(<span class=\"string\">&quot;触发器名称：&quot;</span> + jobKey.getName() + <span class=\"string\">&quot; | 触发器组名：&quot;</span> + jobKey.getGroup() );</span><br><span class=\"line\">        log.info(<span class=\"string\">&quot;触发器开始执行时间：&quot;</span> + <span class=\"keyword\">new</span> <span class=\"title class_\">SimpleDateFormat</span>(<span class=\"string\">&quot;yyyy-MM-dd hh:mm:ss&quot;</span>).format(trigger.getStartTime()) + <span class=\"string\">&quot; | 触发器结束执行时间：&quot;</span> + <span class=\"keyword\">new</span> <span class=\"title class_\">SimpleDateFormat</span>(<span class=\"string\">&quot;yyyy-MM-dd hh:mm:ss&quot;</span>).format(trigger.getEndTime()));</span><br><span class=\"line\">        log.info(<span class=\"keyword\">new</span> <span class=\"title class_\">SimpleDateFormat</span>(<span class=\"string\">&quot;yyyy-MM-dd hh:mm:ss&quot;</span>).format(<span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>()) + <span class=\"string\">&quot; | 任务被执行了&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@Desc</span> 调度器</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">HelloSchedulerDemo</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> SchedulerException &#123;</span><br><span class=\"line\">        <span class=\"comment\">//开始时间 &amp; 结束时间</span></span><br><span class=\"line\">        <span class=\"type\">Date</span> <span class=\"variable\">startTime</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>();</span><br><span class=\"line\">        <span class=\"type\">Date</span> <span class=\"variable\">endTime</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>();</span><br><span class=\"line\">        endTime.setTime(endTime.getTime() + <span class=\"number\">20000</span>);</span><br><span class=\"line\">        <span class=\"comment\">//从调度工厂中获取调度器实例</span></span><br><span class=\"line\">        <span class=\"type\">Scheduler</span> <span class=\"variable\">scheduler</span> <span class=\"operator\">=</span> StdSchedulerFactory.getDefaultScheduler();</span><br><span class=\"line\">        <span class=\"comment\">//通过JobBuilder构建一个任务实例</span></span><br><span class=\"line\">        <span class=\"type\">JobDetail</span> <span class=\"variable\">jobDetail</span> <span class=\"operator\">=</span> JobBuilder.newJob(HelloJobTrigger.class)</span><br><span class=\"line\">                <span class=\"comment\">//设置任务的唯一实例名称和任务组名称组名</span></span><br><span class=\"line\">                .withIdentity(<span class=\"string\">&quot;job1&quot;</span>, <span class=\"string\">&quot;group1&quot;</span>)</span><br><span class=\"line\">                <span class=\"comment\">//构建实例</span></span><br><span class=\"line\">                .build();</span><br><span class=\"line\">        <span class=\"comment\">//通过TriggerBuilder构建触发器实例</span></span><br><span class=\"line\">        <span class=\"type\">SimpleTrigger</span> <span class=\"variable\">trigger</span> <span class=\"operator\">=</span> TriggerBuilder.newTrigger()</span><br><span class=\"line\">                <span class=\"comment\">//设置触发器唯一实例名称和触发器的组名</span></span><br><span class=\"line\">                .withIdentity(<span class=\"string\">&quot;trigger1&quot;</span>, <span class=\"string\">&quot;group1&quot;</span>)</span><br><span class=\"line\">                <span class=\"comment\">//执行计划，每五秒执行一次</span></span><br><span class=\"line\">                .withSchedule(SimpleScheduleBuilder.repeatSecondlyForever(<span class=\"number\">5</span>)</span><br><span class=\"line\">                               .withRepeatCount(SimpleTrigger.REPEAT_INDEFINITELY) <span class=\"comment\">//重复执行次数</span></span><br><span class=\"line\">                             )</span><br><span class=\"line\">                <span class=\"comment\">//开始执行时间</span></span><br><span class=\"line\">                .startAt(startTime)</span><br><span class=\"line\">                <span class=\"comment\">//结束执行时间</span></span><br><span class=\"line\">                .endAt(endTime)</span><br><span class=\"line\">                <span class=\"comment\">//构建实例</span></span><br><span class=\"line\">                .build();</span><br><span class=\"line\">        <span class=\"comment\">//调度器绑定任务实例和触发器</span></span><br><span class=\"line\">        scheduler.scheduleJob(jobDetail,trigger);</span><br><span class=\"line\">        <span class=\"comment\">//开启定时任务</span></span><br><span class=\"line\">        scheduler.start();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">注意：</span><br><span class=\"line\">SimpleTrigger的属性有：开始时间，结束时间，重复次数和重复时间间隔</span><br><span class=\"line\">重复次数的值可以为0、正数、或常量。例如：SimpleTrigger.REPEAT_INDEFINITELY</span><br><span class=\"line\">重复的时间间隔属性值必须为大于0或者长整型的整数，以毫秒为为时间单位，当重复的时间间隔为0时，意味着与Trigger同时触发执行</span><br><span class=\"line\">如果有指定结束时间属性值，则结束时间属性优先于重复次数属性，这样的好处在于；当我们需要创建一个每间隔10秒触发一次直到指定的结束时间的Trigger，而无需去计算从开始到结束的所重复执行次数。我们只需要简单的执行结束时间和使用REPEAT_INDEFINITELY作为重复次数的属性值即可</span><br></pre></td></tr></table></figure></p>\n<h3 id=\"13-crontrigger触发器的介绍\"><a class=\"anchor\" href=\"#13-crontrigger触发器的介绍\">#</a> 13、CronTrigger 触发器的介绍</h3>\n<h5 id=\"1-crontrigger简介\"><a class=\"anchor\" href=\"#1-crontrigger简介\">#</a> 1、CronTrigger 简介</h5>\n<p>如果需要像日历那样按日程来触发任务，而不是像 SimpleTrigger 那样每隔特定的间隔时间触发，CronTriggers 通常比 SimpleTrigger 更有用，因为它是基于日历的任务调度器</p>\n<p>使用 CronTrigger，可以指定诸如每个周五的 12 点，或者每天的 9 点等等… 这样的日程来安排触发。甚至还可以像 SimpleTrigger 一样，CornTrigger 也有一个 startTime 以指定日程从什么时候开始，也有一个（可选的）endTime 以指定任何日期不再继续配置、资源 SchedulerFactory</p>\n<h5 id=\"2-corn表达式\"><a class=\"anchor\" href=\"#2-corn表达式\">#</a> 2、corn 表达式</h5>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">corn表达式相信大家并不陌生，corn表达式被用来配置CronTrigger实例。corn表达式是一个由7个表达式组成的字符串。每一个子表达式描述了一个单独的日程细节。这些子表达式用空格分隔，分别表示：seconds秒、minutes分钟、hours小时、day-of-month月中的天、moth月，year年</span><br></pre></td></tr></table></figure></p>\n<p>在线生成 corn 表达式：<span class=\"exturl\" data-url=\"aHR0cHM6Ly9jcm9uLnFxZTIuY29tLw==\">https://cron.qqe2.com/</span></p>\n<p>cron 表达式详细介绍以及常用的例子：<span class=\"exturl\" data-url=\"aHR0cHM6Ly9kZXZlbG9wZXIuYWxpeXVuLmNvbS9hcnRpY2xlLzEzNDk4Mjc=\">https://developer.aliyun.com/article/1349827</span></p>\n<h5 id=\"案例\"><a class=\"anchor\" href=\"#案例\">#</a> 案例：</h5>\n<p><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@Desc</span> 任务类</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">HelloJonCornTrigger</span> <span class=\"keyword\">implements</span> <span class=\"title class_\">Job</span> &#123;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">execute</span><span class=\"params\">(JobExecutionContext context)</span> <span class=\"keyword\">throws</span> JobExecutionException &#123;</span><br><span class=\"line\">        log.info(<span class=\"keyword\">new</span> <span class=\"title class_\">SimpleDateFormat</span>(<span class=\"string\">&quot;yyyy-MM-dd hh:mm:ss&quot;</span>).format(<span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>()) + <span class=\"string\">&quot; | 任务被执行了&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure></p>\n<p><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@Desc</span> 调度器</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">HelloSchedulerDemo</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> SchedulerException &#123;</span><br><span class=\"line\">        <span class=\"comment\">//从调度工厂中获取调度器实例</span></span><br><span class=\"line\">        <span class=\"type\">Scheduler</span> <span class=\"variable\">scheduler</span> <span class=\"operator\">=</span> StdSchedulerFactory.getDefaultScheduler();</span><br><span class=\"line\">        <span class=\"comment\">//通过JobBuilder构建一个任务实例</span></span><br><span class=\"line\">        <span class=\"type\">JobDetail</span> <span class=\"variable\">jobDetail</span> <span class=\"operator\">=</span> JobBuilder.newJob(HelloJonCornTrigger.class)</span><br><span class=\"line\">                <span class=\"comment\">//设置任务的唯一实例名称和任务组名称组名</span></span><br><span class=\"line\">                .withIdentity(<span class=\"string\">&quot;job1&quot;</span>, <span class=\"string\">&quot;group1&quot;</span>)</span><br><span class=\"line\">                <span class=\"comment\">//构建实例</span></span><br><span class=\"line\">                .build();</span><br><span class=\"line\">        <span class=\"comment\">//通过TriggerBuilder构建触发器实例</span></span><br><span class=\"line\">        <span class=\"type\">Trigger</span> <span class=\"variable\">trigger</span> <span class=\"operator\">=</span> TriggerBuilder.newTrigger()</span><br><span class=\"line\">                <span class=\"comment\">//设置触发器唯一实例名称和触发器的组名</span></span><br><span class=\"line\">                .withIdentity(<span class=\"string\">&quot;trigger1&quot;</span>, <span class=\"string\">&quot;group1&quot;</span>)</span><br><span class=\"line\">            \t<span class=\"comment\">//立刻执行</span></span><br><span class=\"line\">                .startNow()</span><br><span class=\"line\">                <span class=\"comment\">//每年的每月的每个星期得每天的每小时的每秒都会执行</span></span><br><span class=\"line\">                .withSchedule(CronScheduleBuilder.cronSchedule(<span class=\"string\">&quot;* * * * * ?&quot;</span>))</span><br><span class=\"line\">                <span class=\"comment\">//构建实例</span></span><br><span class=\"line\">                .build();</span><br><span class=\"line\">        <span class=\"comment\">//调度器绑定任务实例和触发器</span></span><br><span class=\"line\">        scheduler.scheduleJob(jobDetail,trigger);</span><br><span class=\"line\">        <span class=\"comment\">//开启定时任务</span></span><br><span class=\"line\">        scheduler.start();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<h3 id=\"14-配置-资源schedulerfactory\"><a class=\"anchor\" href=\"#14-配置-资源schedulerfactory\">#</a> 14、配置、资源 SchedulerFactory</h3>\n<p>Quartz 以模块方式架构，因此要使它运行。几个组件必须要很好的咬合在一起。【现在已经有了一些现成的助手可以完成这些工作】</p>\n<p>所有 scheduler 实例是由 SchedulerFactory 创建。Quartz 的三个核心概念：调度器，任务，触发器。</p>\n<p>调度器，任务，触发器三者之间的关系为：</p>\n<p><img data-src=\"D:%5CPictures%5Ctypore%5C006V2BDqly8hqtbbbl8bkj30nw0d60to.jpg\" alt=\"\" /></p>\n<p>一个作业，比较重要的三个要素是 Scheduler，JobDetail，Trigger；而 Trigger 对于 Job 而言就好比一个驱动器；没有触发器来定时驱动作业，作业就无法运行；对于 Job 而言，一个 Job 可以对应多个 Trigger，但对于 Trigger 而言，一个 Trigger 只能对应一个 Job；所以一个 Trigger 只能指派给一个 Job；如果需要一个更复杂的触发计划，可以创建多个 Trigger 并指派他妈给同一个 Job</p>\n<h5 id=\"scheduler的创建方式\"><a class=\"anchor\" href=\"#scheduler的创建方式\">#</a> Scheduler 的创建方式</h5>\n<ul>\n<li>\n<p>StdSchedulerFactory</p>\n<p><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Quartz默认的SchedulerFactory</span><br><span class=\"line\"></span><br><span class=\"line\">使用一组参数（java.util.Properties）来创建和初始化Quartz调度器</span><br><span class=\"line\">配置参数一般存储在quartz.properties文件中</span><br><span class=\"line\">调用getScheduler方法就能穿件和初始化调度器对象</span><br><span class=\"line\"><span class=\"type\">SchedulerFactory</span> <span class=\"variable\">schedulerFactory</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">StdSchedulerFactory</span>();</span><br><span class=\"line\"><span class=\"type\">Scheduler</span> <span class=\"variable\">scheduler</span> <span class=\"operator\">=</span> schedulerFactory.getScheduler();</span><br><span class=\"line\"></span><br><span class=\"line\">-----用法一：输出调度器开始的时间</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//调度器绑定任务实例和触发器，方法返回调开始执行的时间</span></span><br><span class=\"line\"><span class=\"type\">Date</span> <span class=\"variable\">date</span> <span class=\"operator\">=</span> scheduler.scheduleJob(jobDetail, trigger);</span><br><span class=\"line\"></span><br><span class=\"line\">-----用法二：启动任务调度</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//开启任务调度</span></span><br><span class=\"line\">scheduler.start();</span><br><span class=\"line\">-----用法三：任务调度挂起【暂停操作】</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//任务调度挂起</span></span><br><span class=\"line\">scheduler.standby();</span><br><span class=\"line\"></span><br><span class=\"line\">-----用法四：任务调度关闭</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//关闭任务调度</span></span><br><span class=\"line\">scheduler.shutdown(); <span class=\"comment\">//默认为false</span></span><br><span class=\"line\"><span class=\"comment\">//scheduler.shutdown(true);  表示等待所有正在执行的Job执行完毕后，再关闭&gt;Scheduler</span></span><br><span class=\"line\"><span class=\"comment\">//scheduler.shutdown(false); 表示直接关闭Scheduler</span></span><br></pre></td></tr></table></figure></p>\n</li>\n<li>\n<p>DirectSchedulerFactory</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">DirectSchedulerFactory是对SchedulerFactory的直接实现，通过它可以直接构建scheduler，threadpool等</span><br><span class=\"line\"></span><br><span class=\"line\">DirectSchedulerFactory directSchedulerFactory = DirectSchedulerFactory.getInstance();</span><br><span class=\"line\">Scheduler scheduler = directSchedulerFactory.getScheduler();</span><br></pre></td></tr></table></figure></p>\n</li>\n</ul>\n<h3 id=\"15-quartz监听器\"><a class=\"anchor\" href=\"#15-quartz监听器\">#</a> 15、Quartz 监听器</h3>\n<h5 id=\"1-概念\"><a class=\"anchor\" href=\"#1-概念\">#</a> 1、概念</h5>\n<p>Quartz 的监听器用于当任务调度中你所关注事件发生时，能够及时获取这一事件的通知。类似于任务执行过程中的邮件，短信的提醒。<br />\nQuartz 监听器主要有 JobListener、TriggerListener、SchedulerListener 三种，顾名思义，分别表示任务，触发器，调度器对应的监听器。三者的使用方法类似，在开始介绍三种监听器之前，需要明确两个概念：全局监听器与非全局监听器。<br />\n两者的区别在于：<br />\n全局监听器只能够接收到所有的 Job、Trigger 的事件通知。<br />\n而非全局监听器只能接收到在其上注册的 Job 或 Trigger 的事件，不在其上注册的 Job 或 Trigger 则不会进行监听。</p>\n<h5 id=\"2-joblistener监听器的使用\"><a class=\"anchor\" href=\"#2-joblistener监听器的使用\">#</a> 2、JobListener 监听器的使用</h5>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">obListener是一个接口，它内部有四个方法。详细解析如下所示；</span><br><span class=\"line\">JobListener用于监听任务，通常需要被监听的任务类实现该接口</span><br></pre></td></tr></table></figure></p>\n<h6 id=\"1-joblistener源码\"><a class=\"anchor\" href=\"#1-joblistener源码\">#</a> 1、JobListener 源码</h6>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">public interface JobListener &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    /**</span><br><span class=\"line\">     * 用于获取该JobListener的名称</span><br><span class=\"line\">     */</span><br><span class=\"line\">    String getName();</span><br><span class=\"line\"></span><br><span class=\"line\">    /**</span><br><span class=\"line\">     * scheduler在JobDetail将要被执行时调用这个方法【JobDetail执行前】</span><br><span class=\"line\">     * @see #jobExecutionVetoed(JobExecutionContext)</span><br><span class=\"line\">     */</span><br><span class=\"line\">    void jobToBeExecuted(JobExecutionContext context);</span><br><span class=\"line\"></span><br><span class=\"line\">    /**</span><br><span class=\"line\">     * scheduler在JobDetail即将被执行，但又被TriggerListener否决时会调用该方法</span><br><span class=\"line\">     * @see #jobToBeExecuted(JobExecutionContext)</span><br><span class=\"line\">     */</span><br><span class=\"line\">    void jobExecutionVetoed(JobExecutionContext context);</span><br><span class=\"line\"></span><br><span class=\"line\">    </span><br><span class=\"line\">    /**</span><br><span class=\"line\">     * scheduler在JobDetail被执行后调用这个方法</span><br><span class=\"line\">     */</span><br><span class=\"line\">    void jobWasExecuted(JobExecutionContext context,JobExecutionException jobException);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<h6 id=\"1-使用案例\"><a class=\"anchor\" href=\"#1-使用案例\">#</a> 1、使用案例</h6>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">创建任务类：HelloJobToListener</span><br><span class=\"line\">创建任务调度类：HelloSchedulerDemoListener</span><br><span class=\"line\">创建job监听类：MyJobListener</span><br><span class=\"line\">任务类实现Job接口，并重写execute方法；</span><br><span class=\"line\">任务调度类创建任务执行实例和触发器与调度器进行绑定。并设置对job的监听【全局监听，局部监听】</span><br><span class=\"line\">job监听类实现JobListener接口，重写对应的方法。</span><br></pre></td></tr></table></figure></p>\n<p><strong>HelloJobToListener.java</strong></p>\n<p><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@Desc</span> 任务类</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">HelloJobToListener</span> <span class=\"keyword\">implements</span> <span class=\"title class_\">Job</span> &#123;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">execute</span><span class=\"params\">(JobExecutionContext context)</span> &#123;</span><br><span class=\"line\">        log.info(<span class=\"keyword\">new</span> <span class=\"title class_\">SimpleDateFormat</span>(<span class=\"string\">&quot;yyyy-MM-dd hh:mm:ss&quot;</span>).format(<span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>()) + <span class=\"string\">&quot; | 任务被执行了&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p><strong>MyJobListener.java</strong></p>\n<p><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@Desc</span> JobListener</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">MyJobListener</span> <span class=\"keyword\">implements</span> <span class=\"title class_\">JobListener</span> &#123;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> String <span class=\"title function_\">getName</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">name</span> <span class=\"operator\">=</span> <span class=\"built_in\">this</span>.getClass().getSimpleName();</span><br><span class=\"line\">        log.info(<span class=\"string\">&quot;当前JobListener的名称为：&quot;</span> + name);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> name;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">jobToBeExecuted</span><span class=\"params\">(JobExecutionContext context)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">name</span> <span class=\"operator\">=</span> context.getJobDetail().getJobClass().getName();</span><br><span class=\"line\">        log.info(<span class=\"string\">&quot;当前Job的名称为：&quot;</span> + name + <span class=\"string\">&quot;，JobDetail将要被执行了...&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">jobExecutionVetoed</span><span class=\"params\">(JobExecutionContext context)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">name</span> <span class=\"operator\">=</span> context.getJobDetail().getJobClass().getName();</span><br><span class=\"line\">        log.info(<span class=\"string\">&quot;当前Job的名称为：&quot;</span> + name + <span class=\"string\">&quot;，JobDetail将要被执，但被TriggerListener否决...&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">jobWasExecuted</span><span class=\"params\">(JobExecutionContext context, JobExecutionException jobException)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">name</span> <span class=\"operator\">=</span> context.getJobDetail().getJobClass().getName();</span><br><span class=\"line\">        log.info(<span class=\"string\">&quot;当前Job的名称为：&quot;</span> + name + <span class=\"string\">&quot;，JobDetail执行完成了...&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p><strong>HelloSchedulerDemoListener.java</strong></p>\n<p><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@Desc</span> 调度器</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">HelloSchedulerDemoListener</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> SchedulerException &#123;</span><br><span class=\"line\">        <span class=\"comment\">//通过调度器工厂构建调度器实例</span></span><br><span class=\"line\">        <span class=\"type\">Scheduler</span> <span class=\"variable\">scheduler</span> <span class=\"operator\">=</span> StdSchedulerFactory.getDefaultScheduler();</span><br><span class=\"line\">        <span class=\"comment\">//通过JobBuilder构建JobDetail</span></span><br><span class=\"line\">        <span class=\"type\">JobDetail</span> <span class=\"variable\">jobDetail</span> <span class=\"operator\">=</span> JobBuilder.newJob(HelloJobToListener.class)</span><br><span class=\"line\">                .withIdentity(<span class=\"string\">&quot;job1&quot;</span>, <span class=\"string\">&quot;group1&quot;</span>)</span><br><span class=\"line\">                .build();</span><br><span class=\"line\">        <span class=\"comment\">//通过TriggerBuilder构建Trigger</span></span><br><span class=\"line\">        <span class=\"type\">CronTrigger</span> <span class=\"variable\">trigger</span> <span class=\"operator\">=</span> TriggerBuilder.newTrigger()</span><br><span class=\"line\">                .withIdentity(<span class=\"string\">&quot;trigger1&quot;</span>, <span class=\"string\">&quot;group1&quot;</span>)</span><br><span class=\"line\">                .startNow()</span><br><span class=\"line\">                .withSchedule(CronScheduleBuilder.cronSchedule(<span class=\"string\">&quot;3 * * * * ?&quot;</span>))</span><br><span class=\"line\">                .build();</span><br><span class=\"line\">        <span class=\"comment\">//调度器绑定JobDetail和Trigger</span></span><br><span class=\"line\">        scheduler.scheduleJob(jobDetail, trigger);</span><br><span class=\"line\">        <span class=\"comment\">//绑定job监听</span></span><br><span class=\"line\">        <span class=\"comment\">//1.全局绑定，所有的job在被调度的时候都会被监听</span></span><br><span class=\"line\">        <span class=\"comment\">//scheduler.getListenerManager().addJobListener(new MyJobListener(), EverythingMatcher.allJobs());</span></span><br><span class=\"line\">        <span class=\"comment\">//2.局部监听，用来监听指定的job</span></span><br><span class=\"line\">        scheduler.getListenerManager().addJobListener(<span class=\"keyword\">new</span> <span class=\"title class_\">MyJobListener</span>(), KeyMatcher</span><br><span class=\"line\">                <span class=\"comment\">//jobKey中的name参数和group参数对应的就是任务实例【JobDetail】的name和group</span></span><br><span class=\"line\">                .keyEquals(JobKey.jobKey(<span class=\"string\">&quot;job1&quot;</span>,<span class=\"string\">&quot;group1&quot;</span>)));</span><br><span class=\"line\">        <span class=\"comment\">//开启调度</span></span><br><span class=\"line\">        scheduler.start();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<h5 id=\"执行结果\"><a class=\"anchor\" href=\"#执行结果\">#</a> 执行结果：<img data-src=\"D:%5CPictures%5Ctypore%5C006V2BDqly8hqtbfcr51tj313p093gpi.jpg\" alt=\"\" /></h5>\n<h5 id=\"3-triggerlistener监听器的使用\"><a class=\"anchor\" href=\"#3-triggerlistener监听器的使用\">#</a> 3、TriggerListener 监听器的使用</h5>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">任务调度过程中，与触发器Trigger相关的事件包括：触发器触发，触发器未正常触发，触发器触发完成</span><br></pre></td></tr></table></figure></p>\n<h6 id=\"1-triggerlistener源码\"><a class=\"anchor\" href=\"#1-triggerlistener源码\">#</a> 1、TriggerListener 源码</h6>\n<p><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">interface</span> <span class=\"title class_\">TriggerListener</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 用于触发器的名称</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    String <span class=\"title function_\">getName</span><span class=\"params\">()</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 当与监听器相关联的Trigger被触发，Job上的execute()方法将被执行时，Scheduler就调用该方法【job执行前】</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">void</span> <span class=\"title function_\">triggerFired</span><span class=\"params\">(Trigger trigger, JobExecutionContext context)</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 在Trigger触发后，Job将要被执行由Scheduler调用这个方法。Trigger Listener给了一个选择去否决Job的执行。假如这个方法返回true，这个Job将不会为此次Trigger而得到触发【job执行前】</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"type\">boolean</span> <span class=\"title function_\">vetoJobExecution</span><span class=\"params\">(Trigger trigger, JobExecutionContext context)</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * scheduler调用这个方法是在Trigger错过触发时，你应该关注此方法中持续时间长的逻辑；在出现许多错过触发的Trigger时，长逻辑会导致骨牌效应，你应当保持这个方法尽量的少使用</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">void</span> <span class=\"title function_\">triggerMisfired</span><span class=\"params\">(Trigger trigger)</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * Trigger被触发并完成了Job的执行，scheduler调用这个方法</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">void</span> <span class=\"title function_\">triggerComplete</span><span class=\"params\">(Trigger trigger, JobExecutionContext context,</span></span><br><span class=\"line\"><span class=\"params\">            CompletedExecutionInstruction triggerInstructionCode)</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<h6 id=\"2-使用案例\"><a class=\"anchor\" href=\"#2-使用案例\">#</a> 2、使用案例</h6>\n<p><strong>HelloJobToTrigger.java</strong></p>\n<p><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@Desc</span> 任务类</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">HelloJobToTrigger</span> <span class=\"keyword\">implements</span> <span class=\"title class_\">Job</span> &#123;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">execute</span><span class=\"params\">(JobExecutionContext jobExecutionContext)</span> <span class=\"keyword\">throws</span> JobExecutionException &#123;</span><br><span class=\"line\">        log.info(<span class=\"keyword\">new</span> <span class=\"title class_\">SimpleDateFormat</span>(<span class=\"string\">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>).format(<span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>()) + <span class=\"string\">&quot; | 任务被执行...&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p><strong>HelloJobToTrigger.java</strong></p>\n<p><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@Desc</span> TriggerListener</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">MyTriggerListener</span> <span class=\"keyword\">implements</span> <span class=\"title class_\">TriggerListener</span> &#123;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> String <span class=\"title function_\">getName</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">simpleName</span> <span class=\"operator\">=</span> <span class=\"built_in\">this</span>.getClass().getSimpleName();</span><br><span class=\"line\">        <span class=\"keyword\">return</span> simpleName;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">triggerFired</span><span class=\"params\">(Trigger trigger, JobExecutionContext jobExecutionContext)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">name</span> <span class=\"operator\">=</span> trigger.getKey().getName();</span><br><span class=\"line\">        log.info(name + <span class=\"string\">&quot; | Job上的execute()方法将被执行时，Scheduler就调用该方法&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">boolean</span> <span class=\"title function_\">vetoJobExecution</span><span class=\"params\">(Trigger trigger, JobExecutionContext jobExecutionContext)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">boolean</span> <span class=\"variable\">temp</span> <span class=\"operator\">=</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">name</span> <span class=\"operator\">=</span> trigger.getKey().getName();</span><br><span class=\"line\">        log.info(name + <span class=\"string\">&quot; | Job将要被执行由Scheduler调用这个方法。Trigger Listener给了一个选择去否决Job的执行为&quot;</span> + (temp ? <span class=\"string\">&quot;为此次Trigger触发&quot;</span> : <span class=\"string\">&quot;不为此次Trigger触发&quot;</span>));</span><br><span class=\"line\">        <span class=\"keyword\">return</span> temp;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">triggerMisfired</span><span class=\"params\">(Trigger trigger)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">name</span> <span class=\"operator\">=</span> trigger.getKey().getName();</span><br><span class=\"line\">        log.info(name + <span class=\"string\">&quot; ｜ scheduler调用这个方法是在Trigger错过触发时调用该方法&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">triggerComplete</span><span class=\"params\">(Trigger trigger, JobExecutionContext jobExecutionContext, Trigger.CompletedExecutionInstruction completedExecutionInstruction)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">name</span> <span class=\"operator\">=</span> trigger.getKey().getName();</span><br><span class=\"line\">        log.info(name + <span class=\"string\">&quot; | Trigger被触发并完成了Job的执行，scheduler调用这个方法&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p><strong>HelloSchedulerDemoTrigger.java</strong></p>\n<p><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@Desc</span> 调度器</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">HelloSchedulerDemoTrigger</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> SchedulerException &#123;</span><br><span class=\"line\">        <span class=\"type\">Scheduler</span> <span class=\"variable\">scheduler</span> <span class=\"operator\">=</span> StdSchedulerFactory.getDefaultScheduler();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"type\">JobDetail</span> <span class=\"variable\">jobDetail</span> <span class=\"operator\">=</span> JobBuilder.newJob(HelloJobToTrigger.class)</span><br><span class=\"line\">                .withIdentity(<span class=\"string\">&quot;job1&quot;</span>, <span class=\"string\">&quot;group1&quot;</span>)</span><br><span class=\"line\">                .build();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"type\">CronTrigger</span> <span class=\"variable\">trigger</span> <span class=\"operator\">=</span> TriggerBuilder.newTrigger()</span><br><span class=\"line\">                .withIdentity(<span class=\"string\">&quot;trigger1&quot;</span>, <span class=\"string\">&quot;group1&quot;</span>)</span><br><span class=\"line\">                .startNow()</span><br><span class=\"line\">                .withSchedule(CronScheduleBuilder.cronSchedule(<span class=\"string\">&quot;3 * * * * ?&quot;</span>))</span><br><span class=\"line\">                .build();</span><br><span class=\"line\"></span><br><span class=\"line\">        scheduler.scheduleJob(jobDetail, trigger);</span><br><span class=\"line\">        <span class=\"comment\">//全局监听</span></span><br><span class=\"line\">        scheduler.getListenerManager().addTriggerListener(<span class=\"keyword\">new</span> <span class=\"title class_\">MyTriggerListener</span>(), EverythingMatcher.allTriggers());</span><br><span class=\"line\">        <span class=\"comment\">//局部监听</span></span><br><span class=\"line\">        <span class=\"comment\">//scheduler.getListenerManager().addTriggerListener(new MyTriggerListener(), KeyMatcher.keyEquals(TriggerKey.triggerKey(&quot;trigger1&quot;, &quot;group1&quot;)));</span></span><br><span class=\"line\">        scheduler.start();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p><strong>执行结果</strong>：</p>\n<p><img data-src=\"D:%5CPictures%5Ctypore%5C006V2BDqly8hqtbj5ts1oj323k0rsqgq.jpg\" alt=\"\" /></p>\n<h5 id=\"4scheduler-listener监听器的使用\"><a class=\"anchor\" href=\"#4scheduler-listener监听器的使用\">#</a> 4.Scheduler Listener 监听器的使用</h5>\n<h6 id=\"1-scheduler-listener源码\"><a class=\"anchor\" href=\"#1-scheduler-listener源码\">#</a> 1、Scheduler Listener 源码</h6>\n<p><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">interface</span> <span class=\"title class_\">SchedulerListener</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 用于部署Job Detail时调用</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">void</span> <span class=\"title function_\">jobScheduled</span><span class=\"params\">(Trigger trigger)</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 用于卸载JobDetail时调用</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">void</span> <span class=\"title function_\">jobUnscheduled</span><span class=\"params\">(TriggerKey triggerKey)</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 当一个Trigger来到了再也不会触发的状态时调用这个方法。除非这个Job已设置成了持久性，否则它就会中scheduler中移除</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">void</span> <span class=\"title function_\">triggerFinalized</span><span class=\"params\">(Trigger trigger)</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * scheduler调用这个方法时发生在一个Trigger被暂停时调用。</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">void</span> <span class=\"title function_\">triggerPaused</span><span class=\"params\">(TriggerKey triggerKey)</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * scheduler调用这个方法时发生在一个Trigger组被暂停时调用。</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">void</span> <span class=\"title function_\">triggersPaused</span><span class=\"params\">(String triggerGroup)</span>;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * scheduler调用这个方法发生在为一个Trigger从暂停中恢复时</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">void</span> <span class=\"title function_\">triggerResumed</span><span class=\"params\">(TriggerKey triggerKey)</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * scheduler调用这个方法发生在为一个Trigger组从暂停中恢复时</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">void</span> <span class=\"title function_\">triggersResumed</span><span class=\"params\">(String triggerGroup)</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 添加任务时被调用</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">void</span> <span class=\"title function_\">jobAdded</span><span class=\"params\">(JobDetail jobDetail)</span>;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 删除任务时被调用</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">void</span> <span class=\"title function_\">jobDeleted</span><span class=\"params\">(JobKey jobKey)</span>;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 暂停任务时被调</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">void</span> <span class=\"title function_\">jobPaused</span><span class=\"params\">(JobKey jobKey)</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 暂停任务组时被调用</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">void</span> <span class=\"title function_\">jobsPaused</span><span class=\"params\">(String jobGroup)</span>;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 恢复任务时被调用</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">void</span> <span class=\"title function_\">jobResumed</span><span class=\"params\">(JobKey jobKey)</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 恢复任务组时被调用</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">void</span> <span class=\"title function_\">jobsResumed</span><span class=\"params\">(String jobGroup)</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 在scheduler的政策运行期间发生严重错误时被调用</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">void</span> <span class=\"title function_\">schedulerError</span><span class=\"params\">(String msg, SchedulerException cause)</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 在scheduler处于挂载状态时被调用</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">void</span> <span class=\"title function_\">schedulerInStandbyMode</span><span class=\"params\">()</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 在scheduler开启时被调用</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">void</span> <span class=\"title function_\">schedulerStarted</span><span class=\"params\">()</span>;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 当调度程序启动时调用该方法</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">void</span> <span class=\"title function_\">schedulerStarting</span><span class=\"params\">()</span>;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 当scheduler关闭时调用该方法</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">void</span> <span class=\"title function_\">schedulerShutdown</span><span class=\"params\">()</span>;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 当调度程序关闭时调用</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">void</span> <span class=\"title function_\">schedulerShuttingdown</span><span class=\"params\">()</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 当scheduler中的数据被清除时，调用该方法</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">void</span> <span class=\"title function_\">schedulingDataCleared</span><span class=\"params\">()</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<h6 id=\"2-使用案例-2\"><a class=\"anchor\" href=\"#2-使用案例-2\">#</a> 2、使用案例：</h6>\n<p><strong>HelloJobToScheduler.java</strong></p>\n<p><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@Desc</span> 任务类</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">HelloJobToScheduler</span> <span class=\"keyword\">implements</span> <span class=\"title class_\">Job</span> &#123;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">execute</span><span class=\"params\">(JobExecutionContext jobExecutionContext)</span> <span class=\"keyword\">throws</span> JobExecutionException &#123;</span><br><span class=\"line\">        log.info(<span class=\"keyword\">new</span> <span class=\"title class_\">SimpleDateFormat</span>(<span class=\"string\">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>).format(<span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>()) + <span class=\"string\">&quot; | 任务被执行...&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p><strong>MySchedulerListener.java</strong></p>\n<p><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@Desc</span> TriggerListener</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">MySchedulerListener</span> <span class=\"keyword\">implements</span> <span class=\"title class_\">SchedulerListener</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">jobScheduled</span><span class=\"params\">(Trigger trigger)</span> &#123;</span><br><span class=\"line\">        log.info(trigger.getKey().getName() + <span class=\"string\">&quot; | 用于部署Job Detail时调用&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">jobUnscheduled</span><span class=\"params\">(TriggerKey triggerKey)</span> &#123;</span><br><span class=\"line\">        log.info(triggerKey.getName() + <span class=\"string\">&quot; | 用于卸载JobDetail时调用&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">triggerFinalized</span><span class=\"params\">(Trigger trigger)</span> &#123;</span><br><span class=\"line\">        log.info(trigger.getKey().getName() + <span class=\"string\">&quot; | 当一个Trigger来到了再也不会触发的状态时调用这个方法。除非这个Job已设置成了持久性，否则它就会中scheduler中移除&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">triggerPaused</span><span class=\"params\">(TriggerKey triggerKey)</span> &#123;</span><br><span class=\"line\">        log.info(triggerKey.getName() + <span class=\"string\">&quot; | scheduler调用这个方法时发生在一个Trigger被暂停时调用。&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">triggersPaused</span><span class=\"params\">(String triggerGroup)</span> &#123;</span><br><span class=\"line\">        log.info(triggerGroup + <span class=\"string\">&quot; | scheduler调用这个方法时发生在一个Trigger组被暂停时调用。&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">triggerResumed</span><span class=\"params\">(TriggerKey triggerKey)</span> &#123;</span><br><span class=\"line\">        log.info(triggerKey.getName() + <span class=\"string\">&quot; | scheduler调用这个方法发生在为一个Trigger从暂停中恢复时&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">triggersResumed</span><span class=\"params\">(String triggerGroup)</span> &#123;</span><br><span class=\"line\">        log.info(triggerGroup + <span class=\"string\">&quot; | scheduler调用这个方法发生在为一个Trigger组从暂停中恢复时&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">jobAdded</span><span class=\"params\">(JobDetail jobDetail)</span> &#123;</span><br><span class=\"line\">        log.info(<span class=\"string\">&quot;添加任务时被调用&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">jobDeleted</span><span class=\"params\">(JobKey jobKey)</span> &#123;</span><br><span class=\"line\">        log.info(<span class=\"string\">&quot;删除任务时被调用&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">jobPaused</span><span class=\"params\">(JobKey jobKey)</span> &#123;</span><br><span class=\"line\">        log.info(<span class=\"string\">&quot;暂停任务时被调&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">jobsPaused</span><span class=\"params\">(String jobGroup)</span> &#123;</span><br><span class=\"line\">        log.info(<span class=\"string\">&quot;暂停任务组时被调用&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">jobResumed</span><span class=\"params\">(JobKey jobKey)</span> &#123;</span><br><span class=\"line\">        log.info(<span class=\"string\">&quot;恢复任务时被调用&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">jobsResumed</span><span class=\"params\">(String jobGroup)</span> &#123;</span><br><span class=\"line\">        log.info(<span class=\"string\">&quot;恢复任务组时被调用&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">schedulerError</span><span class=\"params\">(String msg, SchedulerException cause)</span> &#123;</span><br><span class=\"line\">        log.info(<span class=\"string\">&quot;在scheduler的政策运行期间发生严重错误时被调用&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">schedulerInStandbyMode</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        log.info(<span class=\"string\">&quot;在scheduler处于挂载状态时被调用&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">schedulerStarted</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        log.info(<span class=\"string\">&quot;在scheduler开启时被调用&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">schedulerStarting</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        log.info(<span class=\"string\">&quot;当调度程序启动时调用该方法&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">schedulerShutdown</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        log.info(<span class=\"string\">&quot;当scheduler关闭时调用该方法&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">schedulerShuttingdown</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        log.info(<span class=\"string\">&quot;当调度程序关闭时调用&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">schedulingDataCleared</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        log.info(<span class=\"string\">&quot;当scheduler中的数据被清除时，调用该方法&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure></p>\n<p><strong>HelloSchedulerDemoScheduler.java</strong></p>\n<p><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@Desc</span> 调度器</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">HelloSchedulerDemoScheduler</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> Exception &#123;</span><br><span class=\"line\">        <span class=\"type\">Scheduler</span> <span class=\"variable\">scheduler</span> <span class=\"operator\">=</span> StdSchedulerFactory.getDefaultScheduler();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"type\">JobDetail</span> <span class=\"variable\">jobDetail</span> <span class=\"operator\">=</span> JobBuilder.newJob(HelloJobToScheduler.class)</span><br><span class=\"line\">                .withIdentity(<span class=\"string\">&quot;job1&quot;</span>, <span class=\"string\">&quot;group1&quot;</span>)</span><br><span class=\"line\">                .build();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"type\">CronTrigger</span> <span class=\"variable\">trigger</span> <span class=\"operator\">=</span> TriggerBuilder.newTrigger()</span><br><span class=\"line\">                .withIdentity(<span class=\"string\">&quot;trigger1&quot;</span>, <span class=\"string\">&quot;group1&quot;</span>)</span><br><span class=\"line\">                .startNow()</span><br><span class=\"line\">                .withSchedule(CronScheduleBuilder.cronSchedule(<span class=\"string\">&quot;* * * * * ?&quot;</span>))</span><br><span class=\"line\">                .build();</span><br><span class=\"line\"></span><br><span class=\"line\">        scheduler.scheduleJob(jobDetail, trigger);</span><br><span class=\"line\">        scheduler.getListenerManager().addSchedulerListener(<span class=\"keyword\">new</span> <span class=\"title class_\">MySchedulerListener</span>());</span><br><span class=\"line\">        scheduler.start();</span><br><span class=\"line\">        Thread.sleep(<span class=\"number\">10000L</span>);</span><br><span class=\"line\">        scheduler.shutdown();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure></p>\n<p><strong>执行结果</strong>：</p>\n<p><img data-src=\"D:%5CPictures%5Ctypore%5C006V2BDqly8hqtblb4b7rj31z00ew0xz.jpg\" alt=\"\" /></p>\n<h3 id=\"springboot整合任务调度框架quartz\"><a class=\"anchor\" href=\"#springboot整合任务调度框架quartz\">#</a> ※、SpringBoot 整合任务调度框架（Quartz）</h3>\n<h4 id=\"1-springboot与quartz快速整合\"><a class=\"anchor\" href=\"#1-springboot与quartz快速整合\">#</a> 1、SpringBoot 与 Quartz 快速整合</h4>\n<h5 id=\"引入依赖\"><a class=\"anchor\" href=\"#引入依赖\">#</a> 引入依赖</h5>\n<p>主要是 <code>spring-boot-starter-quartz</code>  这个依赖，是 SpringBoot 与 Quartz 的整合。</p>\n<p><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!-- 实现对 Spring MVC 的自动化配置 --&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-web<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">&lt;!-- 实现对 Quartz 的自动化配置 --&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-quartz<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></p>\n<h5 id=\"创建job\"><a class=\"anchor\" href=\"#创建job\">#</a> 创建 Job</h5>\n<p>为了演示两种 Trigger 及两种配置方式，我们创建两个不同的 Job。</p>\n<p><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">FirstJob</span> <span class=\"keyword\">extends</span> <span class=\"title class_\">QuartzJobBean</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title function_\">executeInternal</span><span class=\"params\">(JobExecutionContext jobExecutionContext)</span> <span class=\"keyword\">throws</span> JobExecutionException &#123;</span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">now</span> <span class=\"operator\">=</span> DateTimeFormatter.ofPattern(<span class=\"string\">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>).format(LocalDateTime.now());</span><br><span class=\"line\">        log.info(<span class=\"string\">&quot;当前的时间: &quot;</span> + now);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">SecondJob</span> <span class=\"keyword\">extends</span> <span class=\"title class_\">QuartzJobBean</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title function_\">executeInternal</span><span class=\"params\">(JobExecutionContext jobExecutionContext)</span> <span class=\"keyword\">throws</span> JobExecutionException &#123;</span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">now</span> <span class=\"operator\">=</span> DateTimeFormatter.ofPattern(<span class=\"string\">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>).format(LocalDateTime.now());</span><br><span class=\"line\">        log.info(<span class=\"string\">&quot;SecondJob执行, 当前的时间: &quot;</span> + now);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure></p>\n<p>我们在创建 Job 的时候，可以实现 Job 接口，也可以继承 QuartzJobBean。</p>\n<p>QuartzJobBean 实现了 Job，并且定义了公用的 execute 方法，子类可以继承 QuartzJobBean 并实现 executeInternal 方法。</p>\n<p><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">abstract</span> <span class=\"keyword\">class</span> <span class=\"title class_\">QuartzJobBean</span> <span class=\"keyword\">implements</span> <span class=\"title class_\">Job</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">\t * This implementation applies the passed-in job data map as bean property</span></span><br><span class=\"line\"><span class=\"comment\">\t * values, and delegates to &#123;<span class=\"doctag\">@code</span> executeInternal&#125; afterwards.</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@see</span> #executeInternal</span></span><br><span class=\"line\"><span class=\"comment\">\t */</span></span><br><span class=\"line\">\t<span class=\"meta\">@Override</span></span><br><span class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"keyword\">final</span> <span class=\"keyword\">void</span> <span class=\"title function_\">execute</span><span class=\"params\">(JobExecutionContext context)</span> <span class=\"keyword\">throws</span> JobExecutionException &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">             <span class=\"comment\">// 将当前对象包装为BeanWrapper</span></span><br><span class=\"line\">\t\t\t<span class=\"type\">BeanWrapper</span> <span class=\"variable\">bw</span> <span class=\"operator\">=</span> PropertyAccessorFactory.forBeanPropertyAccess(<span class=\"built_in\">this</span>);</span><br><span class=\"line\">            <span class=\"comment\">// 设置属性</span></span><br><span class=\"line\">\t\t\t<span class=\"type\">MutablePropertyValues</span> <span class=\"variable\">pvs</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">MutablePropertyValues</span>();</span><br><span class=\"line\">\t\t\tpvs.addPropertyValues(context.getScheduler().getContext());</span><br><span class=\"line\">\t\t\tpvs.addPropertyValues(context.getMergedJobDataMap());</span><br><span class=\"line\">\t\t\tbw.setPropertyValues(pvs, <span class=\"literal\">true</span>);</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"keyword\">catch</span> (SchedulerException ex) &#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">JobExecutionException</span>(ex);</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">        <span class=\"comment\">// 子类实现该方法</span></span><br><span class=\"line\">\t\texecuteInternal(context);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">\t * Execute the actual job. The job data map will already have been</span></span><br><span class=\"line\"><span class=\"comment\">\t * applied as bean property values by execute. The contract is</span></span><br><span class=\"line\"><span class=\"comment\">\t * exactly the same as for the standard Quartz execute method.</span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@see</span> #execute</span></span><br><span class=\"line\"><span class=\"comment\">\t */</span></span><br><span class=\"line\">\t<span class=\"keyword\">protected</span> <span class=\"keyword\">abstract</span> <span class=\"keyword\">void</span> <span class=\"title function_\">executeInternal</span><span class=\"params\">(JobExecutionContext context)</span> <span class=\"keyword\">throws</span> JobExecutionException;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure></p>\n<h5 id=\"调度器scheduler绑定\"><a class=\"anchor\" href=\"#调度器scheduler绑定\">#</a> 调度器 Scheduler 绑定</h5>\n<p>Scheduler 绑定有两种方式，一种是使用 bena 的自动配置，一种是 Scheduler 手动配置。</p>\n<p>自动配置，这里演示 SimpleScheduleBuilder</p>\n<p><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Configuration</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">QuartzConfig</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">String</span> <span class=\"variable\">ID</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;SUMMERDAY&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Bean</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> JobDetail <span class=\"title function_\">jobDetail1</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> JobBuilder.newJob(FirstJob.class)</span><br><span class=\"line\">                .withIdentity(ID + <span class=\"string\">&quot; 01&quot;</span>)</span><br><span class=\"line\">                .storeDurably()</span><br><span class=\"line\">                .build();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Bean</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> Trigger <span class=\"title function_\">trigger1</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 简单的调度计划的构造器</span></span><br><span class=\"line\">        <span class=\"type\">SimpleScheduleBuilder</span> <span class=\"variable\">scheduleBuilder</span> <span class=\"operator\">=</span> SimpleScheduleBuilder.simpleSchedule()</span><br><span class=\"line\">                .withIntervalInSeconds(<span class=\"number\">5</span>) <span class=\"comment\">// 频率</span></span><br><span class=\"line\">                .repeatForever(); <span class=\"comment\">// 次数</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">return</span> TriggerBuilder.newTrigger()</span><br><span class=\"line\">                .forJob(jobDetail1())</span><br><span class=\"line\">                .withIdentity(ID + <span class=\"string\">&quot; 01Trigger&quot;</span>)</span><br><span class=\"line\">                .withSchedule(scheduleBuilder)</span><br><span class=\"line\">                .build();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure></p>\n<p>手动配置，这里演示 CronScheduleBuilder</p>\n<p><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Component</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">JobInit</span> <span class=\"keyword\">implements</span> <span class=\"title class_\">ApplicationRunner</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">String</span> <span class=\"variable\">ID</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;SUMMERDAY&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Autowired</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Scheduler scheduler;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">run</span><span class=\"params\">(ApplicationArguments args)</span> <span class=\"keyword\">throws</span> Exception &#123;</span><br><span class=\"line\">        <span class=\"type\">JobDetail</span> <span class=\"variable\">jobDetail</span> <span class=\"operator\">=</span> JobBuilder.newJob(FirstJob.class)</span><br><span class=\"line\">                .withIdentity(ID + <span class=\"string\">&quot; 01&quot;</span>)</span><br><span class=\"line\">                .storeDurably()</span><br><span class=\"line\">                .build();</span><br><span class=\"line\">        <span class=\"type\">CronScheduleBuilder</span> <span class=\"variable\">scheduleBuilder</span> <span class=\"operator\">=</span></span><br><span class=\"line\">                CronScheduleBuilder.cronSchedule(<span class=\"string\">&quot;0/5 * * * * ? *&quot;</span>);</span><br><span class=\"line\">        <span class=\"comment\">// 创建任务触发器</span></span><br><span class=\"line\">        <span class=\"type\">Trigger</span> <span class=\"variable\">trigger</span> <span class=\"operator\">=</span> TriggerBuilder.newTrigger()</span><br><span class=\"line\">                .forJob(jobDetail)</span><br><span class=\"line\">                .withIdentity(ID + <span class=\"string\">&quot; 01Trigger&quot;</span>)</span><br><span class=\"line\">                .withSchedule(scheduleBuilder)</span><br><span class=\"line\">                .startNow() <span class=\"comment\">//立即執行一次任務</span></span><br><span class=\"line\">                .build();</span><br><span class=\"line\">        <span class=\"comment\">// 手动将触发器与任务绑定到调度器内</span></span><br><span class=\"line\">        scheduler.scheduleJob(jobDetail, trigger);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure></p>\n<h5 id=\"yml配置\"><a class=\"anchor\" href=\"#yml配置\">#</a> yml 配置</h5>\n<p><figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">spring:</span></span><br><span class=\"line\">  <span class=\"comment\"># Quartz 的配置，对应 QuartzProperties 配置类</span></span><br><span class=\"line\">  <span class=\"attr\">quartz:</span></span><br><span class=\"line\">    <span class=\"attr\">job-store-type:</span> <span class=\"string\">memory</span> <span class=\"comment\"># Job 存储器类型。默认为 memory 表示内存，可选 jdbc 使用数据库。</span></span><br><span class=\"line\">    <span class=\"attr\">auto-startup:</span> <span class=\"literal\">true</span> <span class=\"comment\"># Quartz 是否自动启动</span></span><br><span class=\"line\">    <span class=\"attr\">startup-delay:</span> <span class=\"number\">0</span> <span class=\"comment\"># 延迟 N 秒启动</span></span><br><span class=\"line\">    <span class=\"attr\">wait-for-jobs-to-complete-on-shutdown:</span> <span class=\"literal\">true</span> <span class=\"comment\"># 应用关闭时，是否等待定时任务执行完成。默认为 false ，建议设置为 true</span></span><br><span class=\"line\">    <span class=\"attr\">overwrite-existing-jobs:</span> <span class=\"literal\">false</span> <span class=\"comment\"># 是否覆盖已有 Job 的配置</span></span><br><span class=\"line\">    <span class=\"attr\">properties:</span> <span class=\"comment\"># 添加 Quartz Scheduler 附加属性</span></span><br><span class=\"line\">      <span class=\"attr\">org:</span></span><br><span class=\"line\">        <span class=\"attr\">quartz:</span></span><br><span class=\"line\">          <span class=\"attr\">threadPool:</span></span><br><span class=\"line\">            <span class=\"attr\">threadCount:</span> <span class=\"number\">25</span> <span class=\"comment\"># 线程池大小。默认为 10 。</span></span><br><span class=\"line\">            <span class=\"attr\">threadPriority:</span> <span class=\"number\">5</span> <span class=\"comment\"># 线程优先级</span></span><br><span class=\"line\">            <span class=\"attr\">class:</span> <span class=\"string\">org.quartz.simpl.SimpleThreadPool</span> <span class=\"comment\"># 线程池类型</span></span><br><span class=\"line\"><span class=\"comment\">#    jdbc: # 这里暂时不说明，使用 JDBC 的 JobStore 的时候，才需要配置</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure></p>\n<h5 id=\"测试\"><a class=\"anchor\" href=\"#测试\">#</a> 测试</h5>\n<p>启动程序，FirstJob 每 5s 执行一次，SecondJob 每 10s 执行一次。</p>\n<p><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[eduler_Worker-1] com.hyhwky.standalone.FirstJob           : FirstJob执行, 当前的时间: 2020-12-26 16:54:00</span><br><span class=\"line\">[eduler_Worker-2] com.hyhwky.standalone.SecondJob          : SecondJob执行, 当前的时间: 2020-12-26 16:54:00</span><br><span class=\"line\">[eduler_Worker-3] com.hyhwky.standalone.FirstJob           : FirstJob执行, 当前的时间: 2020-12-26 16:54:05</span><br><span class=\"line\">[eduler_Worker-4] com.hyhwky.standalone.SecondJob          : SecondJob执行, 当前的时间: 2020-12-26 16:54:10</span><br><span class=\"line\">[eduler_Worker-5] com.hyhwky.standalone.FirstJob           : FirstJob执行, 当前的时间: 2020-12-26 16:54:10</span><br><span class=\"line\">[eduler_Worker-6] com.hyhwky.standalone.FirstJob           : FirstJob执行, 当前的时间: 2020-12-26 16:54:15</span><br><span class=\"line\">[eduler_Worker-7] com.hyhwky.standalone.SecondJob          : SecondJob执行, 当前的时间: 2020-12-26 16:54:20</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure></p>\n<h4 id=\"2-quartz持久化配置数据库\"><a class=\"anchor\" href=\"#2-quartz持久化配置数据库\">#</a> 2、Quartz 持久化配置（数据库）</h4>\n<p>Quartz 持久化配置提供了两种存储器：</p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\"><strong>类型</strong></th>\n<th><strong>优点</strong></th>\n<th><strong>缺点</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">RAMJobStore</td>\n<td>不要外部数据库，配置容易，运行速度快</td>\n<td>因为调度程序信息是存储在被分配给 JVM 的内存里面，所以，当应用程序停止运行时，所有调度信息将被丢失。另外因为存储到 JVM 内存里面，所以可以存储多少个 Job 和 Trigger 将会受到限制</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">JDBC 作业存储</td>\n<td>支持集群，因为所有的任务信息都会保存到数据库中，可以控制事物，还有就是如果应用服务器关闭或者重启，任务信息都不会丢失，并且可以恢复因服务器关闭或者重启而导致执行失败的任务</td>\n<td>运行速度的快慢取决与连接数据库的快慢</td>\n</tr>\n</tbody>\n</table>\n<h5 id=\"创建数据库\"><a class=\"anchor\" href=\"#创建数据库\">#</a> 创建数据库</h5>\n<p>为了测试 Quartz 的持久化配置，我们事先在 mysql 中创建一个数据库 quartz，并执行脚本，脚本藏在 <code>org\\quartz-scheduler\\quartz\\2.3.2\\quartz-2.3.2.jar!\\org\\quartz\\impl\\jdbcjobstore\\tables_mysql_innodb.sql</code> ，jdbcjobstore 中有支持许多种数据库的脚本，可以按需执行。</p>\n<p><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql<span class=\"operator\">&gt;</span> use quartz;</span><br><span class=\"line\">Database changed</span><br><span class=\"line\">mysql<span class=\"operator\">&gt;</span> <span class=\"keyword\">show</span> tables;</span><br><span class=\"line\"><span class=\"operator\">+</span><span class=\"comment\">--------------------------+</span></span><br><span class=\"line\"><span class=\"operator\">|</span> Tables_in_quartz         <span class=\"operator\">|</span></span><br><span class=\"line\"><span class=\"operator\">+</span><span class=\"comment\">--------------------------+</span></span><br><span class=\"line\"><span class=\"operator\">|</span> qrtz_blob_triggers       <span class=\"operator\">|</span>## blog类型存储triggers</span><br><span class=\"line\"><span class=\"operator\">|</span> qrtz_calendars           <span class=\"operator\">|</span>## 以blog类型存储Calendar信息</span><br><span class=\"line\"><span class=\"operator\">|</span> qrtz_cron_triggers       <span class=\"operator\">|</span>## 存储cron <span class=\"keyword\">trigger</span>信息</span><br><span class=\"line\"><span class=\"operator\">|</span> qrtz_fired_triggers      <span class=\"operator\">|</span>## 存储已触发的<span class=\"keyword\">trigger</span>相关信息</span><br><span class=\"line\"><span class=\"operator\">|</span> qrtz_job_details         <span class=\"operator\">|</span>## 存储每一个已配置的job details</span><br><span class=\"line\"><span class=\"operator\">|</span> qrtz_locks               <span class=\"operator\">|</span>## 存储悲观锁的信息</span><br><span class=\"line\"><span class=\"operator\">|</span> qrtz_paused_trigger_grps <span class=\"operator\">|</span>## 存储已暂停的<span class=\"keyword\">trigger</span>组信息</span><br><span class=\"line\"><span class=\"operator\">|</span> qrtz_scheduler_state     <span class=\"operator\">|</span>## 存储Scheduler状态信息</span><br><span class=\"line\"><span class=\"operator\">|</span> qrtz_simple_triggers     <span class=\"operator\">|</span>## 存储simple <span class=\"keyword\">trigger</span>信息</span><br><span class=\"line\"><span class=\"operator\">|</span> qrtz_simprop_triggers    <span class=\"operator\">|</span>## 存储其他几种<span class=\"keyword\">trigger</span>信息</span><br><span class=\"line\"><span class=\"operator\">|</span> qrtz_triggers            <span class=\"operator\">|</span>## 存储已配置的<span class=\"keyword\">trigger</span>信息</span><br><span class=\"line\"><span class=\"operator\">+</span><span class=\"comment\">--------------------------+</span></span><br></pre></td></tr></table></figure></p>\n<p>所有的表中都含有一个 <code>SCHED_NAME</code>  字段，对应我们配置的 <code>scheduler-name</code> ，相同 Scheduler-name 的节点，形成一个 Quartz 集群。</p>\n<h5 id=\"引入mysql相关依赖\"><a class=\"anchor\" href=\"#引入mysql相关依赖\">#</a> 引入 mysql 相关依赖</h5>\n<p><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependencies</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!-- 实现对 Spring MVC 的自动化配置 --&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-web<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!-- 实现对 Quartz 的自动化配置 --&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-quartz<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>mysql<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>mysql-connector-java<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.projectlombok<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>lombok<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">optional</span>&gt;</span>true<span class=\"tag\">&lt;/<span class=\"name\">optional</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-test<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">scope</span>&gt;</span>test<span class=\"tag\">&lt;/<span class=\"name\">scope</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-jdbc<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependencies</span>&gt;</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure></p>\n<h5 id=\"配置yml\"><a class=\"anchor\" href=\"#配置yml\">#</a> 配置 yml</h5>\n<p><figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">spring:</span></span><br><span class=\"line\">  <span class=\"attr\">datasource:</span></span><br><span class=\"line\">    <span class=\"attr\">quartz:</span></span><br><span class=\"line\">      <span class=\"attr\">driver-class-name:</span> <span class=\"string\">com.mysql.cj.jdbc.Driver</span></span><br><span class=\"line\">      <span class=\"attr\">url:</span> <span class=\"string\">jdbc:mysql://localhost:3306/quartz?serverTimezone=GMT%2B8</span></span><br><span class=\"line\">      <span class=\"attr\">username:</span> <span class=\"string\">root</span></span><br><span class=\"line\">      <span class=\"attr\">password:</span> <span class=\"number\">123456</span></span><br><span class=\"line\">  <span class=\"attr\">quartz:</span></span><br><span class=\"line\">    <span class=\"attr\">job-store-type:</span> <span class=\"string\">jdbc</span> <span class=\"comment\"># 使用数据库存储</span></span><br><span class=\"line\">    <span class=\"attr\">scheduler-name:</span> <span class=\"string\">hyhScheduler</span> <span class=\"comment\"># 相同 Scheduler 名字的节点，形成一个 Quartz 集群</span></span><br><span class=\"line\">    <span class=\"attr\">wait-for-jobs-to-complete-on-shutdown:</span> <span class=\"literal\">true</span> <span class=\"comment\"># 应用关闭时，是否等待定时任务执行完成。默认为 false ，建议设置为 true</span></span><br><span class=\"line\">    <span class=\"attr\">jdbc:</span></span><br><span class=\"line\">      <span class=\"attr\">initialize-schema:</span> <span class=\"string\">never</span> <span class=\"comment\"># 是否自动使用 SQL 初始化 Quartz 表结构。这里设置成 never ，我们手动创建表结构。</span></span><br><span class=\"line\">    <span class=\"attr\">properties:</span></span><br><span class=\"line\">      <span class=\"attr\">org:</span></span><br><span class=\"line\">        <span class=\"attr\">quartz:</span></span><br><span class=\"line\">          <span class=\"comment\"># JobStore 相关配置</span></span><br><span class=\"line\">          <span class=\"attr\">jobStore:</span></span><br><span class=\"line\">            <span class=\"attr\">dataSource:</span> <span class=\"string\">quartzDataSource</span> <span class=\"comment\"># 使用的数据源</span></span><br><span class=\"line\">            <span class=\"attr\">class:</span> <span class=\"string\">org.quartz.impl.jdbcjobstore.JobStoreTX</span> <span class=\"comment\"># JobStore 实现类</span></span><br><span class=\"line\">            <span class=\"attr\">driverDelegateClass:</span> <span class=\"string\">org.quartz.impl.jdbcjobstore.StdJDBCDelegate</span></span><br><span class=\"line\">            <span class=\"attr\">tablePrefix:</span> <span class=\"string\">QRTZ_</span> <span class=\"comment\"># Quartz 表前缀</span></span><br><span class=\"line\">            <span class=\"attr\">isClustered:</span> <span class=\"literal\">true</span> <span class=\"comment\"># 是集群模式</span></span><br><span class=\"line\">            <span class=\"attr\">clusterCheckinInterval:</span> <span class=\"number\">1000</span></span><br><span class=\"line\">            <span class=\"attr\">useProperties:</span> <span class=\"literal\">false</span></span><br><span class=\"line\">          <span class=\"comment\"># 线程池相关配置</span></span><br><span class=\"line\">          <span class=\"attr\">threadPool:</span></span><br><span class=\"line\">            <span class=\"attr\">threadCount:</span> <span class=\"number\">25</span> <span class=\"comment\"># 线程池大小。默认为 10 。</span></span><br><span class=\"line\">            <span class=\"attr\">threadPriority:</span> <span class=\"number\">5</span> <span class=\"comment\"># 线程优先级</span></span><br><span class=\"line\">            <span class=\"attr\">class:</span> <span class=\"string\">org.quartz.simpl.SimpleThreadPool</span> <span class=\"comment\"># 线程池类型</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure></p>\n<h5 id=\"创建任务\"><a class=\"anchor\" href=\"#创建任务\">#</a> 创建任务</h5>\n<p><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Component</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">JobInit</span> <span class=\"keyword\">implements</span> <span class=\"title class_\">ApplicationRunner</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">String</span> <span class=\"variable\">ID</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;SUMMERDAY&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Autowired</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Scheduler scheduler;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">run</span><span class=\"params\">(ApplicationArguments args)</span> <span class=\"keyword\">throws</span> Exception &#123;</span><br><span class=\"line\">        <span class=\"type\">JobDetail</span> <span class=\"variable\">jobDetail</span> <span class=\"operator\">=</span> JobBuilder.newJob(SecondJob.class)</span><br><span class=\"line\">                .withIdentity(ID + <span class=\"string\">&quot; 02&quot;</span>)</span><br><span class=\"line\">                .storeDurably()</span><br><span class=\"line\">                .build();</span><br><span class=\"line\">        <span class=\"type\">CronScheduleBuilder</span> <span class=\"variable\">scheduleBuilder</span> <span class=\"operator\">=</span></span><br><span class=\"line\">                CronScheduleBuilder.cronSchedule(<span class=\"string\">&quot;0/10 * * * * ? *&quot;</span>);</span><br><span class=\"line\">        <span class=\"comment\">// 创建任务触发器</span></span><br><span class=\"line\">        <span class=\"type\">Trigger</span> <span class=\"variable\">trigger</span> <span class=\"operator\">=</span> TriggerBuilder.newTrigger()</span><br><span class=\"line\">                .forJob(jobDetail)</span><br><span class=\"line\">                .withIdentity(ID + <span class=\"string\">&quot; 02Trigger&quot;</span>)</span><br><span class=\"line\">                .withSchedule(scheduleBuilder)</span><br><span class=\"line\">                .startNow() <span class=\"comment\">//立即執行一次任務</span></span><br><span class=\"line\">                .build();</span><br><span class=\"line\">        Set&lt;Trigger&gt; set = <span class=\"keyword\">new</span> <span class=\"title class_\">HashSet</span>&lt;&gt;();</span><br><span class=\"line\">        set.add(trigger);</span><br><span class=\"line\">        <span class=\"comment\">// boolean replace 表示启动时对数据库中的quartz的任务进行覆盖。</span></span><br><span class=\"line\">        scheduler.scheduleJob(jobDetail, set, <span class=\"literal\">true</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure></p>\n<h5 id=\"启动测试\"><a class=\"anchor\" href=\"#启动测试\">#</a> 启动测试</h5>\n<p>启动测试之后，我们的 quartz 任务相关信息就已经成功存储到 mysql 中了。</p>\n<p><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql<span class=\"operator\">&gt;</span> <span class=\"keyword\">select</span> <span class=\"operator\">*</span> <span class=\"keyword\">from</span> qrtz_simple_triggers;</span><br><span class=\"line\"><span class=\"operator\">+</span><span class=\"comment\">--------------+---------------------+---------------+--------------+-----------------+-----------------+</span></span><br><span class=\"line\"><span class=\"operator\">|</span> SCHED_NAME   <span class=\"operator\">|</span> TRIGGER_NAME        <span class=\"operator\">|</span> TRIGGER_GROUP <span class=\"operator\">|</span> REPEAT_COUNT <span class=\"operator\">|</span> REPEAT_INTERVAL <span class=\"operator\">|</span> TIMES_TRIGGERED <span class=\"operator\">|</span></span><br><span class=\"line\"><span class=\"operator\">+</span><span class=\"comment\">--------------+---------------------+---------------+--------------+-----------------+-----------------+</span></span><br><span class=\"line\"><span class=\"operator\">|</span> hyhScheduler <span class=\"operator\">|</span> SUMMERDAY <span class=\"number\">01</span><span class=\"keyword\">Trigger</span> <span class=\"operator\">|</span> <span class=\"keyword\">DEFAULT</span>       <span class=\"operator\">|</span>           <span class=\"number\">-1</span> <span class=\"operator\">|</span>            <span class=\"number\">5000</span> <span class=\"operator\">|</span>             <span class=\"number\">812</span> <span class=\"operator\">|</span></span><br><span class=\"line\"><span class=\"operator\">+</span><span class=\"comment\">--------------+---------------------+---------------+--------------+-----------------+-----------------+</span></span><br><span class=\"line\"><span class=\"number\">1</span> <span class=\"type\">row</span> <span class=\"keyword\">in</span> <span class=\"keyword\">set</span> (<span class=\"number\">0.00</span> sec)</span><br><span class=\"line\"></span><br><span class=\"line\">mysql<span class=\"operator\">&gt;</span> <span class=\"keyword\">select</span> <span class=\"operator\">*</span> <span class=\"keyword\">from</span> qrtz_cron_triggers;</span><br><span class=\"line\"><span class=\"operator\">+</span><span class=\"comment\">--------------+---------------------+---------------+------------------+---------------+</span></span><br><span class=\"line\"><span class=\"operator\">|</span> SCHED_NAME   <span class=\"operator\">|</span> TRIGGER_NAME        <span class=\"operator\">|</span> TRIGGER_GROUP <span class=\"operator\">|</span> CRON_EXPRESSION  <span class=\"operator\">|</span> TIME_ZONE_ID  <span class=\"operator\">|</span></span><br><span class=\"line\"><span class=\"operator\">+</span><span class=\"comment\">--------------+---------------------+---------------+------------------+---------------+</span></span><br><span class=\"line\"><span class=\"operator\">|</span> hyhScheduler <span class=\"operator\">|</span> SUMMERDAY <span class=\"number\">02</span><span class=\"keyword\">Trigger</span> <span class=\"operator\">|</span> <span class=\"keyword\">DEFAULT</span>       <span class=\"operator\">|</span> <span class=\"number\">0</span><span class=\"operator\">/</span><span class=\"number\">10</span> <span class=\"operator\">*</span> <span class=\"operator\">*</span> <span class=\"operator\">*</span> <span class=\"operator\">*</span> ? <span class=\"operator\">*</span> <span class=\"operator\">|</span> Asia<span class=\"operator\">/</span>Shanghai <span class=\"operator\">|</span></span><br><span class=\"line\"><span class=\"operator\">+</span><span class=\"comment\">--------------+---------------------+---------------+------------------+---------------+</span></span><br></pre></td></tr></table></figure></p>\n<h2 id=\"相关链接\"><a class=\"anchor\" href=\"#相关链接\">#</a> 相关链接</h2>\n<p>了解现有的定时任务机制</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FpYW5saXhpYW9tYWdlL2FydGljbGUvZGV0YWlscy8xMDY1OTk5NTE=\">https://blog.csdn.net/qianlixiaomage/article/details/106599951</span></p>\n<p>了解 quartz 定时调度</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NjaG9sYXJUYW5nL2FydGljbGUvZGV0YWlscy8xMTg4OTEyOTc=\">https://blog.csdn.net/ScholarTang/article/details/118891297</span></p>\n<p>springboot 整合 Quartz</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vc3VtbWVyZGF5MTUyL3AvMTQxOTM5NjguaHRtbA==\">https://www.cnblogs.com/summerday152/p/14193968.html</span></p>\n<p>--- 不用配置数据源这一步</p>\n",
            "tags": [
                "工作日志",
                "job"
            ]
        }
    ]
}